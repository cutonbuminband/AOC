<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>AOC - 2016 Solutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../qmd/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/2016.html">2016 Solutions</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">AOC</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2024.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2024 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2023 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2022.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2022 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2021.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2021 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2020.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2020 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2019.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2019 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2018.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2018 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2017.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2017 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2016.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2016 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2015.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2015 Solutions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#imports" id="toc-imports" class="nav-link active" data-scroll-target="#imports">Imports</a></li>
  <li><a href="#day-1-no-time-for-a-taxicab" id="toc-day-1-no-time-for-a-taxicab" class="nav-link" data-scroll-target="#day-1-no-time-for-a-taxicab">Day 1: No Time for a Taxicab</a>
  <ul class="collapse">
  <li><a href="#part-1" id="toc-part-1" class="nav-link" data-scroll-target="#part-1">Part 1</a></li>
  <li><a href="#part-2" id="toc-part-2" class="nav-link" data-scroll-target="#part-2">Part 2</a></li>
  </ul></li>
  <li><a href="#day-2-bathroom-security" id="toc-day-2-bathroom-security" class="nav-link" data-scroll-target="#day-2-bathroom-security">Day 2: Bathroom Security</a>
  <ul class="collapse">
  <li><a href="#part-1-1" id="toc-part-1-1" class="nav-link" data-scroll-target="#part-1-1">Part 1</a></li>
  <li><a href="#part-2-1" id="toc-part-2-1" class="nav-link" data-scroll-target="#part-2-1">Part 2</a></li>
  </ul></li>
  <li><a href="#day-3-squares-with-three-sides" id="toc-day-3-squares-with-three-sides" class="nav-link" data-scroll-target="#day-3-squares-with-three-sides">Day 3: Squares with three sides</a>
  <ul class="collapse">
  <li><a href="#part-1-2" id="toc-part-1-2" class="nav-link" data-scroll-target="#part-1-2">Part 1</a></li>
  <li><a href="#part-2-2" id="toc-part-2-2" class="nav-link" data-scroll-target="#part-2-2">Part 2</a></li>
  </ul></li>
  <li><a href="#day-4-security-through-obscurity" id="toc-day-4-security-through-obscurity" class="nav-link" data-scroll-target="#day-4-security-through-obscurity">Day 4: Security Through Obscurity</a>
  <ul class="collapse">
  <li><a href="#part-1-3" id="toc-part-1-3" class="nav-link" data-scroll-target="#part-1-3">Part 1</a></li>
  <li><a href="#part-2-3" id="toc-part-2-3" class="nav-link" data-scroll-target="#part-2-3">Part 2</a></li>
  </ul></li>
  <li><a href="#day-5-how-about-a-nice-game-of-chess" id="toc-day-5-how-about-a-nice-game-of-chess" class="nav-link" data-scroll-target="#day-5-how-about-a-nice-game-of-chess">Day 5: How About a Nice Game of Chess?</a>
  <ul class="collapse">
  <li><a href="#part-1-4" id="toc-part-1-4" class="nav-link" data-scroll-target="#part-1-4">Part 1</a></li>
  <li><a href="#part-2-4" id="toc-part-2-4" class="nav-link" data-scroll-target="#part-2-4">Part 2</a></li>
  </ul></li>
  <li><a href="#day-6-signals-and-noise" id="toc-day-6-signals-and-noise" class="nav-link" data-scroll-target="#day-6-signals-and-noise">Day 6: Signals and Noise</a>
  <ul class="collapse">
  <li><a href="#part-1-5" id="toc-part-1-5" class="nav-link" data-scroll-target="#part-1-5">Part 1</a></li>
  <li><a href="#part-2-5" id="toc-part-2-5" class="nav-link" data-scroll-target="#part-2-5">Part 2</a></li>
  </ul></li>
  <li><a href="#day-7-internet-protocol-version-7" id="toc-day-7-internet-protocol-version-7" class="nav-link" data-scroll-target="#day-7-internet-protocol-version-7">Day 7: Internet Protocol Version 7</a>
  <ul class="collapse">
  <li><a href="#part-1-6" id="toc-part-1-6" class="nav-link" data-scroll-target="#part-1-6">Part 1</a></li>
  <li><a href="#part-2-6" id="toc-part-2-6" class="nav-link" data-scroll-target="#part-2-6">Part 2</a></li>
  </ul></li>
  <li><a href="#day-8-two-factor-authentication" id="toc-day-8-two-factor-authentication" class="nav-link" data-scroll-target="#day-8-two-factor-authentication">Day 8: Two-Factor Authentication</a>
  <ul class="collapse">
  <li><a href="#part-1-7" id="toc-part-1-7" class="nav-link" data-scroll-target="#part-1-7">Part 1</a></li>
  <li><a href="#part-2-7" id="toc-part-2-7" class="nav-link" data-scroll-target="#part-2-7">Part 2</a></li>
  </ul></li>
  <li><a href="#day-9-explosives-in-cyberspace" id="toc-day-9-explosives-in-cyberspace" class="nav-link" data-scroll-target="#day-9-explosives-in-cyberspace">Day 9: Explosives in Cyberspace</a>
  <ul class="collapse">
  <li><a href="#part-1-8" id="toc-part-1-8" class="nav-link" data-scroll-target="#part-1-8">Part 1</a></li>
  <li><a href="#part-2-8" id="toc-part-2-8" class="nav-link" data-scroll-target="#part-2-8">Part 2</a></li>
  </ul></li>
  <li><a href="#day-10-balance-bots" id="toc-day-10-balance-bots" class="nav-link" data-scroll-target="#day-10-balance-bots">Day 10: Balance Bots</a>
  <ul class="collapse">
  <li><a href="#part-1-9" id="toc-part-1-9" class="nav-link" data-scroll-target="#part-1-9">Part 1</a></li>
  <li><a href="#part-2-9" id="toc-part-2-9" class="nav-link" data-scroll-target="#part-2-9">Part 2</a></li>
  </ul></li>
  <li><a href="#day-11-radioisotope-thermoelectric-generators" id="toc-day-11-radioisotope-thermoelectric-generators" class="nav-link" data-scroll-target="#day-11-radioisotope-thermoelectric-generators">Day 11: Radioisotope Thermoelectric Generators</a>
  <ul class="collapse">
  <li><a href="#part-1-10" id="toc-part-1-10" class="nav-link" data-scroll-target="#part-1-10">Part 1</a></li>
  <li><a href="#part-2-10" id="toc-part-2-10" class="nav-link" data-scroll-target="#part-2-10">Part 2</a></li>
  </ul></li>
  <li><a href="#day-12-leonardos-monorail" id="toc-day-12-leonardos-monorail" class="nav-link" data-scroll-target="#day-12-leonardos-monorail">Day 12: Leonardo’s Monorail</a>
  <ul class="collapse">
  <li><a href="#part-1-11" id="toc-part-1-11" class="nav-link" data-scroll-target="#part-1-11">Part 1</a></li>
  <li><a href="#part-2-11" id="toc-part-2-11" class="nav-link" data-scroll-target="#part-2-11">Part 2</a></li>
  </ul></li>
  <li><a href="#day-13-a-maze-of-twisty-little-cubicles" id="toc-day-13-a-maze-of-twisty-little-cubicles" class="nav-link" data-scroll-target="#day-13-a-maze-of-twisty-little-cubicles">Day 13: A Maze of Twisty Little Cubicles</a>
  <ul class="collapse">
  <li><a href="#part-1-12" id="toc-part-1-12" class="nav-link" data-scroll-target="#part-1-12">Part 1</a></li>
  <li><a href="#part-2-12" id="toc-part-2-12" class="nav-link" data-scroll-target="#part-2-12">Part 2</a></li>
  </ul></li>
  <li><a href="#day-14-one-time-pad" id="toc-day-14-one-time-pad" class="nav-link" data-scroll-target="#day-14-one-time-pad">Day 14: One-Time Pad</a>
  <ul class="collapse">
  <li><a href="#part-1-13" id="toc-part-1-13" class="nav-link" data-scroll-target="#part-1-13">Part 1</a></li>
  <li><a href="#part-2-13" id="toc-part-2-13" class="nav-link" data-scroll-target="#part-2-13">Part 2</a></li>
  </ul></li>
  <li><a href="#day-15-timing-is-everything" id="toc-day-15-timing-is-everything" class="nav-link" data-scroll-target="#day-15-timing-is-everything">Day 15: Timing is Everything</a>
  <ul class="collapse">
  <li><a href="#part-1-14" id="toc-part-1-14" class="nav-link" data-scroll-target="#part-1-14">Part 1</a></li>
  <li><a href="#part-2-14" id="toc-part-2-14" class="nav-link" data-scroll-target="#part-2-14">Part 2</a></li>
  </ul></li>
  <li><a href="#day-16-dragon-checksum" id="toc-day-16-dragon-checksum" class="nav-link" data-scroll-target="#day-16-dragon-checksum">Day 16: Dragon Checksum</a>
  <ul class="collapse">
  <li><a href="#part-1-15" id="toc-part-1-15" class="nav-link" data-scroll-target="#part-1-15">Part 1</a></li>
  <li><a href="#part-2-15" id="toc-part-2-15" class="nav-link" data-scroll-target="#part-2-15">Part 2</a></li>
  </ul></li>
  <li><a href="#day-17-two-steps-forward" id="toc-day-17-two-steps-forward" class="nav-link" data-scroll-target="#day-17-two-steps-forward">Day 17: Two Steps Forward</a>
  <ul class="collapse">
  <li><a href="#part-1-16" id="toc-part-1-16" class="nav-link" data-scroll-target="#part-1-16">Part 1</a></li>
  <li><a href="#part-2-16" id="toc-part-2-16" class="nav-link" data-scroll-target="#part-2-16">Part 2</a></li>
  </ul></li>
  <li><a href="#day-18-like-a-rogue" id="toc-day-18-like-a-rogue" class="nav-link" data-scroll-target="#day-18-like-a-rogue">Day 18: Like a Rogue</a>
  <ul class="collapse">
  <li><a href="#part-2-17" id="toc-part-2-17" class="nav-link" data-scroll-target="#part-2-17">Part 2</a></li>
  <li><a href="#part-2-18" id="toc-part-2-18" class="nav-link" data-scroll-target="#part-2-18">Part 2</a></li>
  </ul></li>
  <li><a href="#day-19-an-elephant-named-joseph" id="toc-day-19-an-elephant-named-joseph" class="nav-link" data-scroll-target="#day-19-an-elephant-named-joseph">Day 19: An Elephant Named Joseph</a>
  <ul class="collapse">
  <li><a href="#part-1-17" id="toc-part-1-17" class="nav-link" data-scroll-target="#part-1-17">Part 1</a></li>
  <li><a href="#part-2-19" id="toc-part-2-19" class="nav-link" data-scroll-target="#part-2-19">Part 2</a></li>
  </ul></li>
  <li><a href="#day-20-firewall-rules" id="toc-day-20-firewall-rules" class="nav-link" data-scroll-target="#day-20-firewall-rules">Day 20: Firewall Rules</a>
  <ul class="collapse">
  <li><a href="#part-1-18" id="toc-part-1-18" class="nav-link" data-scroll-target="#part-1-18">Part 1</a></li>
  <li><a href="#part-2-20" id="toc-part-2-20" class="nav-link" data-scroll-target="#part-2-20">Part 2</a></li>
  </ul></li>
  <li><a href="#day-21-scrambled-letters-and-hash" id="toc-day-21-scrambled-letters-and-hash" class="nav-link" data-scroll-target="#day-21-scrambled-letters-and-hash">Day 21: Scrambled Letters and Hash</a>
  <ul class="collapse">
  <li><a href="#part-1-19" id="toc-part-1-19" class="nav-link" data-scroll-target="#part-1-19">Part 1</a></li>
  <li><a href="#part-2-21" id="toc-part-2-21" class="nav-link" data-scroll-target="#part-2-21">Part 2</a></li>
  </ul></li>
  <li><a href="#day-22-grid-computing" id="toc-day-22-grid-computing" class="nav-link" data-scroll-target="#day-22-grid-computing">Day 22: Grid Computing</a>
  <ul class="collapse">
  <li><a href="#part-1-20" id="toc-part-1-20" class="nav-link" data-scroll-target="#part-1-20">Part 1</a></li>
  <li><a href="#part-2-22" id="toc-part-2-22" class="nav-link" data-scroll-target="#part-2-22">Part 2</a></li>
  </ul></li>
  <li><a href="#day-23-safe-cracking" id="toc-day-23-safe-cracking" class="nav-link" data-scroll-target="#day-23-safe-cracking">Day 23: Safe Cracking</a>
  <ul class="collapse">
  <li><a href="#part-1-21" id="toc-part-1-21" class="nav-link" data-scroll-target="#part-1-21">Part 1</a></li>
  <li><a href="#part-2-23" id="toc-part-2-23" class="nav-link" data-scroll-target="#part-2-23">Part 2</a></li>
  </ul></li>
  <li><a href="#day-24-air-duct-spelunking" id="toc-day-24-air-duct-spelunking" class="nav-link" data-scroll-target="#day-24-air-duct-spelunking">Day 24: Air Duct Spelunking</a>
  <ul class="collapse">
  <li><a href="#part-1-22" id="toc-part-1-22" class="nav-link" data-scroll-target="#part-1-22">Part 1</a></li>
  <li><a href="#part-2-24" id="toc-part-2-24" class="nav-link" data-scroll-target="#part-2-24">Part 2</a></li>
  </ul></li>
  <li><a href="#day-25-clock-signal" id="toc-day-25-clock-signal" class="nav-link" data-scroll-target="#day-25-clock-signal">Day 25: Clock Signal</a>
  <ul class="collapse">
  <li><a href="#part-1-23" id="toc-part-1-23" class="nav-link" data-scroll-target="#part-1-23">Part 1</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">2016 Solutions</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="imports" class="level1">
<h1>Imports</h1>
<div class="cell" data-execution_count="1">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> functools</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict, deque</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> queue <span class="im">import</span> PriorityQueue</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> more_itertools</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>sys.path.insert(<span class="dv">1</span>, os.path.join(sys.path[<span class="dv">0</span>], <span class="st">".."</span>))</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> utils</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>load <span class="op">=</span> utils.year_load(<span class="dv">2016</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="day-1-no-time-for-a-taxicab" class="level1">
<h1><a href="https://adventofcode.com/2016/day/1">Day 1: No Time for a Taxicab</a></h1>
<section id="part-1" class="level2">
<h2 class="anchored" data-anchor-id="part-1">Part 1</h2>
<p>How many blocks away is Easter Bunny HQ?</p>
<div class="cell" data-execution_count="2">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> load(<span class="dv">1</span>)[<span class="dv">0</span>].split(<span class="st">", "</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>rotations <span class="op">=</span> {</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R"</span>: np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]], dtype<span class="op">=</span><span class="bu">int</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"L"</span>: np.array([[<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>]], dtype<span class="op">=</span><span class="bu">int</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> instruction <span class="kw">in</span> instructions:</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">=</span> rotations[instruction[<span class="dv">0</span>]] <span class="op">@</span> direction</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    position <span class="op">+=</span> direction <span class="op">*</span> <span class="bu">int</span>(instruction[<span class="dv">1</span>:])</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">abs</span>(position))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2" class="level2">
<h2 class="anchored" data-anchor-id="part-2">Part 2</h2>
<p>Then, you notice the instructions continue on the back of the Recruiting Document. Easter Bunny HQ is actually at the first location you visit twice.</p>
<div class="cell" data-execution_count="3">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>seen <span class="op">=</span> {<span class="bu">tuple</span>(position): <span class="va">True</span>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> instruction <span class="kw">in</span> instructions:</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">=</span> rotations[instruction[<span class="dv">0</span>]] <span class="op">@</span> direction</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(instruction[<span class="dv">1</span>:])):</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        position <span class="op">+=</span> direction</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">tuple</span>(position) <span class="kw">in</span> seen:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        seen[<span class="bu">tuple</span>(position)] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">abs</span>(position))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-2-bathroom-security" class="level1">
<h1><a href="https://adventofcode.com/2016/day/2">Day 2: Bathroom Security</a></h1>
<section id="part-1-1" class="level2">
<h2 class="anchored" data-anchor-id="part-1-1">Part 1</h2>
<div class="cell" data-execution_count="4">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>commands <span class="op">=</span> {<span class="st">"U"</span>: <span class="op">-</span><span class="ot">1j</span>, <span class="st">"D"</span>: <span class="ot">1j</span>, <span class="st">"L"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"R"</span>: <span class="dv">1</span>}</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> {(x <span class="op">%</span> <span class="dv">3</span>) <span class="op">+</span> <span class="ot">1j</span> <span class="op">*</span> (x <span class="op">//</span> <span class="dv">3</span>): x <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)}</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update(point, grid, instructions):</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> instruction <span class="kw">in</span> instructions:</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        new_point <span class="op">=</span> point <span class="op">+</span> commands[instruction]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> new_point <span class="kw">in</span> grid:</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>            point <span class="op">=</span> new_point</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> point</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>point <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="ot">1j</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>password <span class="op">=</span> <span class="st">""</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> load(<span class="dv">2</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> instructions:</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    point <span class="op">=</span> update(point, grid, line)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    password <span class="op">+=</span> <span class="bu">str</span>(grid[point])</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>password</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-1" class="level2">
<h2 class="anchored" data-anchor-id="part-2-1">Part 2</h2>
<div class="cell" data-execution_count="5">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="ot">0j</span> <span class="op">+</span> <span class="dv">2</span>: <span class="dv">1</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="ot">1j</span> <span class="op">+</span> <span class="dv">1</span>: <span class="dv">2</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="ot">1j</span> <span class="op">+</span> <span class="dv">2</span>: <span class="dv">3</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="ot">1j</span> <span class="op">+</span> <span class="dv">3</span>: <span class="dv">4</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="ot">2j</span>: <span class="dv">5</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="ot">2j</span> <span class="op">+</span> <span class="dv">1</span>: <span class="dv">6</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="ot">2j</span> <span class="op">+</span> <span class="dv">2</span>: <span class="dv">7</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="ot">2j</span> <span class="op">+</span> <span class="dv">3</span>: <span class="dv">8</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="ot">2j</span> <span class="op">+</span> <span class="dv">4</span>: <span class="dv">9</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="ot">3j</span> <span class="op">+</span> <span class="dv">1</span>: <span class="st">"A"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="ot">3j</span> <span class="op">+</span> <span class="dv">2</span>: <span class="st">"B"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="ot">3j</span> <span class="op">+</span> <span class="dv">3</span>: <span class="st">"C"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="ot">4j</span> <span class="op">+</span> <span class="dv">2</span>: <span class="st">"D"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>point <span class="op">=</span> <span class="ot">2j</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>password <span class="op">=</span> <span class="st">""</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> instructions:</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    point <span class="op">=</span> update(point, grid, line)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    password <span class="op">+=</span> <span class="bu">str</span>(grid[point])</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>password</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-3-squares-with-three-sides" class="level1">
<h1><a href="https://adventofcode.com/2016/day/3">Day 3: Squares with three sides</a></h1>
<section id="part-1-2" class="level2">
<h2 class="anchored" data-anchor-id="part-1-2">Part 1</h2>
<div class="cell" data-execution_count="6">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array(load(<span class="dv">3</span>, <span class="st">"int"</span>), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid(triangle):</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    x, y, z <span class="op">=</span> triangle</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">+</span> y <span class="op">&gt;</span> z <span class="kw">and</span> x <span class="op">+</span> z <span class="op">&gt;</span> y <span class="kw">and</span> y <span class="op">+</span> z <span class="op">&gt;</span> x</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">map</span>(is_valid, data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-2" class="level2">
<h2 class="anchored" data-anchor-id="part-2-2">Part 2</h2>
<div class="cell" data-execution_count="7">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">map</span>(is_valid, data.T.ravel().reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-4-security-through-obscurity" class="level1">
<h1><a href="https://adventofcode.com/2016/day/4">Day 4: Security Through Obscurity</a></h1>
<section id="part-1-3" class="level2">
<h2 class="anchored" data-anchor-id="part-1-3">Part 1</h2>
<div class="cell" data-execution_count="8">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_line(room):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    checksum <span class="op">=</span> room[<span class="op">-</span><span class="dv">6</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    sector_id <span class="op">=</span> <span class="bu">int</span>(room[:<span class="op">-</span><span class="dv">7</span>].split(<span class="st">"-"</span>)[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> <span class="st">"-"</span>.join(room.split(<span class="st">"-"</span>)[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name, sector_id, checksum</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_checksum(name):</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    occurrences <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(<span class="op">*</span>np.unique(<span class="bu">list</span>(name.replace(<span class="st">"-"</span>, <span class="st">""</span>)), return_counts<span class="op">=</span><span class="va">True</span>)))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join(x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">sorted</span>(occurrences, key<span class="op">=</span><span class="kw">lambda</span> x: [<span class="op">-</span>x[<span class="dv">1</span>], x[<span class="dv">0</span>]])[:<span class="dv">5</span>])</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [parse_line(l) <span class="cf">for</span> l <span class="kw">in</span> load(<span class="dv">4</span>)]</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    sector_id</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, sector_id, checksum <span class="kw">in</span> data</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> calculate_checksum(name) <span class="op">==</span> checksum</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-3" class="level2">
<h2 class="anchored" data-anchor-id="part-2-3">Part 2</h2>
<div class="cell" data-execution_count="9">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>real_rooms <span class="op">=</span> [room[:<span class="dv">2</span>] <span class="cf">for</span> room <span class="kw">in</span> data <span class="cf">if</span> calculate_checksum(room[<span class="dv">0</span>]) <span class="op">==</span> room[<span class="dv">2</span>]]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> decrypt(name, offset):</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="st">"abcdefghijklmnopqrstuvwxyz"</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    shifted_alphabet <span class="op">=</span> <span class="st">""</span>.join(x <span class="cf">for</span> x <span class="kw">in</span> np.roll(<span class="bu">list</span>(alphabet), <span class="op">-</span>offset <span class="op">%</span> <span class="dv">26</span>))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name.translate(<span class="bu">str</span>.maketrans(alphabet, shifted_alphabet)), offset</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>[answer <span class="cf">for</span> room <span class="kw">in</span> real_rooms <span class="cf">if</span> <span class="st">"north"</span> <span class="kw">in</span> (answer <span class="op">:=</span> decrypt(<span class="op">*</span>room))[<span class="dv">0</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-5-how-about-a-nice-game-of-chess" class="level1">
<h1><a href="https://adventofcode.com/2016/day/5">Day 5: How About a Nice Game of Chess?</a></h1>
<section id="part-1-4" class="level2">
<h2 class="anchored" data-anchor-id="part-1-4">Part 1</h2>
<div class="cell" data-execution_count="10">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> hashlib.md5()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>prefix <span class="op">=</span> <span class="st">"wtnhxymk"</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>password <span class="op">=</span> <span class="st">""</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">len</span>(password) <span class="op">&lt;</span> <span class="dv">8</span>:</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> hashlib.md5((prefix <span class="op">+</span> <span class="bu">str</span>(i)).encode(encoding<span class="op">=</span><span class="st">"UTF-8"</span>)).hexdigest()</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> s[:<span class="dv">5</span>] <span class="op">==</span> <span class="st">"0"</span> <span class="op">*</span> <span class="dv">5</span>:</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        password <span class="op">=</span> password <span class="op">+</span> s[<span class="dv">5</span>]</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>password</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-4" class="level2">
<h2 class="anchored" data-anchor-id="part-2-4">Part 2</h2>
<div class="cell" data-execution_count="11">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>password <span class="op">=</span> [<span class="va">None</span>] <span class="op">*</span> <span class="dv">8</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">any</span>([x <span class="kw">is</span> <span class="va">None</span> <span class="cf">for</span> x <span class="kw">in</span> password]):</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> hashlib.md5((prefix <span class="op">+</span> <span class="bu">str</span>(i)).encode(encoding<span class="op">=</span><span class="st">"UTF-8"</span>)).hexdigest()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> s[:<span class="dv">5</span>] <span class="op">==</span> <span class="st">"0"</span> <span class="op">*</span> <span class="dv">5</span> <span class="kw">and</span> s[<span class="dv">5</span>] <span class="kw">in</span> <span class="st">"01234567"</span> <span class="kw">and</span> password[<span class="bu">int</span>(s[<span class="dv">5</span>])] <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        password[<span class="bu">int</span>(s[<span class="dv">5</span>])] <span class="op">=</span> s[<span class="dv">6</span>]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">""</span>.join(password)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-6-signals-and-noise" class="level1">
<h1><a href="https://adventofcode.com/2016/day/6">Day 6: Signals and Noise</a></h1>
<section id="part-1-5" class="level2">
<h2 class="anchored" data-anchor-id="part-1-5">Part 1</h2>
<div class="cell" data-execution_count="12">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>messages <span class="op">=</span> load(<span class="dv">6</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">""</span>.join(pd.DataFrame([<span class="bu">list</span>(x) <span class="cf">for</span> x <span class="kw">in</span> messages]).mode().values[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-5" class="level2">
<h2 class="anchored" data-anchor-id="part-2-5">Part 2</h2>
<div class="cell" data-execution_count="13">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>foo <span class="op">=</span> np.array([<span class="bu">list</span>(x) <span class="cf">for</span> x <span class="kw">in</span> messages])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="st">""</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(foo.shape[<span class="dv">1</span>]):</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    letters, counts <span class="op">=</span> np.unique(foo[:, i], return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    s <span class="op">+=</span> letters[counts.argmin()]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-7-internet-protocol-version-7" class="level1">
<h1><a href="https://adventofcode.com/2016/day/7">Day 7: Internet Protocol Version 7</a></h1>
<section id="part-1-6" class="level2">
<h2 class="anchored" data-anchor-id="part-1-6">Part 1</h2>
<div class="cell" data-execution_count="14">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">7</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>abba <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r"(.)(?!\1)(.)\2\1"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>bracketed_abba <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r"\[[^]]*(.)(?!\1)(.)\2\1.*?\]"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> supports_tls(haystack):</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">bool</span>(re.search(abba, haystack)) <span class="kw">and</span> <span class="kw">not</span> <span class="bu">bool</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        re.search(bracketed_abba, haystack)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(supports_tls(line) <span class="cf">for</span> line <span class="kw">in</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-6" class="level2">
<h2 class="anchored" data-anchor-id="part-2-6">Part 2</h2>
<p>Part two is more regex wrangling, except the patterns can overlap now. We could spend time figuring out exactly how to account for that, or we can import the third party regex module which does it for us automagically.</p>
<div class="cell" data-execution_count="15">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> regex</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> supports_ssl(haystack):</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    aba <span class="op">=</span> regex.<span class="bu">compile</span>(<span class="vs">r"(.)(?!\1)(.)\1"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    bracket_split <span class="op">=</span> [x.split(<span class="st">"["</span>) <span class="cf">for</span> x <span class="kw">in</span> haystack.split(<span class="st">"]"</span>)]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    outside, inside <span class="op">=</span> itertools.zip_longest(<span class="op">*</span>bracket_split, fillvalue<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    abas <span class="op">=</span> [</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        match</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> fragment <span class="kw">in</span> outside</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> match <span class="kw">in</span> regex.findall(aba, fragment, overlapped<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> abas:</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        bab <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>b<span class="sc">}{</span>a<span class="sc">}{</span>b<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">any</span>(bab <span class="kw">in</span> fragment <span class="cf">for</span> fragment <span class="kw">in</span> inside):</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(supports_ssl(line) <span class="cf">for</span> line <span class="kw">in</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-8-two-factor-authentication" class="level1">
<h1><a href="https://adventofcode.com/2016/day/8">Day 8: Two-Factor Authentication</a></h1>
<section id="part-1-7" class="level2">
<h2 class="anchored" data-anchor-id="part-1-7">Part 1</h2>
<div class="cell" data-execution_count="16">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.zeros((<span class="dv">6</span>, <span class="dv">50</span>), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>lines <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">8</span>)]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> instructions <span class="kw">in</span> lines:</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> instructions[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"rect"</span>:</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        row, col <span class="op">=</span> [<span class="bu">int</span>(a) <span class="cf">for</span> a <span class="kw">in</span> instructions[<span class="dv">1</span>].split(<span class="st">"x"</span>)]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        array[:col, :row] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> <span class="bu">int</span>(instructions[<span class="dv">2</span>].split(<span class="st">"="</span>)[<span class="dv">1</span>])</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    amount <span class="op">=</span> <span class="bu">int</span>(instructions[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> instructions[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"column"</span>:</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        array <span class="op">=</span> array.T</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    array[row] <span class="op">=</span> np.roll(array[row], amount)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> instructions[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"column"</span>:</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        array <span class="op">=</span> array.T</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>array.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-7" class="level2">
<h2 class="anchored" data-anchor-id="part-2-7">Part 2</h2>
<div class="cell" data-execution_count="17">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>[[<span class="st">""</span>.join(<span class="st">"█"</span> <span class="cf">if</span> char <span class="cf">else</span> <span class="st">" "</span> <span class="cf">for</span> char <span class="kw">in</span> line)] <span class="cf">for</span> line <span class="kw">in</span> array]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-9-explosives-in-cyberspace" class="level1">
<h1><a href="https://adventofcode.com/2016/day/9">Day 9: Explosives in Cyberspace</a></h1>
<section id="part-1-8" class="level2">
<h2 class="anchored" data-anchor-id="part-1-8">Part 1</h2>
<div class="cell" data-execution_count="18">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">9</span>)[<span class="dv">0</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>part1 <span class="op">=</span> data</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count(s, part2<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> s:</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> s[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">"("</span>:</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>            s <span class="op">=</span> s[<span class="dv">1</span>:]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        end <span class="op">=</span> s.index(<span class="st">")"</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        chars, repeat <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, s[<span class="dv">1</span>:end].split(<span class="st">"x"</span>))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s[end <span class="op">+</span> <span class="dv">1</span> :]</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> part2:</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> repeat <span class="op">*</span> count(s[:chars], <span class="va">True</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> repeat <span class="op">*</span> chars</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s[chars:]</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>count(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-8" class="level2">
<h2 class="anchored" data-anchor-id="part-2-8">Part 2</h2>
<div class="cell" data-execution_count="19">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>count(data, part2<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-10-balance-bots" class="level1">
<h1><a href="https://adventofcode.com/2016/day/10">Day 10: Balance Bots</a></h1>
<section id="part-1-9" class="level2">
<h2 class="anchored" data-anchor-id="part-1-9">Part 1</h2>
<div class="cell" data-execution_count="20">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">10</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>wiring <span class="op">=</span> {}</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> data:</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    command <span class="op">=</span> re.findall(<span class="st">"(bot|value|output) (\d+)"</span>, line)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    numbers <span class="op">=</span> [<span class="bu">int</span>(x[<span class="dv">1</span>]) <span class="cf">for</span> x <span class="kw">in</span> command]</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    names <span class="op">=</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> command]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(command) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        state[numbers[<span class="dv">1</span>]].append(numbers[<span class="dv">0</span>])</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        wiring[numbers[<span class="dv">0</span>]] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">zip</span>(names[<span class="dv">1</span>:], numbers[<span class="dv">1</span>:])]</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>queue <span class="op">=</span> deque([x <span class="cf">for</span> x <span class="kw">in</span> start <span class="cf">if</span> <span class="bu">len</span>(state[x]) <span class="op">==</span> <span class="dv">2</span>])</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> <span class="dv">21</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> step():</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> queue.popleft()</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> <span class="bu">sorted</span>(state[current])</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    state[current] <span class="op">=</span> []</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    left, right <span class="op">=</span> wiring[current]</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, (name, value) <span class="kw">in</span> <span class="bu">enumerate</span>(wiring[current]):</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> name <span class="op">==</span> <span class="st">"bot"</span>:</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>            state[value].append(values[idx])</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(state[value]) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>                queue.append(value)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>            output[value] <span class="op">=</span> values[idx]</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current, values</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    current, values <span class="op">=</span> step()</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> values <span class="op">==</span> [<span class="dv">17</span>, <span class="dv">61</span>]:</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>current</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-9" class="level2">
<h2 class="anchored" data-anchor-id="part-2-9">Part 2</h2>
<p>With Part 1 out of the way, part 2 is just</p>
<div class="cell" data-execution_count="21">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> queue:</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    step()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>np.product(output[:<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-11-radioisotope-thermoelectric-generators" class="level1">
<h1><a href="https://adventofcode.com/2016/day/11">Day 11: Radioisotope Thermoelectric Generators</a></h1>
<section id="part-1-10" class="level2">
<h2 class="anchored" data-anchor-id="part-1-10">Part 1</h2>
<p>This one looks difficult, but I don’t think it is too tricky. Given that we are in floor <span class="math inline">\(n\)</span>, the valid next positions are us at floor <span class="math inline">\(n+1\)</span> or <span class="math inline">\(n - 1\)</span>, with up to two items moved; with the items moved being subject to the puzzle constraints.</p>
<p>So I think the way to go is A*.</p>
<div class="cell" data-execution_count="22">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> more_itertools <span class="im">import</span> grouper</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>n_floors <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> distance_estimate(state, end):</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    items <span class="op">=</span> state[<span class="dv">1</span>]</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>((val <span class="op">/</span> <span class="dv">2</span>) <span class="op">*</span> (n_floors <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>) <span class="cf">for</span> i, val <span class="kw">in</span> <span class="bu">enumerate</span>(items))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid(items):</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    generators, chips <span class="op">=</span> state[::<span class="dv">2</span>], state[<span class="dv">1</span>::<span class="dv">2</span>]</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        (chip <span class="op">==</span> generator) <span class="kw">or</span> (chip <span class="kw">not</span> <span class="kw">in</span> generators)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> chip, generator <span class="kw">in</span> <span class="bu">zip</span>(chips, generators)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize(items):</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(x <span class="cf">for</span> pair <span class="kw">in</span> <span class="bu">sorted</span>(<span class="bu">list</span>(grouper(items, <span class="dv">2</span>))) <span class="cf">for</span> x <span class="kw">in</span> pair)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> constrained_neighbors(state):</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    floor, items <span class="op">=</span> state</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    active_indices <span class="op">=</span> [index <span class="cf">for</span> index, val <span class="kw">in</span> <span class="bu">enumerate</span>(items) <span class="cf">if</span> val <span class="op">==</span> floor]</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> new_floor <span class="kw">in</span> [floor <span class="op">+</span> <span class="dv">1</span>, floor <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> (<span class="dv">0</span> <span class="op">&lt;=</span> new_floor <span class="op">&lt;</span> n_floors):</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>        moves <span class="op">=</span> [[x] <span class="cf">for</span> x <span class="kw">in</span> active_indices]</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> new_floor <span class="op">==</span> floor <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>            moves <span class="op">=</span> itertools.chain(moves, itertools.combinations(active_indices, <span class="dv">2</span>))</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> move <span class="kw">in</span> moves:</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>            new_items <span class="op">=</span> <span class="bu">list</span>(items)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> index <span class="kw">in</span> move:</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>                new_items[index] <span class="op">=</span> new_floor</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> is_valid(new_items):</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>                neighbors.add((new_floor, normalize(new_items)))</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbors</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="dv">0</span>, (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="dv">3</span>, (<span class="dv">3</span>,) <span class="op">*</span> <span class="bu">len</span>(state[<span class="dv">1</span>])</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>utils.astar(state, target, constrained_neighbors, distance_estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-10" class="level2">
<h2 class="anchored" data-anchor-id="part-2-10">Part 2</h2>
<p>Extending this to part 2 without changing anything is possible, but the whole thing takes about a minute and a half to run. When I have time, I’ll come back and look at it again.</p>
<p>Reducing the search space by only letting the elevator move down with one item at a time reduced the runtime to about half. I’m not 100% convinced the restriction is always valid, but it did work in this case.</p>
<div class="cell" data-execution_count="23">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="dv">0</span>, (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="dv">3</span>, (<span class="dv">3</span>,) <span class="op">*</span> <span class="bu">len</span>(state[<span class="dv">1</span>])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>utils.astar(state, target, constrained_neighbors, distance_estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-12-leonardos-monorail" class="level1">
<h1><a href="https://adventofcode.com/2016/day/12">Day 12: Leonardo’s Monorail</a></h1>
<section id="part-1-11" class="level2">
<h2 class="anchored" data-anchor-id="part-1-11">Part 1</h2>
<p>This is a fairly straightforward implementation of the problem description, with no particular cleverness going on. We have two types of instructions - ones that take two operands, and ones that take only one, and we can treat those together.</p>
<div class="cell" data-execution_count="24">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run(program, registers<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> registers <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        registers <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(program):</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        instruction <span class="op">=</span> program[ip]</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        operator, operands <span class="op">=</span> instruction[<span class="dv">0</span>], instruction[<span class="dv">1</span>:]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> operator <span class="kw">in</span> [<span class="st">"cpy"</span>, <span class="st">"jnz"</span>]:</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>            source, destination <span class="op">=</span> operands</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>            value <span class="op">=</span> <span class="bu">int</span>(source) <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> <span class="st">"abcd"</span> <span class="cf">else</span> registers[source]</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> operator <span class="op">==</span> <span class="st">"cpy"</span>:</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                registers[destination] <span class="op">=</span> value</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> operator <span class="op">==</span> <span class="st">"jnz"</span> <span class="kw">and</span> value <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                ip <span class="op">+=</span> <span class="bu">int</span>(destination) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> operator <span class="kw">in</span> [<span class="st">"inc"</span>, <span class="st">"dec"</span>]:</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>            registers[operands[<span class="dv">0</span>]] <span class="op">+=</span> <span class="dv">2</span> <span class="op">*</span> (operator <span class="op">==</span> <span class="st">"inc"</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> registers[<span class="st">"a"</span>]</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [line.split(<span class="st">" "</span>) <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">12</span>)]</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>run(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-11" class="level2">
<h2 class="anchored" data-anchor-id="part-2-11">Part 2</h2>
<div class="cell" data-execution_count="25">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>registers[<span class="st">"c"</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>run(data, registers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-13-a-maze-of-twisty-little-cubicles" class="level1">
<h1><a href="https://adventofcode.com/2016/day/13">Day 13: A Maze of Twisty Little Cubicles</a></h1>
<section id="part-1-12" class="level2">
<h2 class="anchored" data-anchor-id="part-1-12">Part 1</h2>
<div class="cell" data-execution_count="26">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> astar</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid(x, y, secret<span class="op">=</span><span class="dv">1362</span>):</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> y <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    val <span class="op">=</span> x <span class="op">*</span> x <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> x <span class="op">*</span> y <span class="op">+</span> y <span class="op">+</span> y <span class="op">*</span> y <span class="op">+</span> secret</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    ones <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>val<span class="sc">:b}</span><span class="ss">"</span>.count(<span class="st">"1"</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (ones <span class="op">%</span> <span class="dv">2</span>) <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> neighbors(state):</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> state</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    candidates <span class="op">=</span> [(x <span class="op">-</span> <span class="dv">1</span>, y), (x <span class="op">+</span> <span class="dv">1</span>, y), (x, y <span class="op">-</span> <span class="dv">1</span>), (x, y <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [candidate <span class="cf">for</span> candidate <span class="kw">in</span> candidates <span class="cf">if</span> is_valid(<span class="op">*</span>candidate)]</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> distance_function(point, target):</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">abs</span>(point[<span class="dv">0</span>] <span class="op">-</span> target[<span class="dv">0</span>]) <span class="op">+</span> <span class="bu">abs</span>(point[<span class="dv">1</span>] <span class="op">-</span> target[<span class="dv">1</span>])</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="dv">31</span>, <span class="dv">39</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>utils.astar(start, target, neighbors, distance_function)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-12" class="level2">
<h2 class="anchored" data-anchor-id="part-2-12">Part 2</h2>
<div class="cell" data-execution_count="27">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(utils.bfs((<span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">lambda</span> cost, state: cost <span class="op">&gt;</span> <span class="dv">50</span>, neighbors, return_visited<span class="op">=</span><span class="va">True</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-14-one-time-pad" class="level1">
<h1><a href="https://adventofcode.com/2016/day/14">Day 14: One-Time Pad</a></h1>
<section id="part-1-13" class="level2">
<h2 class="anchored" data-anchor-id="part-1-13">Part 1</h2>
<div class="cell" data-execution_count="28">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> infinite_triples(prefix, part<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    r1 <span class="op">=</span> <span class="vs">r"(.)\1\1"</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> <span class="vs">r"(.)\1\1\1\1"</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> hashlib.md5((prefix <span class="op">+</span> <span class="bu">str</span>(n)).encode()).hexdigest()</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> part <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2016</span>):</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                s <span class="op">=</span> hashlib.md5(s.encode()).hexdigest()</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> r <span class="op">:=</span> re.search(r1, s):</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (r.groups(<span class="dv">1</span>)[<span class="dv">0</span>], re.findall(r2, s))</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> <span class="va">False</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        n <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nth_key_index(prefix, n<span class="op">=</span><span class="dv">64</span>, part<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    triples <span class="op">=</span> <span class="bu">filter</span>(<span class="kw">lambda</span> x: x[<span class="dv">1</span>], <span class="bu">enumerate</span>(infinite_triples(prefix, part)))</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    window <span class="op">=</span> [<span class="bu">next</span>(triples)]</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current <span class="op">&lt;</span> n:</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        idx, (triple, _) <span class="op">=</span> window.pop(<span class="dv">0</span>)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="kw">not</span> window <span class="kw">or</span> window[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">&lt;</span> idx <span class="op">+</span> <span class="dv">1000</span>:</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>            window.append(<span class="bu">next</span>(triples))</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>        active_quints <span class="op">=</span> [char <span class="cf">for</span> triple <span class="kw">in</span> window[:<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> char <span class="kw">in</span> triple[<span class="dv">1</span>][<span class="dv">1</span>]]</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> triple <span class="kw">in</span> active_quints:</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>            current <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>nth_key_index(<span class="st">"yjdafjpo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-13" class="level2">
<h2 class="anchored" data-anchor-id="part-2-13">Part 2</h2>
<p>I was a little uncertain about how to write this cleanly – all of the logic from part one is the same, the only difference is how the hash is generated. In the end, I made a toggle in the <code>infinite_triples</code> function, which is why part 2 can be solved by writing just:</p>
<div class="cell" data-execution_count="29">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>nth_key_index(<span class="st">"yjdafjpo"</span>, part<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-15-timing-is-everything" class="level1">
<h1><a href="https://adventofcode.com/2016/day/15">Day 15: Timing is Everything</a></h1>
<section id="part-1-14" class="level2">
<h2 class="anchored" data-anchor-id="part-1-14">Part 1</h2>
<p>Another round of the chinese remainder theorem.</p>
<div class="cell" data-execution_count="30">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> crt</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> re.findall(<span class="vs">r"\d+"</span>, line)] <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">15</span>)]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>remainders <span class="op">=</span> [(x[<span class="dv">1</span>], <span class="op">-</span>(x[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> x[<span class="dv">0</span>])) <span class="cf">for</span> x <span class="kw">in</span> data]</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>crt(remainders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-14" class="level2">
<h2 class="anchored" data-anchor-id="part-2-14">Part 2</h2>
<div class="cell" data-execution_count="31">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>remainders.append([<span class="dv">11</span>, <span class="op">-</span>(<span class="bu">len</span>(remainders) <span class="op">+</span> <span class="dv">1</span>)])</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>crt(remainders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-16-dragon-checksum" class="level1">
<h1><a href="https://adventofcode.com/2016/day/16">Day 16: Dragon Checksum</a></h1>
<section id="part-1-15" class="level2">
<h2 class="anchored" data-anchor-id="part-1-15">Part 1</h2>
<div class="cell" data-execution_count="32">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="dv">272</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solve(prefix, length):</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(prefix) <span class="op">&lt;</span> length:</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> prefix <span class="op">+</span> [<span class="dv">0</span>] <span class="op">+</span> [<span class="dv">1</span> <span class="op">^</span> x <span class="cf">for</span> x <span class="kw">in</span> prefix[::<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> prefix[:length]</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(s) <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> <span class="bu">abs</span>(np.diff(s))[::<span class="dv">2</span>] <span class="op">^</span> <span class="dv">1</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>solve(start, length), sep<span class="op">=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-15" class="level2">
<h2 class="anchored" data-anchor-id="part-2-15">Part 2</h2>
<div class="cell" data-execution_count="33">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>solve(start, <span class="dv">35651584</span>), sep<span class="op">=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-17-two-steps-forward" class="level1">
<h1><a href="https://adventofcode.com/2016/day/17">Day 17: Two Steps Forward</a></h1>
<section id="part-1-16" class="level2">
<h2 class="anchored" data-anchor-id="part-1-16">Part 1</h2>
<p>BFS to the rescue. I wanted to do A*, but the “distance from 3,3” heuristic didn’t seem like it would give much. Then I dropped to Dijkstra, but realised that if all steps cost the same, that’s just BFS.</p>
<div class="cell" data-execution_count="34">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> (<span class="dv">0</span>, <span class="st">"bwnlcvfs"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> neighbors(position, path):</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    chars <span class="op">=</span> hashlib.md5(path.encode()).hexdigest()[:<span class="dv">4</span>]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    directions <span class="op">=</span> <span class="st">"UDLR"</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    deltas <span class="op">=</span> <span class="op">-</span><span class="ot">1j</span>, <span class="ot">1j</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    candidates <span class="op">=</span> [</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>        (position <span class="op">+</span> delta, path <span class="op">+</span> direction)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> delta, direction, char <span class="kw">in</span> <span class="bu">zip</span>(deltas, directions, chars)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> char <span class="kw">in</span> <span class="st">"bcdef"</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>        candidate</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> candidate <span class="kw">in</span> candidates</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="dv">0</span> <span class="op">&lt;=</span> candidate[<span class="dv">0</span>].real <span class="op">&lt;</span> <span class="dv">4</span> <span class="kw">and</span> <span class="dv">0</span> <span class="op">&lt;=</span> candidate[<span class="dv">0</span>].imag <span class="op">&lt;</span> <span class="dv">4</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> deque([start])</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> q:</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    position, path <span class="op">=</span> q.popleft()</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> position <span class="op">==</span> <span class="dv">3</span> <span class="op">+</span> <span class="ot">3j</span>:</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> path[<span class="bu">len</span>(start[<span class="dv">1</span>]) :]</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    q <span class="op">+=</span> deque(neighbors(position, path))</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-16" class="level2">
<h2 class="anchored" data-anchor-id="part-2-16">Part 2</h2>
<div class="cell" data-execution_count="35">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> deque([start])</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> q:</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    position, path <span class="op">=</span> q.popleft()</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> position <span class="op">==</span> <span class="dv">3</span> <span class="op">+</span> <span class="ot">3j</span>:</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="bu">len</span>(path) <span class="op">-</span> <span class="bu">len</span>(start[<span class="dv">1</span>])</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    q <span class="op">+=</span> deque(neighbors(position, path))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-18-like-a-rogue" class="level1">
<h1><a href="https://adventofcode.com/2016/day/18">Day 18: Like a Rogue</a></h1>
<section id="part-2-17" class="level2">
<h2 class="anchored" data-anchor-id="part-2-17">Part 2</h2>
<div class="cell" data-execution_count="36">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([<span class="dv">1</span> <span class="cf">if</span> char <span class="op">==</span> <span class="st">"^"</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> char <span class="kw">in</span> load(<span class="dv">18</span>)[<span class="dv">0</span>]], dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>left_right <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> []</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">40</span>):</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    rows.append(data)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> (scipy.ndimage.convolve(data, left_right, mode<span class="op">=</span><span class="st">"constant"</span>) <span class="op">==</span> <span class="dv">1</span>).astype(<span class="bu">int</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>(np.array(rows) <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-18" class="level2">
<h2 class="anchored" data-anchor-id="part-2-18">Part 2</h2>
<p>For part 2 I should probably check to see if I ever hit a row that I’ve seen before, and then use the repeated cycle to avoid having to calculate that many rows. Or I can just brute force it and not care:</p>
<div class="cell" data-execution_count="37">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">400000</span> <span class="op">-</span> <span class="dv">40</span>):</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    rows.append(data)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> (scipy.ndimage.convolve(data, left_right, mode<span class="op">=</span><span class="st">"constant"</span>) <span class="op">==</span> <span class="dv">1</span>).astype(<span class="bu">int</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>(np.array(rows) <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-19-an-elephant-named-joseph" class="level1">
<h1><a href="https://adventofcode.com/2016/day/19">Day 19: An Elephant Named Joseph</a></h1>
<section id="part-1-17" class="level2">
<h2 class="anchored" data-anchor-id="part-1-17">Part 1</h2>
<p>This problem – with rotations by 1 and deletions only of neighboring elves is definitely calling for a deque:</p>
<div class="cell" data-execution_count="38">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>limit <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, limit <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>queue <span class="op">=</span> deque(numbers)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> queue:</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    queue.rotate(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> queue.popleft()</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-19" class="level2">
<h2 class="anchored" data-anchor-id="part-2-19">Part 2</h2>
<p>Unfortunately, the same approach won’t work here, since the rotations to the middle of the queue really ruin everything.</p>
<p>What we can do instead is notice that the pattern of deletions correspond to leaving every third elf alive, starting just after halfway around the circle. To avoid interference from potentially dead elves, we can play the game in rounds, with one round ending whenever an elf at the start of the line would have died. In each round then, a number of elves at the start of the line get to take presents, a number in the middle do nothing, and a number at the end are eliminated from the game. What each of these lists looks like is not too hard to determine:</p>
<div class="cell" data-execution_count="39">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> one_round(mylist):</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> <span class="bu">len</span>(mylist)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">int</span>((l <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">3</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    middle <span class="op">=</span> mylist[<span class="bu">int</span>(l <span class="op">/</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> l <span class="op">%</span> <span class="dv">2</span> :: <span class="dv">3</span>]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mylist[n : <span class="bu">int</span>(l <span class="op">/</span> <span class="dv">2</span>)] <span class="op">+</span> middle <span class="op">+</span> mylist[:n]</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">3005290</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, i <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">len</span>(x) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> one_round(x)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-20-firewall-rules" class="level1">
<h1><a href="https://adventofcode.com/2016/day/20">Day 20: Firewall Rules</a></h1>
<section id="part-1-18" class="level2">
<h2 class="anchored" data-anchor-id="part-1-18">Part 1</h2>
<div class="cell" data-execution_count="40">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="bu">sorted</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split(<span class="st">"-"</span>)] <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">20</span>)], key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">0</span>]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>low, high <span class="op">=</span> data[<span class="dv">0</span>]</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> new_low, new_high <span class="kw">in</span> data[<span class="dv">1</span>:]:</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> high <span class="op">+</span> <span class="dv">1</span> <span class="op">&lt;</span> new_low:</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>        high <span class="op">=</span> <span class="bu">max</span>(high, new_high)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>high <span class="op">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-20" class="level2">
<h2 class="anchored" data-anchor-id="part-2-20">Part 2</h2>
<p>We’ll start by merging the overlapping banned ranges together. Then, the high point of one range and the low point of the next range define a range of allowed values (endpoints not included). We can sum the length of these to get the total number of allowed values.</p>
<div class="cell" data-execution_count="41">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_ranges(data):</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> []</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    initial, final <span class="op">=</span> data[<span class="dv">0</span>]</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> low, high <span class="kw">in</span> data[<span class="dv">1</span>:]:</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> final <span class="op">+</span> <span class="dv">1</span> <span class="op">&gt;=</span> low:</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>            final <span class="op">=</span> <span class="bu">max</span>(high, final)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>            result <span class="op">+=</span> [initial, final]</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>            initial, final <span class="op">=</span> low, high</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    result <span class="op">+=</span> [initial, final]</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> ranges[<span class="dv">0</span>]</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="bu">sum</span>([high <span class="op">-</span> low <span class="op">-</span> <span class="dv">1</span> <span class="cf">for</span> low, high <span class="kw">in</span> <span class="bu">zip</span>(ranges[<span class="dv">1</span>::<span class="dv">2</span>], ranges[<span class="dv">2</span>::<span class="dv">2</span>])])</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="dv">4294967295</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> ranges[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-21-scrambled-letters-and-hash" class="level1">
<h1><a href="https://adventofcode.com/2016/day/21">Day 21: Scrambled Letters and Hash</a></h1>
<section id="part-1-19" class="level2">
<h2 class="anchored" data-anchor-id="part-1-19">Part 1</h2>
<div class="cell" data-execution_count="42">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">21</span>)]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="st">"abcdefgh"</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update(s, line, part<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    operands <span class="op">=</span> line[<span class="dv">2</span>], line[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> line[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"reverse"</span>:</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>        l, r <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">map</span>(<span class="bu">int</span>, operands))</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s[:l] <span class="op">+</span> s[l : r <span class="op">+</span> <span class="dv">1</span>][::<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> s[r <span class="op">+</span> <span class="dv">1</span> :]</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> line[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"swap"</span>:</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"letter"</span>:</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>            l, r <span class="op">=</span> <span class="bu">map</span>(<span class="kw">lambda</span> x: s.index(x), operands)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>            l, r <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, operands)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        l, r <span class="op">=</span> <span class="bu">sorted</span>([l, r])</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s[:l] <span class="op">+</span> s[r] <span class="op">+</span> s[l <span class="op">+</span> <span class="dv">1</span> : r] <span class="op">+</span> s[l] <span class="op">+</span> s[r <span class="op">+</span> <span class="dv">1</span> :]</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> line[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"rotate"</span>:</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"left"</span>:</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>            rotation <span class="op">=</span> <span class="op">-</span><span class="bu">int</span>(operands[<span class="dv">0</span>])</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> line[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"right"</span>:</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>            rotation <span class="op">=</span> <span class="bu">int</span>(operands[<span class="dv">0</span>])</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> part <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>                index <span class="op">=</span> s.index(operands[<span class="dv">1</span>])</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>                rotation <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> index <span class="op">+</span> (index <span class="op">&gt;=</span> <span class="dv">4</span>)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> part <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>                rotation <span class="op">=</span> reverse_rotation(s, operands[<span class="dv">1</span>])</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> part <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>            rotation <span class="op">=</span> <span class="op">-</span>rotation</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>        rotation <span class="op">=</span> rotation <span class="op">%</span> <span class="bu">len</span>(s)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s[<span class="op">-</span>rotation:] <span class="op">+</span> s[:<span class="op">-</span>rotation]</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> line[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"move"</span>:</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>        source, dest <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, operands)</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> part <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>            source, dest <span class="op">=</span> dest, source</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>        tmp <span class="op">=</span> s[:source] <span class="op">+</span> s[source <span class="op">+</span> <span class="dv">1</span> :]</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> tmp[:dest] <span class="op">+</span> s[source] <span class="op">+</span> tmp[dest:]</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> data:</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> update(s, line)</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-21" class="level2">
<h2 class="anchored" data-anchor-id="part-2-21">Part 2</h2>
<p>Ouch. <code>move</code>, <code>swap</code> and <code>reverse</code> should be easy to do backwards, since they’re self-inverses (potentially with the arguments swapped). The issue is <code>rotate</code>. When we have to go left/right a fixed number of steps there’s no problem, since we just go the other way. For the last one the issue is that the amount we have to rotate by depends on what the state was prior to the rotation. Luckily there aren’t that many possible rotations, so the best approach seems to be to just to see which potential preimage string gives the correct answer when rotated.</p>
<div class="cell" data-execution_count="43">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rotate_based_on(s, char):</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    index <span class="op">=</span> s.index(char)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    rotation <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> index <span class="op">+</span> (index <span class="op">&gt;=</span> <span class="dv">4</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    rotation <span class="op">=</span> rotation <span class="op">%</span> <span class="bu">len</span>(s)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s[<span class="op">-</span>rotation:] <span class="op">+</span> s[:<span class="op">-</span>rotation]</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_rotation(s, char):</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, original_string <span class="kw">in</span> [(i, s[<span class="op">-</span>i:] <span class="op">+</span> s[:<span class="op">-</span>i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(s))]:</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> rotate_based_on(original_string, char) <span class="op">==</span> s:</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span>i</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="st">"fbgdceah"</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> data[::<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> update(s, line, part<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-22-grid-computing" class="level1">
<h1><a href="https://adventofcode.com/2016/day/22">Day 22: Grid Computing</a></h1>
<section id="part-1-20" class="level2">
<h2 class="anchored" data-anchor-id="part-1-20">Part 1</h2>
<div class="cell" data-execution_count="44">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">22</span>, <span class="st">"int"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>data.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> binary_search(key, haystack):</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    key <span class="op">=</span> key[<span class="dv">3</span>]</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    left, right <span class="op">=</span> <span class="dv">0</span>, <span class="bu">len</span>(haystack)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (right <span class="op">-</span> left) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        midpoint <span class="op">=</span> <span class="bu">int</span>((left <span class="op">+</span> right) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> haystack[midpoint][<span class="op">-</span><span class="dv">2</span>] <span class="op">&gt;=</span> key:</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>            right <span class="op">=</span> midpoint</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>            left <span class="op">=</span> midpoint</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> right</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx1, val <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val[<span class="dv">3</span>] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    idx2 <span class="op">=</span> binary_search(val, data)</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    result <span class="op">+=</span> <span class="bu">len</span>(data[idx2:]) <span class="op">+</span> (idx2 <span class="op">&lt;=</span> idx1)</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-22" class="level2">
<h2 class="anchored" data-anchor-id="part-2-22">Part 2</h2>
<p>Just another graph search. There’s only one empty space, so we can uniquely define the current state by the location of the empty space, and the location of the data we’re trying to move.</p>
<div class="cell" data-execution_count="45">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> np.array(data)[:, :<span class="dv">2</span>].<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> np.ones(size <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array(data)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>grid[<span class="bu">tuple</span>(data[np.where(data[:, <span class="dv">2</span>] <span class="op">&gt;</span> <span class="dv">200</span>)][:, :<span class="dv">2</span>].T)] <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>source <span class="op">=</span> <span class="bu">tuple</span>(data[<span class="op">-</span><span class="dv">1</span>][:<span class="dv">2</span>])</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>grid[source] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> size[<span class="dv">0</span>], <span class="dv">0</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> heuristic(x, y):</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    to_data <span class="op">=</span> <span class="bu">abs</span>(x[<span class="dv">0</span>] <span class="op">-</span> y[<span class="dv">0</span>]) <span class="op">+</span> <span class="bu">abs</span>(x[<span class="dv">1</span>] <span class="op">-</span> y[<span class="dv">1</span>])</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span> <span class="op">*</span> (<span class="bu">abs</span>(y[<span class="dv">0</span>]) <span class="op">+</span> <span class="bu">abs</span>(y[<span class="dv">1</span>]) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> to_data <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> neighbors(x, y):</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    new_states <span class="op">=</span> []</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> dx, dy <span class="kw">in</span> [(<span class="dv">0</span>, <span class="dv">1</span>), (<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>), (<span class="dv">1</span>, <span class="dv">0</span>), (<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)]:</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>        new_x <span class="op">=</span> x[<span class="dv">0</span>] <span class="op">+</span> dx, x[<span class="dv">1</span>] <span class="op">+</span> dy</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>            new_x[<span class="dv">0</span>] <span class="op">&lt;</span> <span class="dv">0</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">or</span> new_x[<span class="dv">1</span>] <span class="op">&lt;</span> <span class="dv">0</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">or</span> new_x[<span class="dv">0</span>] <span class="op">&gt;</span> size[<span class="dv">0</span>]</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">or</span> new_x[<span class="dv">1</span>] <span class="op">&gt;</span> size[<span class="dv">1</span>]</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>            <span class="kw">or</span> grid[new_x] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> new_x <span class="op">==</span> y:</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>            new_states.append((new_x, (x[<span class="dv">0</span>], x[<span class="dv">1</span>])))</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>            new_states.append((new_x, y))</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_states</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>queue <span class="op">=</span> PriorityQueue()</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>queue.put((<span class="dv">0</span>, source, target))</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>costs <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: np.inf)</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>costs[source, target] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> queue.qsize() <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>    _, x, y <span class="op">=</span> queue.get()</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> y <span class="op">==</span> (<span class="dv">0</span>, <span class="dv">0</span>):</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> costs[x, y]</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> neighbors(x, y):</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>        current_cost <span class="op">=</span> costs[x, y] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_cost <span class="op">&lt;</span> costs[a, b]:</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>            costs[a, b] <span class="op">=</span> current_cost</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>            queue.put((current_cost <span class="op">+</span> heuristic(a, b), a, b))</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-23-safe-cracking" class="level1">
<h1><a href="https://adventofcode.com/2016/day/23">Day 23: Safe Cracking</a></h1>
<section id="part-1-21" class="level2">
<h2 class="anchored" data-anchor-id="part-1-21">Part 1</h2>
<div class="cell" data-execution_count="46">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>toggle_map <span class="op">=</span> {<span class="st">"inc"</span>: <span class="st">"dec"</span>, <span class="st">"tgl"</span>: <span class="st">"inc"</span>, <span class="st">"dec"</span>: <span class="st">"inc"</span>, <span class="st">"cpy"</span>: <span class="st">"jnz"</span>, <span class="st">"jnz"</span>: <span class="st">"cpy"</span>}</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run(program, registers<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> registers <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>        registers <span class="op">=</span> {<span class="st">"a"</span>: <span class="dv">0</span>, <span class="st">"b"</span>: <span class="dv">0</span>, <span class="st">"c"</span>: <span class="dv">0</span>, <span class="st">"d"</span>: <span class="dv">0</span>}</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_operands(ip):</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>        instruction <span class="op">=</span> program[ip]</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> instruction[<span class="dv">0</span>], instruction[<span class="dv">1</span>:]</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> evaluate_operand(x):</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(x) <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> <span class="st">"abcd"</span> <span class="cf">else</span> registers[x]</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(program):</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>        i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>        operator, operands <span class="op">=</span> extract_operands(ip)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> operator <span class="kw">in</span> [<span class="st">"cpy"</span>, <span class="st">"jnz"</span>]:</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>            source, destination <span class="op">=</span> operands</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>            value <span class="op">=</span> evaluate_operand(source)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> operator <span class="op">==</span> <span class="st">"cpy"</span>:</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>                registers[destination] <span class="op">=</span> value</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> operator <span class="op">==</span> <span class="st">"jnz"</span> <span class="kw">and</span> value <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>                ip <span class="op">+=</span> evaluate_operand(destination) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> operator <span class="kw">in</span> [<span class="st">"inc"</span>, <span class="st">"dec"</span>]:</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>            registers[operands[<span class="dv">0</span>]] <span class="op">+=</span> <span class="dv">2</span> <span class="op">*</span> (operator <span class="op">==</span> <span class="st">"inc"</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> operator <span class="op">==</span> <span class="st">"tgl"</span>:</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>            destination <span class="op">=</span> ip <span class="op">+</span> evaluate_operand(operands[<span class="dv">0</span>])</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>                operator, operands <span class="op">=</span> extract_operands(destination)</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>                operator <span class="op">=</span> toggle_map[operator]</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>                program[destination] <span class="op">=</span> [operator] <span class="op">+</span> operands</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">IndexError</span>:</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>        ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> registers[<span class="st">"a"</span>]</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [line.split(<span class="st">" "</span>) <span class="cf">for</span> line <span class="kw">in</span> load(<span class="st">"23"</span>)]</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> {<span class="st">"a"</span>: <span class="dv">7</span>, <span class="st">"b"</span>: <span class="dv">0</span>, <span class="st">"c"</span>: <span class="dv">0</span>, <span class="st">"d"</span>: <span class="dv">0</span>}</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>run(data, registers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-23" class="level2">
<h2 class="anchored" data-anchor-id="part-2-23">Part 2</h2>
<p>Just setting the registers to <code>registers = {"a": 12, "b": 0, "c": 0, "d": 0}</code> didn’t work, since the code was running incredibly slowly. I ended up analysing my input script instead. The first line copied a to b, and lines 2-16 multiplied a by (b - 1), decreased b by one and set c to 2b (ish). Then came the toggle instruction, and the two instructions after that sent us back to line 2.</p>
<p>Some things that stood out here were that c was an even number, decreasing by 2 each iteration so <code>tgl c</code> tried to toggle every other instruction, starting at the end of the program and moving back towards the <code>tgl</code> instruction itself. That means that the loop before the toggle instruction is unaffected for a long time, and so after the ith iteration we have a = n * (n - 1) * (n - 2) * … * (n - i). This continues until b = 2, when the <code>tgl</code> instruction finally toggles the <code>jnz</code> on line 17. At that point we have <code>a = factorial(n)</code>. The (now-toggled) last section of the program then just adds the product of the numeric arguments on line 21 and 22.</p>
<p>And that’s the final answer.</p>
</section>
</section>
<section id="day-24-air-duct-spelunking" class="level1">
<h1><a href="https://adventofcode.com/2016/day/24">Day 24: Air Duct Spelunking</a></h1>
<section id="part-1-22" class="level2">
<h2 class="anchored" data-anchor-id="part-1-22">Part 1</h2>
<p>This was a bit of a roller coaster. I originally used my pre-existing bfs code to search the maze, and it was unbelievably slow. Instead of investigating I decided to try and transform the maze, and found a conceptual approach which was horribly over-engineered, but probably would have worked. Before I finished implementing it, I thought of trying another BFS, less general and hence faster, and it ran more than fast enough. Oh well.</p>
<p>I still liked the original approach though. The idea was to simplify the graph of the maze via the following transformations:</p>
<ol type="1">
<li>Delete all empty (non-goal) nodes with only two neighbors by directly connecting their neighbors with a single edge, with a weight <span class="math inline">\(w = w_1 + w_2\)</span></li>
<li>Recursively remove all empty dead ends.</li>
<li>Identify bottlenecks in the graph, i.e.&nbsp;nodes whose removal would disconnect the graph. From there, generate the block-cut tree of the graph, and simplify each component of the block-cut to just the cut vertices and the goal nodes. This basically means that the problem of finding the shortest path X-&gt;Y is reduced to finding the shortest path to and from a given bottleneck, and then stitching the paths together.</li>
</ol>
<p>It was fun to think about even though I didn’t use it in the end.</p>
<div class="cell" data-execution_count="47">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.cluster.hierarchy <span class="im">import</span> DisjointSet</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>parse <span class="op">=</span> <span class="kw">lambda</span> x: <span class="op">-</span><span class="dv">2</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">"#"</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">"."</span> <span class="cf">else</span> <span class="bu">int</span>(x)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([[parse(char) <span class="cf">for</span> char <span class="kw">in</span> line] <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">24</span>)])</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> encode(mask):</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>([x <span class="op">+</span> <span class="ot">1j</span> <span class="op">*</span> y <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>np.where(mask))])</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> np.where(data <span class="op">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> data[nodes].argsort()</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> [x <span class="op">+</span> <span class="ot">1j</span> <span class="op">*</span> y <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>[index[order] <span class="cf">for</span> index <span class="kw">in</span> nodes])]</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>distances <span class="op">=</span> np.ones((<span class="bu">len</span>(nodes), <span class="bu">len</span>(nodes))) <span class="op">*</span> np.inf</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>node_indices <span class="op">=</span> {n: idx <span class="cf">for</span> idx, n <span class="kw">in</span> <span class="bu">enumerate</span>(nodes)}</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>open_squares <span class="op">=</span> encode(data <span class="op">&gt;</span> <span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> square <span class="kw">in</span> open_squares:</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> delta <span class="kw">in</span> (<span class="dv">1</span>, <span class="ot">1j</span>):</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> square <span class="op">+</span> delta <span class="kw">in</span> open_squares:</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>            graph[square].append(square <span class="op">+</span> delta)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>            graph[square <span class="op">+</span> delta].append(square)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node <span class="kw">in</span> nodes:</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> node_indices[node]</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>    queue <span class="op">=</span> deque([(<span class="dv">0</span>, node)])</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue <span class="kw">and</span> (distances[idx] <span class="op">==</span> np.inf).<span class="bu">any</span>():</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>        cost, state <span class="op">=</span> queue.popleft()</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> state <span class="kw">in</span> visited:</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>        visited.add(state)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> state <span class="kw">in</span> nodes:</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>            new_idx <span class="op">=</span> node_indices[state]</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>            distances[idx, new_idx] <span class="op">=</span> cost</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>            distances[new_idx, idx] <span class="op">=</span> cost</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[state]:</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>                queue.append((cost <span class="op">+</span> <span class="dv">1</span>, neighbor))</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>minval <span class="op">=</span> np.inf</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> permutation <span class="kw">in</span> itertools.permutations(<span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(nodes))):</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> (<span class="dv">0</span>,) <span class="op">+</span> permutation[:<span class="op">-</span><span class="dv">1</span>], permutation</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (total <span class="op">:=</span> <span class="bu">sum</span>(distances[indices])) <span class="op">&lt;</span> minval:</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>        minval <span class="op">=</span> total</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="bu">int</span>(minval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-24" class="level2">
<h2 class="anchored" data-anchor-id="part-2-24">Part 2</h2>
<div class="cell" data-execution_count="48">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>minval <span class="op">=</span> np.inf</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> permutation <span class="kw">in</span> itertools.permutations(<span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(nodes))):</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> (<span class="dv">0</span>,) <span class="op">+</span> permutation, permutation <span class="op">+</span> (<span class="dv">0</span>,)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (total <span class="op">:=</span> <span class="bu">sum</span>(distances[indices])) <span class="op">&lt;</span> minval:</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>        minval <span class="op">=</span> total</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="bu">int</span>(minval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-25-clock-signal" class="level1">
<h1><a href="https://adventofcode.com/2016/day/25">Day 25: Clock Signal</a></h1>
<section id="part-1-23" class="level2">
<h2 class="anchored" data-anchor-id="part-1-23">Part 1</h2>
<p>This is an interesting problem, because it requires more thinking and less coding. Blindly running the code provided in my input leads to infinite loops, and the question is then how to analyse these. In particular, we’re asked for an input that matches an infinite sequence of alternating ones and zeros, and we don’t really have any way of knowing that a sequence that looks promising doesn’t start to diverge after 100, 1000 or even 1,000,000 terms. Instead, I decided to analyse the provided code and understand what it was doing. After a bit of conversion, I found it to be equivalent to the following snippet:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clock(start):</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> a <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>            a <span class="op">=</span> start <span class="op">+</span> <span class="dv">2550</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> a <span class="op">%</span> <span class="dv">2</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">//</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>But that’s just the binary representation of (start + 2550) reversed and repeated endlessly. So we’re looking for the smallest number <span class="math inline">\(n\)</span> such that n + 2550 has a binary representation of the form <span class="math inline">\(101010\ldots\)</span></p>
<div class="cell" data-execution_count="49">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> x <span class="op">&lt;</span> <span class="dv">2550</span>:</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">-</span> <span class="dv">2550</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb51" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> 2016 Solutions</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Imports</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> functools</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict, deque</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> queue <span class="im">import</span> PriorityQueue</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> more_itertools</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>sys.path.insert(<span class="dv">1</span>, os.path.join(sys.path[<span class="dv">0</span>], <span class="st">".."</span>))</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> utils</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>load <span class="op">=</span> utils.year_load(<span class="dv">2016</span>)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 1: No Time for a Taxicab](https://adventofcode.com/2016/day/1)</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>How many blocks away is Easter Bunny HQ?</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> load(<span class="dv">1</span>)[<span class="dv">0</span>].split(<span class="st">", "</span>)</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>rotations <span class="op">=</span> {</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R"</span>: np.array([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]], dtype<span class="op">=</span><span class="bu">int</span>),</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"L"</span>: np.array([[<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>]], dtype<span class="op">=</span><span class="bu">int</span>),</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> instruction <span class="kw">in</span> instructions:</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">=</span> rotations[instruction[<span class="dv">0</span>]] <span class="op">@</span> direction</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>    position <span class="op">+=</span> direction <span class="op">*</span> <span class="bu">int</span>(instruction[<span class="dv">1</span>:])</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">abs</span>(position))</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>Then, you notice the instructions continue on the back of the Recruiting Document. Easter Bunny HQ is actually at the first location you visit twice.</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>seen <span class="op">=</span> {<span class="bu">tuple</span>(position): <span class="va">True</span>}</span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> instruction <span class="kw">in</span> instructions:</span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">=</span> rotations[instruction[<span class="dv">0</span>]] <span class="op">@</span> direction</span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(instruction[<span class="dv">1</span>:])):</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a>        position <span class="op">+=</span> direction</span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">tuple</span>(position) <span class="kw">in</span> seen:</span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a>        seen[<span class="bu">tuple</span>(position)] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">abs</span>(position))</span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 2: Bathroom Security](https://adventofcode.com/2016/day/2)</span></span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-79"><a href="#cb51-79" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-80"><a href="#cb51-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-83"><a href="#cb51-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-84"><a href="#cb51-84" aria-hidden="true" tabindex="-1"></a>commands <span class="op">=</span> {<span class="st">"U"</span>: <span class="op">-</span><span class="ot">1j</span>, <span class="st">"D"</span>: <span class="ot">1j</span>, <span class="st">"L"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"R"</span>: <span class="dv">1</span>}</span>
<span id="cb51-85"><a href="#cb51-85" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> {(x <span class="op">%</span> <span class="dv">3</span>) <span class="op">+</span> <span class="ot">1j</span> <span class="op">*</span> (x <span class="op">//</span> <span class="dv">3</span>): x <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)}</span>
<span id="cb51-86"><a href="#cb51-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-87"><a href="#cb51-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-88"><a href="#cb51-88" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update(point, grid, instructions):</span>
<span id="cb51-89"><a href="#cb51-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> instruction <span class="kw">in</span> instructions:</span>
<span id="cb51-90"><a href="#cb51-90" aria-hidden="true" tabindex="-1"></a>        new_point <span class="op">=</span> point <span class="op">+</span> commands[instruction]</span>
<span id="cb51-91"><a href="#cb51-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> new_point <span class="kw">in</span> grid:</span>
<span id="cb51-92"><a href="#cb51-92" aria-hidden="true" tabindex="-1"></a>            point <span class="op">=</span> new_point</span>
<span id="cb51-93"><a href="#cb51-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> point</span>
<span id="cb51-94"><a href="#cb51-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-95"><a href="#cb51-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-96"><a href="#cb51-96" aria-hidden="true" tabindex="-1"></a>point <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="ot">1j</span></span>
<span id="cb51-97"><a href="#cb51-97" aria-hidden="true" tabindex="-1"></a>password <span class="op">=</span> <span class="st">""</span></span>
<span id="cb51-98"><a href="#cb51-98" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> load(<span class="dv">2</span>)</span>
<span id="cb51-99"><a href="#cb51-99" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> instructions:</span>
<span id="cb51-100"><a href="#cb51-100" aria-hidden="true" tabindex="-1"></a>    point <span class="op">=</span> update(point, grid, line)</span>
<span id="cb51-101"><a href="#cb51-101" aria-hidden="true" tabindex="-1"></a>    password <span class="op">+=</span> <span class="bu">str</span>(grid[point])</span>
<span id="cb51-102"><a href="#cb51-102" aria-hidden="true" tabindex="-1"></a>password</span>
<span id="cb51-103"><a href="#cb51-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-104"><a href="#cb51-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-105"><a href="#cb51-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-106"><a href="#cb51-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-109"><a href="#cb51-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-110"><a href="#cb51-110" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> {</span>
<span id="cb51-111"><a href="#cb51-111" aria-hidden="true" tabindex="-1"></a>    <span class="ot">0j</span> <span class="op">+</span> <span class="dv">2</span>: <span class="dv">1</span>,</span>
<span id="cb51-112"><a href="#cb51-112" aria-hidden="true" tabindex="-1"></a>    <span class="ot">1j</span> <span class="op">+</span> <span class="dv">1</span>: <span class="dv">2</span>,</span>
<span id="cb51-113"><a href="#cb51-113" aria-hidden="true" tabindex="-1"></a>    <span class="ot">1j</span> <span class="op">+</span> <span class="dv">2</span>: <span class="dv">3</span>,</span>
<span id="cb51-114"><a href="#cb51-114" aria-hidden="true" tabindex="-1"></a>    <span class="ot">1j</span> <span class="op">+</span> <span class="dv">3</span>: <span class="dv">4</span>,</span>
<span id="cb51-115"><a href="#cb51-115" aria-hidden="true" tabindex="-1"></a>    <span class="ot">2j</span>: <span class="dv">5</span>,</span>
<span id="cb51-116"><a href="#cb51-116" aria-hidden="true" tabindex="-1"></a>    <span class="ot">2j</span> <span class="op">+</span> <span class="dv">1</span>: <span class="dv">6</span>,</span>
<span id="cb51-117"><a href="#cb51-117" aria-hidden="true" tabindex="-1"></a>    <span class="ot">2j</span> <span class="op">+</span> <span class="dv">2</span>: <span class="dv">7</span>,</span>
<span id="cb51-118"><a href="#cb51-118" aria-hidden="true" tabindex="-1"></a>    <span class="ot">2j</span> <span class="op">+</span> <span class="dv">3</span>: <span class="dv">8</span>,</span>
<span id="cb51-119"><a href="#cb51-119" aria-hidden="true" tabindex="-1"></a>    <span class="ot">2j</span> <span class="op">+</span> <span class="dv">4</span>: <span class="dv">9</span>,</span>
<span id="cb51-120"><a href="#cb51-120" aria-hidden="true" tabindex="-1"></a>    <span class="ot">3j</span> <span class="op">+</span> <span class="dv">1</span>: <span class="st">"A"</span>,</span>
<span id="cb51-121"><a href="#cb51-121" aria-hidden="true" tabindex="-1"></a>    <span class="ot">3j</span> <span class="op">+</span> <span class="dv">2</span>: <span class="st">"B"</span>,</span>
<span id="cb51-122"><a href="#cb51-122" aria-hidden="true" tabindex="-1"></a>    <span class="ot">3j</span> <span class="op">+</span> <span class="dv">3</span>: <span class="st">"C"</span>,</span>
<span id="cb51-123"><a href="#cb51-123" aria-hidden="true" tabindex="-1"></a>    <span class="ot">4j</span> <span class="op">+</span> <span class="dv">2</span>: <span class="st">"D"</span>,</span>
<span id="cb51-124"><a href="#cb51-124" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-125"><a href="#cb51-125" aria-hidden="true" tabindex="-1"></a>point <span class="op">=</span> <span class="ot">2j</span></span>
<span id="cb51-126"><a href="#cb51-126" aria-hidden="true" tabindex="-1"></a>password <span class="op">=</span> <span class="st">""</span></span>
<span id="cb51-127"><a href="#cb51-127" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> instructions:</span>
<span id="cb51-128"><a href="#cb51-128" aria-hidden="true" tabindex="-1"></a>    point <span class="op">=</span> update(point, grid, line)</span>
<span id="cb51-129"><a href="#cb51-129" aria-hidden="true" tabindex="-1"></a>    password <span class="op">+=</span> <span class="bu">str</span>(grid[point])</span>
<span id="cb51-130"><a href="#cb51-130" aria-hidden="true" tabindex="-1"></a>password</span>
<span id="cb51-131"><a href="#cb51-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-132"><a href="#cb51-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-133"><a href="#cb51-133" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 3: Squares with three sides](https://adventofcode.com/2016/day/3)</span></span>
<span id="cb51-134"><a href="#cb51-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-135"><a href="#cb51-135" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-136"><a href="#cb51-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-139"><a href="#cb51-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-140"><a href="#cb51-140" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array(load(<span class="dv">3</span>, <span class="st">"int"</span>), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb51-141"><a href="#cb51-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-142"><a href="#cb51-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-143"><a href="#cb51-143" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid(triangle):</span>
<span id="cb51-144"><a href="#cb51-144" aria-hidden="true" tabindex="-1"></a>    x, y, z <span class="op">=</span> triangle</span>
<span id="cb51-145"><a href="#cb51-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">+</span> y <span class="op">&gt;</span> z <span class="kw">and</span> x <span class="op">+</span> z <span class="op">&gt;</span> y <span class="kw">and</span> y <span class="op">+</span> z <span class="op">&gt;</span> x</span>
<span id="cb51-146"><a href="#cb51-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-147"><a href="#cb51-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-148"><a href="#cb51-148" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">map</span>(is_valid, data))</span>
<span id="cb51-149"><a href="#cb51-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-150"><a href="#cb51-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-151"><a href="#cb51-151" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-152"><a href="#cb51-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-155"><a href="#cb51-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-156"><a href="#cb51-156" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">map</span>(is_valid, data.T.ravel().reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>)))</span>
<span id="cb51-157"><a href="#cb51-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-158"><a href="#cb51-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-159"><a href="#cb51-159" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 4: Security Through Obscurity](https://adventofcode.com/2016/day/4)</span></span>
<span id="cb51-160"><a href="#cb51-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-161"><a href="#cb51-161" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-162"><a href="#cb51-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-165"><a href="#cb51-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-166"><a href="#cb51-166" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_line(room):</span>
<span id="cb51-167"><a href="#cb51-167" aria-hidden="true" tabindex="-1"></a>    checksum <span class="op">=</span> room[<span class="op">-</span><span class="dv">6</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb51-168"><a href="#cb51-168" aria-hidden="true" tabindex="-1"></a>    sector_id <span class="op">=</span> <span class="bu">int</span>(room[:<span class="op">-</span><span class="dv">7</span>].split(<span class="st">"-"</span>)[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb51-169"><a href="#cb51-169" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> <span class="st">"-"</span>.join(room.split(<span class="st">"-"</span>)[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb51-170"><a href="#cb51-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name, sector_id, checksum</span>
<span id="cb51-171"><a href="#cb51-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-172"><a href="#cb51-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-173"><a href="#cb51-173" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_checksum(name):</span>
<span id="cb51-174"><a href="#cb51-174" aria-hidden="true" tabindex="-1"></a>    occurrences <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(<span class="op">*</span>np.unique(<span class="bu">list</span>(name.replace(<span class="st">"-"</span>, <span class="st">""</span>)), return_counts<span class="op">=</span><span class="va">True</span>)))</span>
<span id="cb51-175"><a href="#cb51-175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join(x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">sorted</span>(occurrences, key<span class="op">=</span><span class="kw">lambda</span> x: [<span class="op">-</span>x[<span class="dv">1</span>], x[<span class="dv">0</span>]])[:<span class="dv">5</span>])</span>
<span id="cb51-176"><a href="#cb51-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-177"><a href="#cb51-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-178"><a href="#cb51-178" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [parse_line(l) <span class="cf">for</span> l <span class="kw">in</span> load(<span class="dv">4</span>)]</span>
<span id="cb51-179"><a href="#cb51-179" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(</span>
<span id="cb51-180"><a href="#cb51-180" aria-hidden="true" tabindex="-1"></a>    sector_id</span>
<span id="cb51-181"><a href="#cb51-181" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, sector_id, checksum <span class="kw">in</span> data</span>
<span id="cb51-182"><a href="#cb51-182" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> calculate_checksum(name) <span class="op">==</span> checksum</span>
<span id="cb51-183"><a href="#cb51-183" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-184"><a href="#cb51-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-185"><a href="#cb51-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-186"><a href="#cb51-186" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-187"><a href="#cb51-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-190"><a href="#cb51-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-191"><a href="#cb51-191" aria-hidden="true" tabindex="-1"></a>real_rooms <span class="op">=</span> [room[:<span class="dv">2</span>] <span class="cf">for</span> room <span class="kw">in</span> data <span class="cf">if</span> calculate_checksum(room[<span class="dv">0</span>]) <span class="op">==</span> room[<span class="dv">2</span>]]</span>
<span id="cb51-192"><a href="#cb51-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-193"><a href="#cb51-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-194"><a href="#cb51-194" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> decrypt(name, offset):</span>
<span id="cb51-195"><a href="#cb51-195" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="st">"abcdefghijklmnopqrstuvwxyz"</span></span>
<span id="cb51-196"><a href="#cb51-196" aria-hidden="true" tabindex="-1"></a>    shifted_alphabet <span class="op">=</span> <span class="st">""</span>.join(x <span class="cf">for</span> x <span class="kw">in</span> np.roll(<span class="bu">list</span>(alphabet), <span class="op">-</span>offset <span class="op">%</span> <span class="dv">26</span>))</span>
<span id="cb51-197"><a href="#cb51-197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name.translate(<span class="bu">str</span>.maketrans(alphabet, shifted_alphabet)), offset</span>
<span id="cb51-198"><a href="#cb51-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-199"><a href="#cb51-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-200"><a href="#cb51-200" aria-hidden="true" tabindex="-1"></a>[answer <span class="cf">for</span> room <span class="kw">in</span> real_rooms <span class="cf">if</span> <span class="st">"north"</span> <span class="kw">in</span> (answer <span class="op">:=</span> decrypt(<span class="op">*</span>room))[<span class="dv">0</span>]]</span>
<span id="cb51-201"><a href="#cb51-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-202"><a href="#cb51-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-203"><a href="#cb51-203" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 5: How About a Nice Game of Chess?](https://adventofcode.com/2016/day/5)</span></span>
<span id="cb51-204"><a href="#cb51-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-205"><a href="#cb51-205" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-206"><a href="#cb51-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-209"><a href="#cb51-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-210"><a href="#cb51-210" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb51-211"><a href="#cb51-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-212"><a href="#cb51-212" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> hashlib.md5()</span>
<span id="cb51-213"><a href="#cb51-213" aria-hidden="true" tabindex="-1"></a>prefix <span class="op">=</span> <span class="st">"wtnhxymk"</span></span>
<span id="cb51-214"><a href="#cb51-214" aria-hidden="true" tabindex="-1"></a>password <span class="op">=</span> <span class="st">""</span></span>
<span id="cb51-215"><a href="#cb51-215" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-216"><a href="#cb51-216" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">len</span>(password) <span class="op">&lt;</span> <span class="dv">8</span>:</span>
<span id="cb51-217"><a href="#cb51-217" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> hashlib.md5((prefix <span class="op">+</span> <span class="bu">str</span>(i)).encode(encoding<span class="op">=</span><span class="st">"UTF-8"</span>)).hexdigest()</span>
<span id="cb51-218"><a href="#cb51-218" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> s[:<span class="dv">5</span>] <span class="op">==</span> <span class="st">"0"</span> <span class="op">*</span> <span class="dv">5</span>:</span>
<span id="cb51-219"><a href="#cb51-219" aria-hidden="true" tabindex="-1"></a>        password <span class="op">=</span> password <span class="op">+</span> s[<span class="dv">5</span>]</span>
<span id="cb51-220"><a href="#cb51-220" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-221"><a href="#cb51-221" aria-hidden="true" tabindex="-1"></a>password</span>
<span id="cb51-222"><a href="#cb51-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-223"><a href="#cb51-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-224"><a href="#cb51-224" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-225"><a href="#cb51-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-228"><a href="#cb51-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-229"><a href="#cb51-229" aria-hidden="true" tabindex="-1"></a>password <span class="op">=</span> [<span class="va">None</span>] <span class="op">*</span> <span class="dv">8</span></span>
<span id="cb51-230"><a href="#cb51-230" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-231"><a href="#cb51-231" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">any</span>([x <span class="kw">is</span> <span class="va">None</span> <span class="cf">for</span> x <span class="kw">in</span> password]):</span>
<span id="cb51-232"><a href="#cb51-232" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> hashlib.md5((prefix <span class="op">+</span> <span class="bu">str</span>(i)).encode(encoding<span class="op">=</span><span class="st">"UTF-8"</span>)).hexdigest()</span>
<span id="cb51-233"><a href="#cb51-233" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> s[:<span class="dv">5</span>] <span class="op">==</span> <span class="st">"0"</span> <span class="op">*</span> <span class="dv">5</span> <span class="kw">and</span> s[<span class="dv">5</span>] <span class="kw">in</span> <span class="st">"01234567"</span> <span class="kw">and</span> password[<span class="bu">int</span>(s[<span class="dv">5</span>])] <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb51-234"><a href="#cb51-234" aria-hidden="true" tabindex="-1"></a>        password[<span class="bu">int</span>(s[<span class="dv">5</span>])] <span class="op">=</span> s[<span class="dv">6</span>]</span>
<span id="cb51-235"><a href="#cb51-235" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-236"><a href="#cb51-236" aria-hidden="true" tabindex="-1"></a><span class="co">""</span>.join(password)</span>
<span id="cb51-237"><a href="#cb51-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-238"><a href="#cb51-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-239"><a href="#cb51-239" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 6: Signals and Noise](https://adventofcode.com/2016/day/6)</span></span>
<span id="cb51-240"><a href="#cb51-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-241"><a href="#cb51-241" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-242"><a href="#cb51-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-245"><a href="#cb51-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-246"><a href="#cb51-246" aria-hidden="true" tabindex="-1"></a>messages <span class="op">=</span> load(<span class="dv">6</span>)</span>
<span id="cb51-247"><a href="#cb51-247" aria-hidden="true" tabindex="-1"></a><span class="co">""</span>.join(pd.DataFrame([<span class="bu">list</span>(x) <span class="cf">for</span> x <span class="kw">in</span> messages]).mode().values[<span class="dv">0</span>])</span>
<span id="cb51-248"><a href="#cb51-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-249"><a href="#cb51-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-250"><a href="#cb51-250" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-251"><a href="#cb51-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-254"><a href="#cb51-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-255"><a href="#cb51-255" aria-hidden="true" tabindex="-1"></a>foo <span class="op">=</span> np.array([<span class="bu">list</span>(x) <span class="cf">for</span> x <span class="kw">in</span> messages])</span>
<span id="cb51-256"><a href="#cb51-256" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="st">""</span></span>
<span id="cb51-257"><a href="#cb51-257" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(foo.shape[<span class="dv">1</span>]):</span>
<span id="cb51-258"><a href="#cb51-258" aria-hidden="true" tabindex="-1"></a>    letters, counts <span class="op">=</span> np.unique(foo[:, i], return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-259"><a href="#cb51-259" aria-hidden="true" tabindex="-1"></a>    s <span class="op">+=</span> letters[counts.argmin()]</span>
<span id="cb51-260"><a href="#cb51-260" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb51-261"><a href="#cb51-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-262"><a href="#cb51-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-263"><a href="#cb51-263" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 7: Internet Protocol Version 7](https://adventofcode.com/2016/day/7)</span></span>
<span id="cb51-264"><a href="#cb51-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-265"><a href="#cb51-265" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-266"><a href="#cb51-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-269"><a href="#cb51-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-270"><a href="#cb51-270" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">7</span>)</span>
<span id="cb51-271"><a href="#cb51-271" aria-hidden="true" tabindex="-1"></a>abba <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r"(.)(?!\1)(.)\2\1"</span>)</span>
<span id="cb51-272"><a href="#cb51-272" aria-hidden="true" tabindex="-1"></a>bracketed_abba <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r"\[[^]]*(.)(?!\1)(.)\2\1.*?\]"</span>)</span>
<span id="cb51-273"><a href="#cb51-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-274"><a href="#cb51-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-275"><a href="#cb51-275" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> supports_tls(haystack):</span>
<span id="cb51-276"><a href="#cb51-276" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">bool</span>(re.search(abba, haystack)) <span class="kw">and</span> <span class="kw">not</span> <span class="bu">bool</span>(</span>
<span id="cb51-277"><a href="#cb51-277" aria-hidden="true" tabindex="-1"></a>        re.search(bracketed_abba, haystack)</span>
<span id="cb51-278"><a href="#cb51-278" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb51-279"><a href="#cb51-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-280"><a href="#cb51-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-281"><a href="#cb51-281" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(supports_tls(line) <span class="cf">for</span> line <span class="kw">in</span> data)</span>
<span id="cb51-282"><a href="#cb51-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-283"><a href="#cb51-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-284"><a href="#cb51-284" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-285"><a href="#cb51-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-286"><a href="#cb51-286" aria-hidden="true" tabindex="-1"></a>Part two is more regex wrangling, except the patterns can overlap now. We could spend time figuring out exactly how to account for that, or we can import the third party regex module which does it for us automagically.</span>
<span id="cb51-287"><a href="#cb51-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-290"><a href="#cb51-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-291"><a href="#cb51-291" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> regex</span>
<span id="cb51-292"><a href="#cb51-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-293"><a href="#cb51-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-294"><a href="#cb51-294" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> supports_ssl(haystack):</span>
<span id="cb51-295"><a href="#cb51-295" aria-hidden="true" tabindex="-1"></a>    aba <span class="op">=</span> regex.<span class="bu">compile</span>(<span class="vs">r"(.)(?!\1)(.)\1"</span>)</span>
<span id="cb51-296"><a href="#cb51-296" aria-hidden="true" tabindex="-1"></a>    bracket_split <span class="op">=</span> [x.split(<span class="st">"["</span>) <span class="cf">for</span> x <span class="kw">in</span> haystack.split(<span class="st">"]"</span>)]</span>
<span id="cb51-297"><a href="#cb51-297" aria-hidden="true" tabindex="-1"></a>    outside, inside <span class="op">=</span> itertools.zip_longest(<span class="op">*</span>bracket_split, fillvalue<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb51-298"><a href="#cb51-298" aria-hidden="true" tabindex="-1"></a>    abas <span class="op">=</span> [</span>
<span id="cb51-299"><a href="#cb51-299" aria-hidden="true" tabindex="-1"></a>        match</span>
<span id="cb51-300"><a href="#cb51-300" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> fragment <span class="kw">in</span> outside</span>
<span id="cb51-301"><a href="#cb51-301" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> match <span class="kw">in</span> regex.findall(aba, fragment, overlapped<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-302"><a href="#cb51-302" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb51-303"><a href="#cb51-303" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> abas:</span>
<span id="cb51-304"><a href="#cb51-304" aria-hidden="true" tabindex="-1"></a>        bab <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>b<span class="sc">}{</span>a<span class="sc">}{</span>b<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb51-305"><a href="#cb51-305" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">any</span>(bab <span class="kw">in</span> fragment <span class="cf">for</span> fragment <span class="kw">in</span> inside):</span>
<span id="cb51-306"><a href="#cb51-306" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb51-307"><a href="#cb51-307" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb51-308"><a href="#cb51-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-309"><a href="#cb51-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-310"><a href="#cb51-310" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(supports_ssl(line) <span class="cf">for</span> line <span class="kw">in</span> data)</span>
<span id="cb51-311"><a href="#cb51-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-312"><a href="#cb51-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-313"><a href="#cb51-313" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 8: Two-Factor Authentication](https://adventofcode.com/2016/day/8)</span></span>
<span id="cb51-314"><a href="#cb51-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-315"><a href="#cb51-315" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-316"><a href="#cb51-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-319"><a href="#cb51-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-320"><a href="#cb51-320" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.zeros((<span class="dv">6</span>, <span class="dv">50</span>), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb51-321"><a href="#cb51-321" aria-hidden="true" tabindex="-1"></a>lines <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">8</span>)]</span>
<span id="cb51-322"><a href="#cb51-322" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> instructions <span class="kw">in</span> lines:</span>
<span id="cb51-323"><a href="#cb51-323" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> instructions[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"rect"</span>:</span>
<span id="cb51-324"><a href="#cb51-324" aria-hidden="true" tabindex="-1"></a>        row, col <span class="op">=</span> [<span class="bu">int</span>(a) <span class="cf">for</span> a <span class="kw">in</span> instructions[<span class="dv">1</span>].split(<span class="st">"x"</span>)]</span>
<span id="cb51-325"><a href="#cb51-325" aria-hidden="true" tabindex="-1"></a>        array[:col, :row] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-326"><a href="#cb51-326" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb51-327"><a href="#cb51-327" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> <span class="bu">int</span>(instructions[<span class="dv">2</span>].split(<span class="st">"="</span>)[<span class="dv">1</span>])</span>
<span id="cb51-328"><a href="#cb51-328" aria-hidden="true" tabindex="-1"></a>    amount <span class="op">=</span> <span class="bu">int</span>(instructions[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb51-329"><a href="#cb51-329" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> instructions[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"column"</span>:</span>
<span id="cb51-330"><a href="#cb51-330" aria-hidden="true" tabindex="-1"></a>        array <span class="op">=</span> array.T</span>
<span id="cb51-331"><a href="#cb51-331" aria-hidden="true" tabindex="-1"></a>    array[row] <span class="op">=</span> np.roll(array[row], amount)</span>
<span id="cb51-332"><a href="#cb51-332" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> instructions[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"column"</span>:</span>
<span id="cb51-333"><a href="#cb51-333" aria-hidden="true" tabindex="-1"></a>        array <span class="op">=</span> array.T</span>
<span id="cb51-334"><a href="#cb51-334" aria-hidden="true" tabindex="-1"></a>array.<span class="bu">sum</span>()</span>
<span id="cb51-335"><a href="#cb51-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-336"><a href="#cb51-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-337"><a href="#cb51-337" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-338"><a href="#cb51-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-341"><a href="#cb51-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-342"><a href="#cb51-342" aria-hidden="true" tabindex="-1"></a>[[<span class="st">""</span>.join(<span class="st">"█"</span> <span class="cf">if</span> char <span class="cf">else</span> <span class="st">" "</span> <span class="cf">for</span> char <span class="kw">in</span> line)] <span class="cf">for</span> line <span class="kw">in</span> array]</span>
<span id="cb51-343"><a href="#cb51-343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-344"><a href="#cb51-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-345"><a href="#cb51-345" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 9: Explosives in Cyberspace](https://adventofcode.com/2016/day/9)</span></span>
<span id="cb51-346"><a href="#cb51-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-347"><a href="#cb51-347" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-348"><a href="#cb51-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-351"><a href="#cb51-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-352"><a href="#cb51-352" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">9</span>)[<span class="dv">0</span>]</span>
<span id="cb51-353"><a href="#cb51-353" aria-hidden="true" tabindex="-1"></a>part1 <span class="op">=</span> data</span>
<span id="cb51-354"><a href="#cb51-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-355"><a href="#cb51-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-356"><a href="#cb51-356" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count(s, part2<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb51-357"><a href="#cb51-357" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-358"><a href="#cb51-358" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> s:</span>
<span id="cb51-359"><a href="#cb51-359" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> s[<span class="dv">0</span>] <span class="op">!=</span> <span class="st">"("</span>:</span>
<span id="cb51-360"><a href="#cb51-360" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-361"><a href="#cb51-361" aria-hidden="true" tabindex="-1"></a>            s <span class="op">=</span> s[<span class="dv">1</span>:]</span>
<span id="cb51-362"><a href="#cb51-362" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb51-363"><a href="#cb51-363" aria-hidden="true" tabindex="-1"></a>        end <span class="op">=</span> s.index(<span class="st">")"</span>)</span>
<span id="cb51-364"><a href="#cb51-364" aria-hidden="true" tabindex="-1"></a>        chars, repeat <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, s[<span class="dv">1</span>:end].split(<span class="st">"x"</span>))</span>
<span id="cb51-365"><a href="#cb51-365" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s[end <span class="op">+</span> <span class="dv">1</span> :]</span>
<span id="cb51-366"><a href="#cb51-366" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> part2:</span>
<span id="cb51-367"><a href="#cb51-367" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> repeat <span class="op">*</span> count(s[:chars], <span class="va">True</span>)</span>
<span id="cb51-368"><a href="#cb51-368" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb51-369"><a href="#cb51-369" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> repeat <span class="op">*</span> chars</span>
<span id="cb51-370"><a href="#cb51-370" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s[chars:]</span>
<span id="cb51-371"><a href="#cb51-371" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total</span>
<span id="cb51-372"><a href="#cb51-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-373"><a href="#cb51-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-374"><a href="#cb51-374" aria-hidden="true" tabindex="-1"></a>count(data)</span>
<span id="cb51-375"><a href="#cb51-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-376"><a href="#cb51-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-377"><a href="#cb51-377" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-378"><a href="#cb51-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-381"><a href="#cb51-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-382"><a href="#cb51-382" aria-hidden="true" tabindex="-1"></a>count(data, part2<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-383"><a href="#cb51-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-384"><a href="#cb51-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-385"><a href="#cb51-385" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 10: Balance Bots](https://adventofcode.com/2016/day/10)</span></span>
<span id="cb51-386"><a href="#cb51-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-387"><a href="#cb51-387" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-388"><a href="#cb51-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-391"><a href="#cb51-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-392"><a href="#cb51-392" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">10</span>)</span>
<span id="cb51-393"><a href="#cb51-393" aria-hidden="true" tabindex="-1"></a>wiring <span class="op">=</span> {}</span>
<span id="cb51-394"><a href="#cb51-394" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb51-395"><a href="#cb51-395" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> data:</span>
<span id="cb51-396"><a href="#cb51-396" aria-hidden="true" tabindex="-1"></a>    command <span class="op">=</span> re.findall(<span class="st">"(bot|value|output) (\d+)"</span>, line)</span>
<span id="cb51-397"><a href="#cb51-397" aria-hidden="true" tabindex="-1"></a>    numbers <span class="op">=</span> [<span class="bu">int</span>(x[<span class="dv">1</span>]) <span class="cf">for</span> x <span class="kw">in</span> command]</span>
<span id="cb51-398"><a href="#cb51-398" aria-hidden="true" tabindex="-1"></a>    names <span class="op">=</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> command]</span>
<span id="cb51-399"><a href="#cb51-399" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(command) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb51-400"><a href="#cb51-400" aria-hidden="true" tabindex="-1"></a>        state[numbers[<span class="dv">1</span>]].append(numbers[<span class="dv">0</span>])</span>
<span id="cb51-401"><a href="#cb51-401" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb51-402"><a href="#cb51-402" aria-hidden="true" tabindex="-1"></a>        wiring[numbers[<span class="dv">0</span>]] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">zip</span>(names[<span class="dv">1</span>:], numbers[<span class="dv">1</span>:])]</span>
<span id="cb51-403"><a href="#cb51-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-404"><a href="#cb51-404" aria-hidden="true" tabindex="-1"></a>queue <span class="op">=</span> deque([x <span class="cf">for</span> x <span class="kw">in</span> start <span class="cf">if</span> <span class="bu">len</span>(state[x]) <span class="op">==</span> <span class="dv">2</span>])</span>
<span id="cb51-405"><a href="#cb51-405" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> <span class="dv">21</span></span>
<span id="cb51-406"><a href="#cb51-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-407"><a href="#cb51-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-408"><a href="#cb51-408" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> step():</span>
<span id="cb51-409"><a href="#cb51-409" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> queue.popleft()</span>
<span id="cb51-410"><a href="#cb51-410" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> <span class="bu">sorted</span>(state[current])</span>
<span id="cb51-411"><a href="#cb51-411" aria-hidden="true" tabindex="-1"></a>    state[current] <span class="op">=</span> []</span>
<span id="cb51-412"><a href="#cb51-412" aria-hidden="true" tabindex="-1"></a>    left, right <span class="op">=</span> wiring[current]</span>
<span id="cb51-413"><a href="#cb51-413" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, (name, value) <span class="kw">in</span> <span class="bu">enumerate</span>(wiring[current]):</span>
<span id="cb51-414"><a href="#cb51-414" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> name <span class="op">==</span> <span class="st">"bot"</span>:</span>
<span id="cb51-415"><a href="#cb51-415" aria-hidden="true" tabindex="-1"></a>            state[value].append(values[idx])</span>
<span id="cb51-416"><a href="#cb51-416" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(state[value]) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb51-417"><a href="#cb51-417" aria-hidden="true" tabindex="-1"></a>                queue.append(value)</span>
<span id="cb51-418"><a href="#cb51-418" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb51-419"><a href="#cb51-419" aria-hidden="true" tabindex="-1"></a>            output[value] <span class="op">=</span> values[idx]</span>
<span id="cb51-420"><a href="#cb51-420" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current, values</span>
<span id="cb51-421"><a href="#cb51-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-422"><a href="#cb51-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-423"><a href="#cb51-423" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb51-424"><a href="#cb51-424" aria-hidden="true" tabindex="-1"></a>    current, values <span class="op">=</span> step()</span>
<span id="cb51-425"><a href="#cb51-425" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> values <span class="op">==</span> [<span class="dv">17</span>, <span class="dv">61</span>]:</span>
<span id="cb51-426"><a href="#cb51-426" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb51-427"><a href="#cb51-427" aria-hidden="true" tabindex="-1"></a>current</span>
<span id="cb51-428"><a href="#cb51-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-429"><a href="#cb51-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-430"><a href="#cb51-430" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-431"><a href="#cb51-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-432"><a href="#cb51-432" aria-hidden="true" tabindex="-1"></a>With Part 1 out of the way, part 2 is just</span>
<span id="cb51-433"><a href="#cb51-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-436"><a href="#cb51-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-437"><a href="#cb51-437" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> queue:</span>
<span id="cb51-438"><a href="#cb51-438" aria-hidden="true" tabindex="-1"></a>    step()</span>
<span id="cb51-439"><a href="#cb51-439" aria-hidden="true" tabindex="-1"></a>np.product(output[:<span class="dv">3</span>])</span>
<span id="cb51-440"><a href="#cb51-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-441"><a href="#cb51-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-442"><a href="#cb51-442" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 11: Radioisotope Thermoelectric Generators](https://adventofcode.com/2016/day/11)</span></span>
<span id="cb51-443"><a href="#cb51-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-444"><a href="#cb51-444" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-445"><a href="#cb51-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-446"><a href="#cb51-446" aria-hidden="true" tabindex="-1"></a>This one looks difficult, but I don't think it is too tricky. Given that we are in floor $n$, the valid next positions are us at floor $n+1$ or $n - 1$, with up to two items moved; with the items moved being subject to the puzzle constraints.</span>
<span id="cb51-447"><a href="#cb51-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-448"><a href="#cb51-448" aria-hidden="true" tabindex="-1"></a>So I think the way to go is A<span class="sc">\*</span>.</span>
<span id="cb51-449"><a href="#cb51-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-452"><a href="#cb51-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-453"><a href="#cb51-453" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> more_itertools <span class="im">import</span> grouper</span>
<span id="cb51-454"><a href="#cb51-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-455"><a href="#cb51-455" aria-hidden="true" tabindex="-1"></a>n_floors <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb51-456"><a href="#cb51-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-457"><a href="#cb51-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-458"><a href="#cb51-458" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> distance_estimate(state, end):</span>
<span id="cb51-459"><a href="#cb51-459" aria-hidden="true" tabindex="-1"></a>    items <span class="op">=</span> state[<span class="dv">1</span>]</span>
<span id="cb51-460"><a href="#cb51-460" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>((val <span class="op">/</span> <span class="dv">2</span>) <span class="op">*</span> (n_floors <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>) <span class="cf">for</span> i, val <span class="kw">in</span> <span class="bu">enumerate</span>(items))</span>
<span id="cb51-461"><a href="#cb51-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-462"><a href="#cb51-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-463"><a href="#cb51-463" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid(items):</span>
<span id="cb51-464"><a href="#cb51-464" aria-hidden="true" tabindex="-1"></a>    generators, chips <span class="op">=</span> state[::<span class="dv">2</span>], state[<span class="dv">1</span>::<span class="dv">2</span>]</span>
<span id="cb51-465"><a href="#cb51-465" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(</span>
<span id="cb51-466"><a href="#cb51-466" aria-hidden="true" tabindex="-1"></a>        (chip <span class="op">==</span> generator) <span class="kw">or</span> (chip <span class="kw">not</span> <span class="kw">in</span> generators)</span>
<span id="cb51-467"><a href="#cb51-467" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> chip, generator <span class="kw">in</span> <span class="bu">zip</span>(chips, generators)</span>
<span id="cb51-468"><a href="#cb51-468" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb51-469"><a href="#cb51-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-470"><a href="#cb51-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-471"><a href="#cb51-471" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize(items):</span>
<span id="cb51-472"><a href="#cb51-472" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(x <span class="cf">for</span> pair <span class="kw">in</span> <span class="bu">sorted</span>(<span class="bu">list</span>(grouper(items, <span class="dv">2</span>))) <span class="cf">for</span> x <span class="kw">in</span> pair)</span>
<span id="cb51-473"><a href="#cb51-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-474"><a href="#cb51-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-475"><a href="#cb51-475" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> constrained_neighbors(state):</span>
<span id="cb51-476"><a href="#cb51-476" aria-hidden="true" tabindex="-1"></a>    floor, items <span class="op">=</span> state</span>
<span id="cb51-477"><a href="#cb51-477" aria-hidden="true" tabindex="-1"></a>    active_indices <span class="op">=</span> [index <span class="cf">for</span> index, val <span class="kw">in</span> <span class="bu">enumerate</span>(items) <span class="cf">if</span> val <span class="op">==</span> floor]</span>
<span id="cb51-478"><a href="#cb51-478" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb51-479"><a href="#cb51-479" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> new_floor <span class="kw">in</span> [floor <span class="op">+</span> <span class="dv">1</span>, floor <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb51-480"><a href="#cb51-480" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> (<span class="dv">0</span> <span class="op">&lt;=</span> new_floor <span class="op">&lt;</span> n_floors):</span>
<span id="cb51-481"><a href="#cb51-481" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb51-482"><a href="#cb51-482" aria-hidden="true" tabindex="-1"></a>        moves <span class="op">=</span> [[x] <span class="cf">for</span> x <span class="kw">in</span> active_indices]</span>
<span id="cb51-483"><a href="#cb51-483" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> new_floor <span class="op">==</span> floor <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb51-484"><a href="#cb51-484" aria-hidden="true" tabindex="-1"></a>            moves <span class="op">=</span> itertools.chain(moves, itertools.combinations(active_indices, <span class="dv">2</span>))</span>
<span id="cb51-485"><a href="#cb51-485" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> move <span class="kw">in</span> moves:</span>
<span id="cb51-486"><a href="#cb51-486" aria-hidden="true" tabindex="-1"></a>            new_items <span class="op">=</span> <span class="bu">list</span>(items)</span>
<span id="cb51-487"><a href="#cb51-487" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> index <span class="kw">in</span> move:</span>
<span id="cb51-488"><a href="#cb51-488" aria-hidden="true" tabindex="-1"></a>                new_items[index] <span class="op">=</span> new_floor</span>
<span id="cb51-489"><a href="#cb51-489" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> is_valid(new_items):</span>
<span id="cb51-490"><a href="#cb51-490" aria-hidden="true" tabindex="-1"></a>                neighbors.add((new_floor, normalize(new_items)))</span>
<span id="cb51-491"><a href="#cb51-491" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbors</span>
<span id="cb51-492"><a href="#cb51-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-493"><a href="#cb51-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-494"><a href="#cb51-494" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="dv">0</span>, (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb51-495"><a href="#cb51-495" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="dv">3</span>, (<span class="dv">3</span>,) <span class="op">*</span> <span class="bu">len</span>(state[<span class="dv">1</span>])</span>
<span id="cb51-496"><a href="#cb51-496" aria-hidden="true" tabindex="-1"></a>utils.astar(state, target, constrained_neighbors, distance_estimate)</span>
<span id="cb51-497"><a href="#cb51-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-498"><a href="#cb51-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-499"><a href="#cb51-499" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-500"><a href="#cb51-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-501"><a href="#cb51-501" aria-hidden="true" tabindex="-1"></a>Extending this to part 2 without changing anything is possible, but the whole thing takes about a minute and a half to run. When I have time, I'll come back and look at it again.</span>
<span id="cb51-502"><a href="#cb51-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-503"><a href="#cb51-503" aria-hidden="true" tabindex="-1"></a>Reducing the search space by only letting the elevator move down with one item at a time reduced the runtime to about half. I'm not 100% convinced the restriction is always valid, but it did work in this case.</span>
<span id="cb51-504"><a href="#cb51-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-507"><a href="#cb51-507" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-508"><a href="#cb51-508" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="dv">0</span>, (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb51-509"><a href="#cb51-509" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="dv">3</span>, (<span class="dv">3</span>,) <span class="op">*</span> <span class="bu">len</span>(state[<span class="dv">1</span>])</span>
<span id="cb51-510"><a href="#cb51-510" aria-hidden="true" tabindex="-1"></a>utils.astar(state, target, constrained_neighbors, distance_estimate)</span>
<span id="cb51-511"><a href="#cb51-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-512"><a href="#cb51-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-513"><a href="#cb51-513" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 12: Leonardo's Monorail](https://adventofcode.com/2016/day/12)</span></span>
<span id="cb51-514"><a href="#cb51-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-515"><a href="#cb51-515" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-516"><a href="#cb51-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-517"><a href="#cb51-517" aria-hidden="true" tabindex="-1"></a>This is a fairly straightforward implementation of the problem description, with no particular cleverness going on. We have two types of instructions - ones that take two operands, and ones that take only one, and we can treat those together.</span>
<span id="cb51-518"><a href="#cb51-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-521"><a href="#cb51-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-522"><a href="#cb51-522" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run(program, registers<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb51-523"><a href="#cb51-523" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> registers <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb51-524"><a href="#cb51-524" aria-hidden="true" tabindex="-1"></a>        registers <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb51-525"><a href="#cb51-525" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-526"><a href="#cb51-526" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(program):</span>
<span id="cb51-527"><a href="#cb51-527" aria-hidden="true" tabindex="-1"></a>        instruction <span class="op">=</span> program[ip]</span>
<span id="cb51-528"><a href="#cb51-528" aria-hidden="true" tabindex="-1"></a>        operator, operands <span class="op">=</span> instruction[<span class="dv">0</span>], instruction[<span class="dv">1</span>:]</span>
<span id="cb51-529"><a href="#cb51-529" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> operator <span class="kw">in</span> [<span class="st">"cpy"</span>, <span class="st">"jnz"</span>]:</span>
<span id="cb51-530"><a href="#cb51-530" aria-hidden="true" tabindex="-1"></a>            source, destination <span class="op">=</span> operands</span>
<span id="cb51-531"><a href="#cb51-531" aria-hidden="true" tabindex="-1"></a>            value <span class="op">=</span> <span class="bu">int</span>(source) <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> <span class="st">"abcd"</span> <span class="cf">else</span> registers[source]</span>
<span id="cb51-532"><a href="#cb51-532" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> operator <span class="op">==</span> <span class="st">"cpy"</span>:</span>
<span id="cb51-533"><a href="#cb51-533" aria-hidden="true" tabindex="-1"></a>                registers[destination] <span class="op">=</span> value</span>
<span id="cb51-534"><a href="#cb51-534" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> operator <span class="op">==</span> <span class="st">"jnz"</span> <span class="kw">and</span> value <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb51-535"><a href="#cb51-535" aria-hidden="true" tabindex="-1"></a>                ip <span class="op">+=</span> <span class="bu">int</span>(destination) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb51-536"><a href="#cb51-536" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> operator <span class="kw">in</span> [<span class="st">"inc"</span>, <span class="st">"dec"</span>]:</span>
<span id="cb51-537"><a href="#cb51-537" aria-hidden="true" tabindex="-1"></a>            registers[operands[<span class="dv">0</span>]] <span class="op">+=</span> <span class="dv">2</span> <span class="op">*</span> (operator <span class="op">==</span> <span class="st">"inc"</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb51-538"><a href="#cb51-538" aria-hidden="true" tabindex="-1"></a>        ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-539"><a href="#cb51-539" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> registers[<span class="st">"a"</span>]</span>
<span id="cb51-540"><a href="#cb51-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-541"><a href="#cb51-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-542"><a href="#cb51-542" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [line.split(<span class="st">" "</span>) <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">12</span>)]</span>
<span id="cb51-543"><a href="#cb51-543" aria-hidden="true" tabindex="-1"></a>run(data)</span>
<span id="cb51-544"><a href="#cb51-544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-545"><a href="#cb51-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-546"><a href="#cb51-546" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-547"><a href="#cb51-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-550"><a href="#cb51-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-551"><a href="#cb51-551" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb51-552"><a href="#cb51-552" aria-hidden="true" tabindex="-1"></a>registers[<span class="st">"c"</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-553"><a href="#cb51-553" aria-hidden="true" tabindex="-1"></a>run(data, registers)</span>
<span id="cb51-554"><a href="#cb51-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-555"><a href="#cb51-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-556"><a href="#cb51-556" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 13: A Maze of Twisty Little Cubicles](https://adventofcode.com/2016/day/13)</span></span>
<span id="cb51-557"><a href="#cb51-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-558"><a href="#cb51-558" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-559"><a href="#cb51-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-562"><a href="#cb51-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-563"><a href="#cb51-563" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> astar</span>
<span id="cb51-564"><a href="#cb51-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-565"><a href="#cb51-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-566"><a href="#cb51-566" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid(x, y, secret<span class="op">=</span><span class="dv">1362</span>):</span>
<span id="cb51-567"><a href="#cb51-567" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> y <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb51-568"><a href="#cb51-568" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb51-569"><a href="#cb51-569" aria-hidden="true" tabindex="-1"></a>    val <span class="op">=</span> x <span class="op">*</span> x <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> x <span class="op">*</span> y <span class="op">+</span> y <span class="op">+</span> y <span class="op">*</span> y <span class="op">+</span> secret</span>
<span id="cb51-570"><a href="#cb51-570" aria-hidden="true" tabindex="-1"></a>    ones <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>val<span class="sc">:b}</span><span class="ss">"</span>.count(<span class="st">"1"</span>)</span>
<span id="cb51-571"><a href="#cb51-571" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (ones <span class="op">%</span> <span class="dv">2</span>) <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb51-572"><a href="#cb51-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-573"><a href="#cb51-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-574"><a href="#cb51-574" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> neighbors(state):</span>
<span id="cb51-575"><a href="#cb51-575" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> state</span>
<span id="cb51-576"><a href="#cb51-576" aria-hidden="true" tabindex="-1"></a>    candidates <span class="op">=</span> [(x <span class="op">-</span> <span class="dv">1</span>, y), (x <span class="op">+</span> <span class="dv">1</span>, y), (x, y <span class="op">-</span> <span class="dv">1</span>), (x, y <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb51-577"><a href="#cb51-577" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [candidate <span class="cf">for</span> candidate <span class="kw">in</span> candidates <span class="cf">if</span> is_valid(<span class="op">*</span>candidate)]</span>
<span id="cb51-578"><a href="#cb51-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-579"><a href="#cb51-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-580"><a href="#cb51-580" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> distance_function(point, target):</span>
<span id="cb51-581"><a href="#cb51-581" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">abs</span>(point[<span class="dv">0</span>] <span class="op">-</span> target[<span class="dv">0</span>]) <span class="op">+</span> <span class="bu">abs</span>(point[<span class="dv">1</span>] <span class="op">-</span> target[<span class="dv">1</span>])</span>
<span id="cb51-582"><a href="#cb51-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-583"><a href="#cb51-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-584"><a href="#cb51-584" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb51-585"><a href="#cb51-585" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="dv">31</span>, <span class="dv">39</span></span>
<span id="cb51-586"><a href="#cb51-586" aria-hidden="true" tabindex="-1"></a>utils.astar(start, target, neighbors, distance_function)</span>
<span id="cb51-587"><a href="#cb51-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-588"><a href="#cb51-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-589"><a href="#cb51-589" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-590"><a href="#cb51-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-593"><a href="#cb51-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-594"><a href="#cb51-594" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(utils.bfs((<span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">lambda</span> cost, state: cost <span class="op">&gt;</span> <span class="dv">50</span>, neighbors, return_visited<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb51-595"><a href="#cb51-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-596"><a href="#cb51-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-597"><a href="#cb51-597" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 14: One-Time Pad](https://adventofcode.com/2016/day/14)</span></span>
<span id="cb51-598"><a href="#cb51-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-599"><a href="#cb51-599" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-600"><a href="#cb51-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-603"><a href="#cb51-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-604"><a href="#cb51-604" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb51-605"><a href="#cb51-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-606"><a href="#cb51-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-607"><a href="#cb51-607" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> infinite_triples(prefix, part<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb51-608"><a href="#cb51-608" aria-hidden="true" tabindex="-1"></a>    r1 <span class="op">=</span> <span class="vs">r"(.)\1\1"</span></span>
<span id="cb51-609"><a href="#cb51-609" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> <span class="vs">r"(.)\1\1\1\1"</span></span>
<span id="cb51-610"><a href="#cb51-610" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-611"><a href="#cb51-611" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb51-612"><a href="#cb51-612" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> hashlib.md5((prefix <span class="op">+</span> <span class="bu">str</span>(n)).encode()).hexdigest()</span>
<span id="cb51-613"><a href="#cb51-613" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> part <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb51-614"><a href="#cb51-614" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2016</span>):</span>
<span id="cb51-615"><a href="#cb51-615" aria-hidden="true" tabindex="-1"></a>                s <span class="op">=</span> hashlib.md5(s.encode()).hexdigest()</span>
<span id="cb51-616"><a href="#cb51-616" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> r <span class="op">:=</span> re.search(r1, s):</span>
<span id="cb51-617"><a href="#cb51-617" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (r.groups(<span class="dv">1</span>)[<span class="dv">0</span>], re.findall(r2, s))</span>
<span id="cb51-618"><a href="#cb51-618" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb51-619"><a href="#cb51-619" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> <span class="va">False</span></span>
<span id="cb51-620"><a href="#cb51-620" aria-hidden="true" tabindex="-1"></a>        n <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-621"><a href="#cb51-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-622"><a href="#cb51-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-623"><a href="#cb51-623" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nth_key_index(prefix, n<span class="op">=</span><span class="dv">64</span>, part<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb51-624"><a href="#cb51-624" aria-hidden="true" tabindex="-1"></a>    triples <span class="op">=</span> <span class="bu">filter</span>(<span class="kw">lambda</span> x: x[<span class="dv">1</span>], <span class="bu">enumerate</span>(infinite_triples(prefix, part)))</span>
<span id="cb51-625"><a href="#cb51-625" aria-hidden="true" tabindex="-1"></a>    window <span class="op">=</span> [<span class="bu">next</span>(triples)]</span>
<span id="cb51-626"><a href="#cb51-626" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-627"><a href="#cb51-627" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current <span class="op">&lt;</span> n:</span>
<span id="cb51-628"><a href="#cb51-628" aria-hidden="true" tabindex="-1"></a>        idx, (triple, _) <span class="op">=</span> window.pop(<span class="dv">0</span>)</span>
<span id="cb51-629"><a href="#cb51-629" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="kw">not</span> window <span class="kw">or</span> window[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="op">&lt;</span> idx <span class="op">+</span> <span class="dv">1000</span>:</span>
<span id="cb51-630"><a href="#cb51-630" aria-hidden="true" tabindex="-1"></a>            window.append(<span class="bu">next</span>(triples))</span>
<span id="cb51-631"><a href="#cb51-631" aria-hidden="true" tabindex="-1"></a>        active_quints <span class="op">=</span> [char <span class="cf">for</span> triple <span class="kw">in</span> window[:<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> char <span class="kw">in</span> triple[<span class="dv">1</span>][<span class="dv">1</span>]]</span>
<span id="cb51-632"><a href="#cb51-632" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> triple <span class="kw">in</span> active_quints:</span>
<span id="cb51-633"><a href="#cb51-633" aria-hidden="true" tabindex="-1"></a>            current <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-634"><a href="#cb51-634" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb51-635"><a href="#cb51-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-636"><a href="#cb51-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-637"><a href="#cb51-637" aria-hidden="true" tabindex="-1"></a>nth_key_index(<span class="st">"yjdafjpo"</span>)</span>
<span id="cb51-638"><a href="#cb51-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-639"><a href="#cb51-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-640"><a href="#cb51-640" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-641"><a href="#cb51-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-642"><a href="#cb51-642" aria-hidden="true" tabindex="-1"></a>I was a little uncertain about how to write this cleanly – all of the logic from part one is the same, the only difference is how the hash is generated. In the end, I made a toggle in the <span class="in">`infinite_triples`</span> function, which is why part 2 can be solved by writing just:</span>
<span id="cb51-643"><a href="#cb51-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-646"><a href="#cb51-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-647"><a href="#cb51-647" aria-hidden="true" tabindex="-1"></a>nth_key_index(<span class="st">"yjdafjpo"</span>, part<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb51-648"><a href="#cb51-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-649"><a href="#cb51-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-650"><a href="#cb51-650" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 15: Timing is Everything](https://adventofcode.com/2016/day/15)</span></span>
<span id="cb51-651"><a href="#cb51-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-652"><a href="#cb51-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-653"><a href="#cb51-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-654"><a href="#cb51-654" aria-hidden="true" tabindex="-1"></a>Another round of the chinese remainder theorem.</span>
<span id="cb51-655"><a href="#cb51-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-658"><a href="#cb51-658" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-659"><a href="#cb51-659" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> crt</span>
<span id="cb51-660"><a href="#cb51-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-661"><a href="#cb51-661" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> re.findall(<span class="vs">r"\d+"</span>, line)] <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">15</span>)]</span>
<span id="cb51-662"><a href="#cb51-662" aria-hidden="true" tabindex="-1"></a>remainders <span class="op">=</span> [(x[<span class="dv">1</span>], <span class="op">-</span>(x[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> x[<span class="dv">0</span>])) <span class="cf">for</span> x <span class="kw">in</span> data]</span>
<span id="cb51-663"><a href="#cb51-663" aria-hidden="true" tabindex="-1"></a>crt(remainders)</span>
<span id="cb51-664"><a href="#cb51-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-665"><a href="#cb51-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-666"><a href="#cb51-666" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-667"><a href="#cb51-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-670"><a href="#cb51-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-671"><a href="#cb51-671" aria-hidden="true" tabindex="-1"></a>remainders.append([<span class="dv">11</span>, <span class="op">-</span>(<span class="bu">len</span>(remainders) <span class="op">+</span> <span class="dv">1</span>)])</span>
<span id="cb51-672"><a href="#cb51-672" aria-hidden="true" tabindex="-1"></a>crt(remainders)</span>
<span id="cb51-673"><a href="#cb51-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-674"><a href="#cb51-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-675"><a href="#cb51-675" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 16: Dragon Checksum](https://adventofcode.com/2016/day/16)</span></span>
<span id="cb51-676"><a href="#cb51-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-677"><a href="#cb51-677" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-678"><a href="#cb51-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-681"><a href="#cb51-681" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-682"><a href="#cb51-682" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb51-683"><a href="#cb51-683" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="dv">272</span></span>
<span id="cb51-684"><a href="#cb51-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-685"><a href="#cb51-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-686"><a href="#cb51-686" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solve(prefix, length):</span>
<span id="cb51-687"><a href="#cb51-687" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(prefix) <span class="op">&lt;</span> length:</span>
<span id="cb51-688"><a href="#cb51-688" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> prefix <span class="op">+</span> [<span class="dv">0</span>] <span class="op">+</span> [<span class="dv">1</span> <span class="op">^</span> x <span class="cf">for</span> x <span class="kw">in</span> prefix[::<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb51-689"><a href="#cb51-689" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> prefix[:length]</span>
<span id="cb51-690"><a href="#cb51-690" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(s) <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb51-691"><a href="#cb51-691" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> <span class="bu">abs</span>(np.diff(s))[::<span class="dv">2</span>] <span class="op">^</span> <span class="dv">1</span></span>
<span id="cb51-692"><a href="#cb51-692" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span>
<span id="cb51-693"><a href="#cb51-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-694"><a href="#cb51-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-695"><a href="#cb51-695" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>solve(start, length), sep<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb51-696"><a href="#cb51-696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-697"><a href="#cb51-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-698"><a href="#cb51-698" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-699"><a href="#cb51-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-702"><a href="#cb51-702" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-703"><a href="#cb51-703" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>solve(start, <span class="dv">35651584</span>), sep<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb51-704"><a href="#cb51-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-705"><a href="#cb51-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-706"><a href="#cb51-706" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 17: Two Steps Forward](https://adventofcode.com/2016/day/17)</span></span>
<span id="cb51-707"><a href="#cb51-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-708"><a href="#cb51-708" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-709"><a href="#cb51-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-710"><a href="#cb51-710" aria-hidden="true" tabindex="-1"></a>BFS to the rescue. I wanted to do A<span class="sc">\*</span>, but the "distance from 3,3" heuristic didn't seem like it would give much. Then I dropped to Dijkstra, but realised that if all steps cost the same, that's just BFS.</span>
<span id="cb51-711"><a href="#cb51-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-714"><a href="#cb51-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-715"><a href="#cb51-715" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> (<span class="dv">0</span>, <span class="st">"bwnlcvfs"</span>)</span>
<span id="cb51-716"><a href="#cb51-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-717"><a href="#cb51-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-718"><a href="#cb51-718" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> neighbors(position, path):</span>
<span id="cb51-719"><a href="#cb51-719" aria-hidden="true" tabindex="-1"></a>    chars <span class="op">=</span> hashlib.md5(path.encode()).hexdigest()[:<span class="dv">4</span>]</span>
<span id="cb51-720"><a href="#cb51-720" aria-hidden="true" tabindex="-1"></a>    directions <span class="op">=</span> <span class="st">"UDLR"</span></span>
<span id="cb51-721"><a href="#cb51-721" aria-hidden="true" tabindex="-1"></a>    deltas <span class="op">=</span> <span class="op">-</span><span class="ot">1j</span>, <span class="ot">1j</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span></span>
<span id="cb51-722"><a href="#cb51-722" aria-hidden="true" tabindex="-1"></a>    candidates <span class="op">=</span> [</span>
<span id="cb51-723"><a href="#cb51-723" aria-hidden="true" tabindex="-1"></a>        (position <span class="op">+</span> delta, path <span class="op">+</span> direction)</span>
<span id="cb51-724"><a href="#cb51-724" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> delta, direction, char <span class="kw">in</span> <span class="bu">zip</span>(deltas, directions, chars)</span>
<span id="cb51-725"><a href="#cb51-725" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> char <span class="kw">in</span> <span class="st">"bcdef"</span></span>
<span id="cb51-726"><a href="#cb51-726" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb51-727"><a href="#cb51-727" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb51-728"><a href="#cb51-728" aria-hidden="true" tabindex="-1"></a>        candidate</span>
<span id="cb51-729"><a href="#cb51-729" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> candidate <span class="kw">in</span> candidates</span>
<span id="cb51-730"><a href="#cb51-730" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="dv">0</span> <span class="op">&lt;=</span> candidate[<span class="dv">0</span>].real <span class="op">&lt;</span> <span class="dv">4</span> <span class="kw">and</span> <span class="dv">0</span> <span class="op">&lt;=</span> candidate[<span class="dv">0</span>].imag <span class="op">&lt;</span> <span class="dv">4</span></span>
<span id="cb51-731"><a href="#cb51-731" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb51-732"><a href="#cb51-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-733"><a href="#cb51-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-734"><a href="#cb51-734" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> deque([start])</span>
<span id="cb51-735"><a href="#cb51-735" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> q:</span>
<span id="cb51-736"><a href="#cb51-736" aria-hidden="true" tabindex="-1"></a>    position, path <span class="op">=</span> q.popleft()</span>
<span id="cb51-737"><a href="#cb51-737" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> position <span class="op">==</span> <span class="dv">3</span> <span class="op">+</span> <span class="ot">3j</span>:</span>
<span id="cb51-738"><a href="#cb51-738" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> path[<span class="bu">len</span>(start[<span class="dv">1</span>]) :]</span>
<span id="cb51-739"><a href="#cb51-739" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb51-740"><a href="#cb51-740" aria-hidden="true" tabindex="-1"></a>    q <span class="op">+=</span> deque(neighbors(position, path))</span>
<span id="cb51-741"><a href="#cb51-741" aria-hidden="true" tabindex="-1"></a>result</span>
<span id="cb51-742"><a href="#cb51-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-743"><a href="#cb51-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-744"><a href="#cb51-744" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-745"><a href="#cb51-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-748"><a href="#cb51-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-749"><a href="#cb51-749" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> deque([start])</span>
<span id="cb51-750"><a href="#cb51-750" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-751"><a href="#cb51-751" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> q:</span>
<span id="cb51-752"><a href="#cb51-752" aria-hidden="true" tabindex="-1"></a>    position, path <span class="op">=</span> q.popleft()</span>
<span id="cb51-753"><a href="#cb51-753" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> position <span class="op">==</span> <span class="dv">3</span> <span class="op">+</span> <span class="ot">3j</span>:</span>
<span id="cb51-754"><a href="#cb51-754" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="bu">len</span>(path) <span class="op">-</span> <span class="bu">len</span>(start[<span class="dv">1</span>])</span>
<span id="cb51-755"><a href="#cb51-755" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb51-756"><a href="#cb51-756" aria-hidden="true" tabindex="-1"></a>    q <span class="op">+=</span> deque(neighbors(position, path))</span>
<span id="cb51-757"><a href="#cb51-757" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-758"><a href="#cb51-758" aria-hidden="true" tabindex="-1"></a>result</span>
<span id="cb51-759"><a href="#cb51-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-760"><a href="#cb51-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-761"><a href="#cb51-761" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 18: Like a Rogue](https://adventofcode.com/2016/day/18)</span></span>
<span id="cb51-762"><a href="#cb51-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-763"><a href="#cb51-763" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-764"><a href="#cb51-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-767"><a href="#cb51-767" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-768"><a href="#cb51-768" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([<span class="dv">1</span> <span class="cf">if</span> char <span class="op">==</span> <span class="st">"^"</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> char <span class="kw">in</span> load(<span class="dv">18</span>)[<span class="dv">0</span>]], dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb51-769"><a href="#cb51-769" aria-hidden="true" tabindex="-1"></a>left_right <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb51-770"><a href="#cb51-770" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> []</span>
<span id="cb51-771"><a href="#cb51-771" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">40</span>):</span>
<span id="cb51-772"><a href="#cb51-772" aria-hidden="true" tabindex="-1"></a>    rows.append(data)</span>
<span id="cb51-773"><a href="#cb51-773" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> (scipy.ndimage.convolve(data, left_right, mode<span class="op">=</span><span class="st">"constant"</span>) <span class="op">==</span> <span class="dv">1</span>).astype(<span class="bu">int</span>)</span>
<span id="cb51-774"><a href="#cb51-774" aria-hidden="true" tabindex="-1"></a>(np.array(rows) <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb51-775"><a href="#cb51-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-776"><a href="#cb51-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-777"><a href="#cb51-777" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-778"><a href="#cb51-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-779"><a href="#cb51-779" aria-hidden="true" tabindex="-1"></a>For part 2 I should probably check to see if I ever hit a row that I've seen before, and then use the repeated cycle to avoid having to calculate that many rows. Or I can just brute force it and not care:</span>
<span id="cb51-780"><a href="#cb51-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-783"><a href="#cb51-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-784"><a href="#cb51-784" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">400000</span> <span class="op">-</span> <span class="dv">40</span>):</span>
<span id="cb51-785"><a href="#cb51-785" aria-hidden="true" tabindex="-1"></a>    rows.append(data)</span>
<span id="cb51-786"><a href="#cb51-786" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> (scipy.ndimage.convolve(data, left_right, mode<span class="op">=</span><span class="st">"constant"</span>) <span class="op">==</span> <span class="dv">1</span>).astype(<span class="bu">int</span>)</span>
<span id="cb51-787"><a href="#cb51-787" aria-hidden="true" tabindex="-1"></a>(np.array(rows) <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb51-788"><a href="#cb51-788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-789"><a href="#cb51-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-790"><a href="#cb51-790" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 19: An Elephant Named Joseph](https://adventofcode.com/2016/day/19)</span></span>
<span id="cb51-791"><a href="#cb51-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-792"><a href="#cb51-792" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-793"><a href="#cb51-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-794"><a href="#cb51-794" aria-hidden="true" tabindex="-1"></a>This problem – with rotations by 1 and deletions only of neighboring elves is definitely calling for a deque:</span>
<span id="cb51-795"><a href="#cb51-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-798"><a href="#cb51-798" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-799"><a href="#cb51-799" aria-hidden="true" tabindex="-1"></a>limit <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb51-800"><a href="#cb51-800" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, limit <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb51-801"><a href="#cb51-801" aria-hidden="true" tabindex="-1"></a>queue <span class="op">=</span> deque(numbers)</span>
<span id="cb51-802"><a href="#cb51-802" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> queue:</span>
<span id="cb51-803"><a href="#cb51-803" aria-hidden="true" tabindex="-1"></a>    queue.rotate(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb51-804"><a href="#cb51-804" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> queue.popleft()</span>
<span id="cb51-805"><a href="#cb51-805" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb51-806"><a href="#cb51-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-807"><a href="#cb51-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-808"><a href="#cb51-808" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-809"><a href="#cb51-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-810"><a href="#cb51-810" aria-hidden="true" tabindex="-1"></a>Unfortunately, the same approach won't work here, since the rotations to the middle of the queue really ruin everything.</span>
<span id="cb51-811"><a href="#cb51-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-812"><a href="#cb51-812" aria-hidden="true" tabindex="-1"></a>What we can do instead is notice that the pattern of deletions correspond to leaving every third elf alive, starting just after halfway around the circle. To avoid interference from potentially dead elves, we can play the game in rounds, with one round ending whenever an elf at the start of the line would have died. In each round then, a number of elves at the start of the line get to take presents, a number in the middle do nothing, and a number at the end are eliminated from the game. What each of these lists looks like is not too hard to determine:</span>
<span id="cb51-813"><a href="#cb51-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-816"><a href="#cb51-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-817"><a href="#cb51-817" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> one_round(mylist):</span>
<span id="cb51-818"><a href="#cb51-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-819"><a href="#cb51-819" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> <span class="bu">len</span>(mylist)</span>
<span id="cb51-820"><a href="#cb51-820" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">int</span>((l <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">3</span>)</span>
<span id="cb51-821"><a href="#cb51-821" aria-hidden="true" tabindex="-1"></a>    middle <span class="op">=</span> mylist[<span class="bu">int</span>(l <span class="op">/</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> l <span class="op">%</span> <span class="dv">2</span> :: <span class="dv">3</span>]</span>
<span id="cb51-822"><a href="#cb51-822" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mylist[n : <span class="bu">int</span>(l <span class="op">/</span> <span class="dv">2</span>)] <span class="op">+</span> middle <span class="op">+</span> mylist[:n]</span>
<span id="cb51-823"><a href="#cb51-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-824"><a href="#cb51-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-825"><a href="#cb51-825" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">3005290</span></span>
<span id="cb51-826"><a href="#cb51-826" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, i <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb51-827"><a href="#cb51-827" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">len</span>(x) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb51-828"><a href="#cb51-828" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> one_round(x)</span>
<span id="cb51-829"><a href="#cb51-829" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">0</span>]</span>
<span id="cb51-830"><a href="#cb51-830" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-831"><a href="#cb51-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-832"><a href="#cb51-832" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 20: Firewall Rules](https://adventofcode.com/2016/day/20)</span></span>
<span id="cb51-833"><a href="#cb51-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-834"><a href="#cb51-834" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-835"><a href="#cb51-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-838"><a href="#cb51-838" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-839"><a href="#cb51-839" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="bu">sorted</span>(</span>
<span id="cb51-840"><a href="#cb51-840" aria-hidden="true" tabindex="-1"></a>    [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split(<span class="st">"-"</span>)] <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">20</span>)], key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">0</span>]</span>
<span id="cb51-841"><a href="#cb51-841" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-842"><a href="#cb51-842" aria-hidden="true" tabindex="-1"></a>low, high <span class="op">=</span> data[<span class="dv">0</span>]</span>
<span id="cb51-843"><a href="#cb51-843" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> new_low, new_high <span class="kw">in</span> data[<span class="dv">1</span>:]:</span>
<span id="cb51-844"><a href="#cb51-844" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> high <span class="op">+</span> <span class="dv">1</span> <span class="op">&lt;</span> new_low:</span>
<span id="cb51-845"><a href="#cb51-845" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb51-846"><a href="#cb51-846" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb51-847"><a href="#cb51-847" aria-hidden="true" tabindex="-1"></a>        high <span class="op">=</span> <span class="bu">max</span>(high, new_high)</span>
<span id="cb51-848"><a href="#cb51-848" aria-hidden="true" tabindex="-1"></a>high <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb51-849"><a href="#cb51-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-850"><a href="#cb51-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-851"><a href="#cb51-851" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-852"><a href="#cb51-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-853"><a href="#cb51-853" aria-hidden="true" tabindex="-1"></a>We'll start by merging the overlapping banned ranges together. Then, the high point of one range and the low point of the next range define a range of allowed values (endpoints not included). We can sum the length of these to get the total number of allowed values.</span>
<span id="cb51-854"><a href="#cb51-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-857"><a href="#cb51-857" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-858"><a href="#cb51-858" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_ranges(data):</span>
<span id="cb51-859"><a href="#cb51-859" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> []</span>
<span id="cb51-860"><a href="#cb51-860" aria-hidden="true" tabindex="-1"></a>    initial, final <span class="op">=</span> data[<span class="dv">0</span>]</span>
<span id="cb51-861"><a href="#cb51-861" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> low, high <span class="kw">in</span> data[<span class="dv">1</span>:]:</span>
<span id="cb51-862"><a href="#cb51-862" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> final <span class="op">+</span> <span class="dv">1</span> <span class="op">&gt;=</span> low:</span>
<span id="cb51-863"><a href="#cb51-863" aria-hidden="true" tabindex="-1"></a>            final <span class="op">=</span> <span class="bu">max</span>(high, final)</span>
<span id="cb51-864"><a href="#cb51-864" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb51-865"><a href="#cb51-865" aria-hidden="true" tabindex="-1"></a>            result <span class="op">+=</span> [initial, final]</span>
<span id="cb51-866"><a href="#cb51-866" aria-hidden="true" tabindex="-1"></a>            initial, final <span class="op">=</span> low, high</span>
<span id="cb51-867"><a href="#cb51-867" aria-hidden="true" tabindex="-1"></a>    result <span class="op">+=</span> [initial, final]</span>
<span id="cb51-868"><a href="#cb51-868" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb51-869"><a href="#cb51-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-870"><a href="#cb51-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-871"><a href="#cb51-871" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb51-872"><a href="#cb51-872" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span></span>
<span id="cb51-873"><a href="#cb51-873" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> ranges[<span class="dv">0</span>]</span>
<span id="cb51-874"><a href="#cb51-874" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="bu">sum</span>([high <span class="op">-</span> low <span class="op">-</span> <span class="dv">1</span> <span class="cf">for</span> low, high <span class="kw">in</span> <span class="bu">zip</span>(ranges[<span class="dv">1</span>::<span class="dv">2</span>], ranges[<span class="dv">2</span>::<span class="dv">2</span>])])</span>
<span id="cb51-875"><a href="#cb51-875" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="dv">4294967295</span></span>
<span id="cb51-876"><a href="#cb51-876" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> ranges[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb51-877"><a href="#cb51-877" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-878"><a href="#cb51-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-879"><a href="#cb51-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-880"><a href="#cb51-880" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 21: Scrambled Letters and Hash](https://adventofcode.com/2016/day/21)</span></span>
<span id="cb51-881"><a href="#cb51-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-882"><a href="#cb51-882" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-883"><a href="#cb51-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-886"><a href="#cb51-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-887"><a href="#cb51-887" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">21</span>)]</span>
<span id="cb51-888"><a href="#cb51-888" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="st">"abcdefgh"</span></span>
<span id="cb51-889"><a href="#cb51-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-890"><a href="#cb51-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-891"><a href="#cb51-891" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update(s, line, part<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb51-892"><a href="#cb51-892" aria-hidden="true" tabindex="-1"></a>    operands <span class="op">=</span> line[<span class="dv">2</span>], line[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb51-893"><a href="#cb51-893" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> line[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"reverse"</span>:</span>
<span id="cb51-894"><a href="#cb51-894" aria-hidden="true" tabindex="-1"></a>        l, r <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">map</span>(<span class="bu">int</span>, operands))</span>
<span id="cb51-895"><a href="#cb51-895" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s[:l] <span class="op">+</span> s[l : r <span class="op">+</span> <span class="dv">1</span>][::<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> s[r <span class="op">+</span> <span class="dv">1</span> :]</span>
<span id="cb51-896"><a href="#cb51-896" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> line[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"swap"</span>:</span>
<span id="cb51-897"><a href="#cb51-897" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"letter"</span>:</span>
<span id="cb51-898"><a href="#cb51-898" aria-hidden="true" tabindex="-1"></a>            l, r <span class="op">=</span> <span class="bu">map</span>(<span class="kw">lambda</span> x: s.index(x), operands)</span>
<span id="cb51-899"><a href="#cb51-899" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb51-900"><a href="#cb51-900" aria-hidden="true" tabindex="-1"></a>            l, r <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, operands)</span>
<span id="cb51-901"><a href="#cb51-901" aria-hidden="true" tabindex="-1"></a>        l, r <span class="op">=</span> <span class="bu">sorted</span>([l, r])</span>
<span id="cb51-902"><a href="#cb51-902" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s[:l] <span class="op">+</span> s[r] <span class="op">+</span> s[l <span class="op">+</span> <span class="dv">1</span> : r] <span class="op">+</span> s[l] <span class="op">+</span> s[r <span class="op">+</span> <span class="dv">1</span> :]</span>
<span id="cb51-903"><a href="#cb51-903" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> line[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"rotate"</span>:</span>
<span id="cb51-904"><a href="#cb51-904" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"left"</span>:</span>
<span id="cb51-905"><a href="#cb51-905" aria-hidden="true" tabindex="-1"></a>            rotation <span class="op">=</span> <span class="op">-</span><span class="bu">int</span>(operands[<span class="dv">0</span>])</span>
<span id="cb51-906"><a href="#cb51-906" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> line[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"right"</span>:</span>
<span id="cb51-907"><a href="#cb51-907" aria-hidden="true" tabindex="-1"></a>            rotation <span class="op">=</span> <span class="bu">int</span>(operands[<span class="dv">0</span>])</span>
<span id="cb51-908"><a href="#cb51-908" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb51-909"><a href="#cb51-909" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> part <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb51-910"><a href="#cb51-910" aria-hidden="true" tabindex="-1"></a>                index <span class="op">=</span> s.index(operands[<span class="dv">1</span>])</span>
<span id="cb51-911"><a href="#cb51-911" aria-hidden="true" tabindex="-1"></a>                rotation <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> index <span class="op">+</span> (index <span class="op">&gt;=</span> <span class="dv">4</span>)</span>
<span id="cb51-912"><a href="#cb51-912" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> part <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb51-913"><a href="#cb51-913" aria-hidden="true" tabindex="-1"></a>                rotation <span class="op">=</span> reverse_rotation(s, operands[<span class="dv">1</span>])</span>
<span id="cb51-914"><a href="#cb51-914" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> part <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb51-915"><a href="#cb51-915" aria-hidden="true" tabindex="-1"></a>            rotation <span class="op">=</span> <span class="op">-</span>rotation</span>
<span id="cb51-916"><a href="#cb51-916" aria-hidden="true" tabindex="-1"></a>        rotation <span class="op">=</span> rotation <span class="op">%</span> <span class="bu">len</span>(s)</span>
<span id="cb51-917"><a href="#cb51-917" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s[<span class="op">-</span>rotation:] <span class="op">+</span> s[:<span class="op">-</span>rotation]</span>
<span id="cb51-918"><a href="#cb51-918" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> line[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"move"</span>:</span>
<span id="cb51-919"><a href="#cb51-919" aria-hidden="true" tabindex="-1"></a>        source, dest <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, operands)</span>
<span id="cb51-920"><a href="#cb51-920" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> part <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb51-921"><a href="#cb51-921" aria-hidden="true" tabindex="-1"></a>            source, dest <span class="op">=</span> dest, source</span>
<span id="cb51-922"><a href="#cb51-922" aria-hidden="true" tabindex="-1"></a>        tmp <span class="op">=</span> s[:source] <span class="op">+</span> s[source <span class="op">+</span> <span class="dv">1</span> :]</span>
<span id="cb51-923"><a href="#cb51-923" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> tmp[:dest] <span class="op">+</span> s[source] <span class="op">+</span> tmp[dest:]</span>
<span id="cb51-924"><a href="#cb51-924" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span>
<span id="cb51-925"><a href="#cb51-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-926"><a href="#cb51-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-927"><a href="#cb51-927" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> data:</span>
<span id="cb51-928"><a href="#cb51-928" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> update(s, line)</span>
<span id="cb51-929"><a href="#cb51-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-930"><a href="#cb51-930" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb51-931"><a href="#cb51-931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-932"><a href="#cb51-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-933"><a href="#cb51-933" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-934"><a href="#cb51-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-935"><a href="#cb51-935" aria-hidden="true" tabindex="-1"></a>Ouch. <span class="in">`move`</span>, <span class="in">`swap`</span> and <span class="in">`reverse`</span> should be easy to do backwards, since they're self-inverses (potentially with the arguments swapped). The issue is <span class="in">`rotate`</span>. When we have to go left/right a fixed number of steps there's no problem, since we just go the other way. For the last one the issue is that the amount we have to rotate by depends on what the state was prior to the rotation. Luckily there aren't that many possible rotations, so the best approach seems to be to just to see which potential preimage string gives the correct answer when rotated.</span>
<span id="cb51-936"><a href="#cb51-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-939"><a href="#cb51-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-940"><a href="#cb51-940" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rotate_based_on(s, char):</span>
<span id="cb51-941"><a href="#cb51-941" aria-hidden="true" tabindex="-1"></a>    index <span class="op">=</span> s.index(char)</span>
<span id="cb51-942"><a href="#cb51-942" aria-hidden="true" tabindex="-1"></a>    rotation <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> index <span class="op">+</span> (index <span class="op">&gt;=</span> <span class="dv">4</span>)</span>
<span id="cb51-943"><a href="#cb51-943" aria-hidden="true" tabindex="-1"></a>    rotation <span class="op">=</span> rotation <span class="op">%</span> <span class="bu">len</span>(s)</span>
<span id="cb51-944"><a href="#cb51-944" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s[<span class="op">-</span>rotation:] <span class="op">+</span> s[:<span class="op">-</span>rotation]</span>
<span id="cb51-945"><a href="#cb51-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-946"><a href="#cb51-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-947"><a href="#cb51-947" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_rotation(s, char):</span>
<span id="cb51-948"><a href="#cb51-948" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, original_string <span class="kw">in</span> [(i, s[<span class="op">-</span>i:] <span class="op">+</span> s[:<span class="op">-</span>i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(s))]:</span>
<span id="cb51-949"><a href="#cb51-949" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> rotate_based_on(original_string, char) <span class="op">==</span> s:</span>
<span id="cb51-950"><a href="#cb51-950" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span>i</span>
<span id="cb51-951"><a href="#cb51-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-952"><a href="#cb51-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-953"><a href="#cb51-953" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="st">"fbgdceah"</span></span>
<span id="cb51-954"><a href="#cb51-954" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> data[::<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb51-955"><a href="#cb51-955" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> update(s, line, part<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb51-956"><a href="#cb51-956" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb51-957"><a href="#cb51-957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-958"><a href="#cb51-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-959"><a href="#cb51-959" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 22: Grid Computing](https://adventofcode.com/2016/day/22)</span></span>
<span id="cb51-960"><a href="#cb51-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-961"><a href="#cb51-961" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-962"><a href="#cb51-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-965"><a href="#cb51-965" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-966"><a href="#cb51-966" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">22</span>, <span class="st">"int"</span>)</span>
<span id="cb51-967"><a href="#cb51-967" aria-hidden="true" tabindex="-1"></a>data.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb51-968"><a href="#cb51-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-969"><a href="#cb51-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-970"><a href="#cb51-970" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> binary_search(key, haystack):</span>
<span id="cb51-971"><a href="#cb51-971" aria-hidden="true" tabindex="-1"></a>    key <span class="op">=</span> key[<span class="dv">3</span>]</span>
<span id="cb51-972"><a href="#cb51-972" aria-hidden="true" tabindex="-1"></a>    left, right <span class="op">=</span> <span class="dv">0</span>, <span class="bu">len</span>(haystack)</span>
<span id="cb51-973"><a href="#cb51-973" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (right <span class="op">-</span> left) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb51-974"><a href="#cb51-974" aria-hidden="true" tabindex="-1"></a>        midpoint <span class="op">=</span> <span class="bu">int</span>((left <span class="op">+</span> right) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb51-975"><a href="#cb51-975" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> haystack[midpoint][<span class="op">-</span><span class="dv">2</span>] <span class="op">&gt;=</span> key:</span>
<span id="cb51-976"><a href="#cb51-976" aria-hidden="true" tabindex="-1"></a>            right <span class="op">=</span> midpoint</span>
<span id="cb51-977"><a href="#cb51-977" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb51-978"><a href="#cb51-978" aria-hidden="true" tabindex="-1"></a>            left <span class="op">=</span> midpoint</span>
<span id="cb51-979"><a href="#cb51-979" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> right</span>
<span id="cb51-980"><a href="#cb51-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-981"><a href="#cb51-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-982"><a href="#cb51-982" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-983"><a href="#cb51-983" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx1, val <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb51-984"><a href="#cb51-984" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val[<span class="dv">3</span>] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb51-985"><a href="#cb51-985" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb51-986"><a href="#cb51-986" aria-hidden="true" tabindex="-1"></a>    idx2 <span class="op">=</span> binary_search(val, data)</span>
<span id="cb51-987"><a href="#cb51-987" aria-hidden="true" tabindex="-1"></a>    result <span class="op">+=</span> <span class="bu">len</span>(data[idx2:]) <span class="op">+</span> (idx2 <span class="op">&lt;=</span> idx1)</span>
<span id="cb51-988"><a href="#cb51-988" aria-hidden="true" tabindex="-1"></a>result</span>
<span id="cb51-989"><a href="#cb51-989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-990"><a href="#cb51-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-991"><a href="#cb51-991" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-992"><a href="#cb51-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-993"><a href="#cb51-993" aria-hidden="true" tabindex="-1"></a>Just another graph search. There's only one empty space, so we can uniquely define the current state by the location of the empty space, and the location of the data we're trying to move.</span>
<span id="cb51-994"><a href="#cb51-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-997"><a href="#cb51-997" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-998"><a href="#cb51-998" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> np.array(data)[:, :<span class="dv">2</span>].<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb51-999"><a href="#cb51-999" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> np.ones(size <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb51-1000"><a href="#cb51-1000" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array(data)</span>
<span id="cb51-1001"><a href="#cb51-1001" aria-hidden="true" tabindex="-1"></a>grid[<span class="bu">tuple</span>(data[np.where(data[:, <span class="dv">2</span>] <span class="op">&gt;</span> <span class="dv">200</span>)][:, :<span class="dv">2</span>].T)] <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb51-1002"><a href="#cb51-1002" aria-hidden="true" tabindex="-1"></a>source <span class="op">=</span> <span class="bu">tuple</span>(data[<span class="op">-</span><span class="dv">1</span>][:<span class="dv">2</span>])</span>
<span id="cb51-1003"><a href="#cb51-1003" aria-hidden="true" tabindex="-1"></a>grid[source] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-1004"><a href="#cb51-1004" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> size[<span class="dv">0</span>], <span class="dv">0</span></span>
<span id="cb51-1005"><a href="#cb51-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1006"><a href="#cb51-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1007"><a href="#cb51-1007" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> heuristic(x, y):</span>
<span id="cb51-1008"><a href="#cb51-1008" aria-hidden="true" tabindex="-1"></a>    to_data <span class="op">=</span> <span class="bu">abs</span>(x[<span class="dv">0</span>] <span class="op">-</span> y[<span class="dv">0</span>]) <span class="op">+</span> <span class="bu">abs</span>(x[<span class="dv">1</span>] <span class="op">-</span> y[<span class="dv">1</span>])</span>
<span id="cb51-1009"><a href="#cb51-1009" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span> <span class="op">*</span> (<span class="bu">abs</span>(y[<span class="dv">0</span>]) <span class="op">+</span> <span class="bu">abs</span>(y[<span class="dv">1</span>]) <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> to_data <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb51-1010"><a href="#cb51-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1011"><a href="#cb51-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1012"><a href="#cb51-1012" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> neighbors(x, y):</span>
<span id="cb51-1013"><a href="#cb51-1013" aria-hidden="true" tabindex="-1"></a>    new_states <span class="op">=</span> []</span>
<span id="cb51-1014"><a href="#cb51-1014" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> dx, dy <span class="kw">in</span> [(<span class="dv">0</span>, <span class="dv">1</span>), (<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>), (<span class="dv">1</span>, <span class="dv">0</span>), (<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)]:</span>
<span id="cb51-1015"><a href="#cb51-1015" aria-hidden="true" tabindex="-1"></a>        new_x <span class="op">=</span> x[<span class="dv">0</span>] <span class="op">+</span> dx, x[<span class="dv">1</span>] <span class="op">+</span> dy</span>
<span id="cb51-1016"><a href="#cb51-1016" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (</span>
<span id="cb51-1017"><a href="#cb51-1017" aria-hidden="true" tabindex="-1"></a>            new_x[<span class="dv">0</span>] <span class="op">&lt;</span> <span class="dv">0</span></span>
<span id="cb51-1018"><a href="#cb51-1018" aria-hidden="true" tabindex="-1"></a>            <span class="kw">or</span> new_x[<span class="dv">1</span>] <span class="op">&lt;</span> <span class="dv">0</span></span>
<span id="cb51-1019"><a href="#cb51-1019" aria-hidden="true" tabindex="-1"></a>            <span class="kw">or</span> new_x[<span class="dv">0</span>] <span class="op">&gt;</span> size[<span class="dv">0</span>]</span>
<span id="cb51-1020"><a href="#cb51-1020" aria-hidden="true" tabindex="-1"></a>            <span class="kw">or</span> new_x[<span class="dv">1</span>] <span class="op">&gt;</span> size[<span class="dv">1</span>]</span>
<span id="cb51-1021"><a href="#cb51-1021" aria-hidden="true" tabindex="-1"></a>            <span class="kw">or</span> grid[new_x] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb51-1022"><a href="#cb51-1022" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb51-1023"><a href="#cb51-1023" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb51-1024"><a href="#cb51-1024" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> new_x <span class="op">==</span> y:</span>
<span id="cb51-1025"><a href="#cb51-1025" aria-hidden="true" tabindex="-1"></a>            new_states.append((new_x, (x[<span class="dv">0</span>], x[<span class="dv">1</span>])))</span>
<span id="cb51-1026"><a href="#cb51-1026" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb51-1027"><a href="#cb51-1027" aria-hidden="true" tabindex="-1"></a>            new_states.append((new_x, y))</span>
<span id="cb51-1028"><a href="#cb51-1028" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_states</span>
<span id="cb51-1029"><a href="#cb51-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1030"><a href="#cb51-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1031"><a href="#cb51-1031" aria-hidden="true" tabindex="-1"></a>queue <span class="op">=</span> PriorityQueue()</span>
<span id="cb51-1032"><a href="#cb51-1032" aria-hidden="true" tabindex="-1"></a>queue.put((<span class="dv">0</span>, source, target))</span>
<span id="cb51-1033"><a href="#cb51-1033" aria-hidden="true" tabindex="-1"></a>costs <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: np.inf)</span>
<span id="cb51-1034"><a href="#cb51-1034" aria-hidden="true" tabindex="-1"></a>costs[source, target] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-1035"><a href="#cb51-1035" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-1036"><a href="#cb51-1036" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> queue.qsize() <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb51-1037"><a href="#cb51-1037" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-1038"><a href="#cb51-1038" aria-hidden="true" tabindex="-1"></a>    _, x, y <span class="op">=</span> queue.get()</span>
<span id="cb51-1039"><a href="#cb51-1039" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> y <span class="op">==</span> (<span class="dv">0</span>, <span class="dv">0</span>):</span>
<span id="cb51-1040"><a href="#cb51-1040" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> costs[x, y]</span>
<span id="cb51-1041"><a href="#cb51-1041" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb51-1042"><a href="#cb51-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1043"><a href="#cb51-1043" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> neighbors(x, y):</span>
<span id="cb51-1044"><a href="#cb51-1044" aria-hidden="true" tabindex="-1"></a>        current_cost <span class="op">=</span> costs[x, y] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb51-1045"><a href="#cb51-1045" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_cost <span class="op">&lt;</span> costs[a, b]:</span>
<span id="cb51-1046"><a href="#cb51-1046" aria-hidden="true" tabindex="-1"></a>            costs[a, b] <span class="op">=</span> current_cost</span>
<span id="cb51-1047"><a href="#cb51-1047" aria-hidden="true" tabindex="-1"></a>            queue.put((current_cost <span class="op">+</span> heuristic(a, b), a, b))</span>
<span id="cb51-1048"><a href="#cb51-1048" aria-hidden="true" tabindex="-1"></a>result</span>
<span id="cb51-1049"><a href="#cb51-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-1050"><a href="#cb51-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1051"><a href="#cb51-1051" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 23: Safe Cracking](https://adventofcode.com/2016/day/23)</span></span>
<span id="cb51-1052"><a href="#cb51-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1053"><a href="#cb51-1053" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-1054"><a href="#cb51-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1057"><a href="#cb51-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-1058"><a href="#cb51-1058" aria-hidden="true" tabindex="-1"></a>toggle_map <span class="op">=</span> {<span class="st">"inc"</span>: <span class="st">"dec"</span>, <span class="st">"tgl"</span>: <span class="st">"inc"</span>, <span class="st">"dec"</span>: <span class="st">"inc"</span>, <span class="st">"cpy"</span>: <span class="st">"jnz"</span>, <span class="st">"jnz"</span>: <span class="st">"cpy"</span>}</span>
<span id="cb51-1059"><a href="#cb51-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1060"><a href="#cb51-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1061"><a href="#cb51-1061" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run(program, registers<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb51-1062"><a href="#cb51-1062" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> registers <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb51-1063"><a href="#cb51-1063" aria-hidden="true" tabindex="-1"></a>        registers <span class="op">=</span> {<span class="st">"a"</span>: <span class="dv">0</span>, <span class="st">"b"</span>: <span class="dv">0</span>, <span class="st">"c"</span>: <span class="dv">0</span>, <span class="st">"d"</span>: <span class="dv">0</span>}</span>
<span id="cb51-1064"><a href="#cb51-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1065"><a href="#cb51-1065" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_operands(ip):</span>
<span id="cb51-1066"><a href="#cb51-1066" aria-hidden="true" tabindex="-1"></a>        instruction <span class="op">=</span> program[ip]</span>
<span id="cb51-1067"><a href="#cb51-1067" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> instruction[<span class="dv">0</span>], instruction[<span class="dv">1</span>:]</span>
<span id="cb51-1068"><a href="#cb51-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1069"><a href="#cb51-1069" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> evaluate_operand(x):</span>
<span id="cb51-1070"><a href="#cb51-1070" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(x) <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> <span class="st">"abcd"</span> <span class="cf">else</span> registers[x]</span>
<span id="cb51-1071"><a href="#cb51-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1072"><a href="#cb51-1072" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-1073"><a href="#cb51-1073" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-1074"><a href="#cb51-1074" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(program):</span>
<span id="cb51-1075"><a href="#cb51-1075" aria-hidden="true" tabindex="-1"></a>        i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-1076"><a href="#cb51-1076" aria-hidden="true" tabindex="-1"></a>        operator, operands <span class="op">=</span> extract_operands(ip)</span>
<span id="cb51-1077"><a href="#cb51-1077" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> operator <span class="kw">in</span> [<span class="st">"cpy"</span>, <span class="st">"jnz"</span>]:</span>
<span id="cb51-1078"><a href="#cb51-1078" aria-hidden="true" tabindex="-1"></a>            source, destination <span class="op">=</span> operands</span>
<span id="cb51-1079"><a href="#cb51-1079" aria-hidden="true" tabindex="-1"></a>            value <span class="op">=</span> evaluate_operand(source)</span>
<span id="cb51-1080"><a href="#cb51-1080" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> operator <span class="op">==</span> <span class="st">"cpy"</span>:</span>
<span id="cb51-1081"><a href="#cb51-1081" aria-hidden="true" tabindex="-1"></a>                registers[destination] <span class="op">=</span> value</span>
<span id="cb51-1082"><a href="#cb51-1082" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> operator <span class="op">==</span> <span class="st">"jnz"</span> <span class="kw">and</span> value <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb51-1083"><a href="#cb51-1083" aria-hidden="true" tabindex="-1"></a>                ip <span class="op">+=</span> evaluate_operand(destination) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb51-1084"><a href="#cb51-1084" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> operator <span class="kw">in</span> [<span class="st">"inc"</span>, <span class="st">"dec"</span>]:</span>
<span id="cb51-1085"><a href="#cb51-1085" aria-hidden="true" tabindex="-1"></a>            registers[operands[<span class="dv">0</span>]] <span class="op">+=</span> <span class="dv">2</span> <span class="op">*</span> (operator <span class="op">==</span> <span class="st">"inc"</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb51-1086"><a href="#cb51-1086" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> operator <span class="op">==</span> <span class="st">"tgl"</span>:</span>
<span id="cb51-1087"><a href="#cb51-1087" aria-hidden="true" tabindex="-1"></a>            destination <span class="op">=</span> ip <span class="op">+</span> evaluate_operand(operands[<span class="dv">0</span>])</span>
<span id="cb51-1088"><a href="#cb51-1088" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb51-1089"><a href="#cb51-1089" aria-hidden="true" tabindex="-1"></a>                operator, operands <span class="op">=</span> extract_operands(destination)</span>
<span id="cb51-1090"><a href="#cb51-1090" aria-hidden="true" tabindex="-1"></a>                operator <span class="op">=</span> toggle_map[operator]</span>
<span id="cb51-1091"><a href="#cb51-1091" aria-hidden="true" tabindex="-1"></a>                program[destination] <span class="op">=</span> [operator] <span class="op">+</span> operands</span>
<span id="cb51-1092"><a href="#cb51-1092" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">IndexError</span>:</span>
<span id="cb51-1093"><a href="#cb51-1093" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb51-1094"><a href="#cb51-1094" aria-hidden="true" tabindex="-1"></a>        ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-1095"><a href="#cb51-1095" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> registers[<span class="st">"a"</span>]</span>
<span id="cb51-1096"><a href="#cb51-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1097"><a href="#cb51-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1098"><a href="#cb51-1098" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [line.split(<span class="st">" "</span>) <span class="cf">for</span> line <span class="kw">in</span> load(<span class="st">"23"</span>)]</span>
<span id="cb51-1099"><a href="#cb51-1099" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> {<span class="st">"a"</span>: <span class="dv">7</span>, <span class="st">"b"</span>: <span class="dv">0</span>, <span class="st">"c"</span>: <span class="dv">0</span>, <span class="st">"d"</span>: <span class="dv">0</span>}</span>
<span id="cb51-1100"><a href="#cb51-1100" aria-hidden="true" tabindex="-1"></a>run(data, registers)</span>
<span id="cb51-1101"><a href="#cb51-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-1102"><a href="#cb51-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1103"><a href="#cb51-1103" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-1104"><a href="#cb51-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1105"><a href="#cb51-1105" aria-hidden="true" tabindex="-1"></a>Just setting the registers to <span class="in">`registers = {"a": 12, "b": 0, "c": 0, "d": 0}`</span> didn't work, since the code was running incredibly slowly. I ended up analysing my input script instead. The first line copied a to b, and lines 2-16 multiplied a by (b - 1), decreased b by one and set c to 2b (ish). Then came the toggle instruction, and the two instructions after that sent us back to line 2.</span>
<span id="cb51-1106"><a href="#cb51-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1107"><a href="#cb51-1107" aria-hidden="true" tabindex="-1"></a>Some things that stood out here were that c was an even number, decreasing by 2 each iteration so <span class="in">`tgl c`</span> tried to toggle every other instruction, starting at the end of the program and moving back towards the <span class="in">`tgl`</span> instruction itself. That means that the loop before the toggle instruction is unaffected for a long time, and so after the ith iteration we have a = n <span class="sc">\*</span> (n - 1) <span class="sc">\*</span> (n - 2) <span class="sc">\*</span> … <span class="sc">\*</span> (n - i). This continues until b = 2, when the <span class="in">`tgl`</span> instruction finally toggles the <span class="in">`jnz`</span> on line 17. At that point we have <span class="in">`a = factorial(n)`</span>. The (now-toggled) last section of the program then just adds the product of the numeric arguments on line 21 and 22.</span>
<span id="cb51-1108"><a href="#cb51-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1109"><a href="#cb51-1109" aria-hidden="true" tabindex="-1"></a>And that's the final answer.</span>
<span id="cb51-1110"><a href="#cb51-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1111"><a href="#cb51-1111" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 24: Air Duct Spelunking](https://adventofcode.com/2016/day/24)</span></span>
<span id="cb51-1112"><a href="#cb51-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1113"><a href="#cb51-1113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-1114"><a href="#cb51-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1115"><a href="#cb51-1115" aria-hidden="true" tabindex="-1"></a>This was a bit of a roller coaster. I originally used my pre-existing bfs code to search the maze, and it was unbelievably slow. Instead of investigating I decided to try and transform the maze, and found a conceptual approach which was horribly over-engineered, but probably would have worked. Before I finished implementing it, I thought of trying another BFS, less general and hence faster, and it ran more than fast enough. Oh well.</span>
<span id="cb51-1116"><a href="#cb51-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1117"><a href="#cb51-1117" aria-hidden="true" tabindex="-1"></a>I still liked the original approach though. The idea was to simplify the graph of the maze via the following transformations:</span>
<span id="cb51-1118"><a href="#cb51-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1119"><a href="#cb51-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Delete all empty (non-goal) nodes with only two neighbors by directly connecting their neighbors with a single edge, with a weight $w = w_1 + w_2$</span>
<span id="cb51-1120"><a href="#cb51-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Recursively remove all empty dead ends.</span>
<span id="cb51-1121"><a href="#cb51-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Identify bottlenecks in the graph, i.e. nodes whose removal would disconnect the graph. From there, generate the block-cut tree of the graph, and simplify each component of the block-cut to just the cut vertices and the goal nodes. This basically means that the problem of finding the shortest path X-<span class="sc">\&gt;</span>Y is reduced to finding the shortest path to and from a given bottleneck, and then stitching the paths together.</span>
<span id="cb51-1122"><a href="#cb51-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1123"><a href="#cb51-1123" aria-hidden="true" tabindex="-1"></a>It was fun to think about even though I didn't use it in the end.</span>
<span id="cb51-1124"><a href="#cb51-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1127"><a href="#cb51-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-1128"><a href="#cb51-1128" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.cluster.hierarchy <span class="im">import</span> DisjointSet</span>
<span id="cb51-1129"><a href="#cb51-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1130"><a href="#cb51-1130" aria-hidden="true" tabindex="-1"></a>parse <span class="op">=</span> <span class="kw">lambda</span> x: <span class="op">-</span><span class="dv">2</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">"#"</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">"."</span> <span class="cf">else</span> <span class="bu">int</span>(x)</span>
<span id="cb51-1131"><a href="#cb51-1131" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([[parse(char) <span class="cf">for</span> char <span class="kw">in</span> line] <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">24</span>)])</span>
<span id="cb51-1132"><a href="#cb51-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1133"><a href="#cb51-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1134"><a href="#cb51-1134" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> encode(mask):</span>
<span id="cb51-1135"><a href="#cb51-1135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>([x <span class="op">+</span> <span class="ot">1j</span> <span class="op">*</span> y <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>np.where(mask))])</span>
<span id="cb51-1136"><a href="#cb51-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1137"><a href="#cb51-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1138"><a href="#cb51-1138" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> np.where(data <span class="op">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb51-1139"><a href="#cb51-1139" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> data[nodes].argsort()</span>
<span id="cb51-1140"><a href="#cb51-1140" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> [x <span class="op">+</span> <span class="ot">1j</span> <span class="op">*</span> y <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>[index[order] <span class="cf">for</span> index <span class="kw">in</span> nodes])]</span>
<span id="cb51-1141"><a href="#cb51-1141" aria-hidden="true" tabindex="-1"></a>distances <span class="op">=</span> np.ones((<span class="bu">len</span>(nodes), <span class="bu">len</span>(nodes))) <span class="op">*</span> np.inf</span>
<span id="cb51-1142"><a href="#cb51-1142" aria-hidden="true" tabindex="-1"></a>node_indices <span class="op">=</span> {n: idx <span class="cf">for</span> idx, n <span class="kw">in</span> <span class="bu">enumerate</span>(nodes)}</span>
<span id="cb51-1143"><a href="#cb51-1143" aria-hidden="true" tabindex="-1"></a>open_squares <span class="op">=</span> encode(data <span class="op">&gt;</span> <span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb51-1144"><a href="#cb51-1144" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb51-1145"><a href="#cb51-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1146"><a href="#cb51-1146" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> square <span class="kw">in</span> open_squares:</span>
<span id="cb51-1147"><a href="#cb51-1147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> delta <span class="kw">in</span> (<span class="dv">1</span>, <span class="ot">1j</span>):</span>
<span id="cb51-1148"><a href="#cb51-1148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> square <span class="op">+</span> delta <span class="kw">in</span> open_squares:</span>
<span id="cb51-1149"><a href="#cb51-1149" aria-hidden="true" tabindex="-1"></a>            graph[square].append(square <span class="op">+</span> delta)</span>
<span id="cb51-1150"><a href="#cb51-1150" aria-hidden="true" tabindex="-1"></a>            graph[square <span class="op">+</span> delta].append(square)</span>
<span id="cb51-1151"><a href="#cb51-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1152"><a href="#cb51-1152" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node <span class="kw">in</span> nodes:</span>
<span id="cb51-1153"><a href="#cb51-1153" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> node_indices[node]</span>
<span id="cb51-1154"><a href="#cb51-1154" aria-hidden="true" tabindex="-1"></a>    queue <span class="op">=</span> deque([(<span class="dv">0</span>, node)])</span>
<span id="cb51-1155"><a href="#cb51-1155" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb51-1156"><a href="#cb51-1156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue <span class="kw">and</span> (distances[idx] <span class="op">==</span> np.inf).<span class="bu">any</span>():</span>
<span id="cb51-1157"><a href="#cb51-1157" aria-hidden="true" tabindex="-1"></a>        cost, state <span class="op">=</span> queue.popleft()</span>
<span id="cb51-1158"><a href="#cb51-1158" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> state <span class="kw">in</span> visited:</span>
<span id="cb51-1159"><a href="#cb51-1159" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb51-1160"><a href="#cb51-1160" aria-hidden="true" tabindex="-1"></a>        visited.add(state)</span>
<span id="cb51-1161"><a href="#cb51-1161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> state <span class="kw">in</span> nodes:</span>
<span id="cb51-1162"><a href="#cb51-1162" aria-hidden="true" tabindex="-1"></a>            new_idx <span class="op">=</span> node_indices[state]</span>
<span id="cb51-1163"><a href="#cb51-1163" aria-hidden="true" tabindex="-1"></a>            distances[idx, new_idx] <span class="op">=</span> cost</span>
<span id="cb51-1164"><a href="#cb51-1164" aria-hidden="true" tabindex="-1"></a>            distances[new_idx, idx] <span class="op">=</span> cost</span>
<span id="cb51-1165"><a href="#cb51-1165" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[state]:</span>
<span id="cb51-1166"><a href="#cb51-1166" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb51-1167"><a href="#cb51-1167" aria-hidden="true" tabindex="-1"></a>                queue.append((cost <span class="op">+</span> <span class="dv">1</span>, neighbor))</span>
<span id="cb51-1168"><a href="#cb51-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1169"><a href="#cb51-1169" aria-hidden="true" tabindex="-1"></a>minval <span class="op">=</span> np.inf</span>
<span id="cb51-1170"><a href="#cb51-1170" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> permutation <span class="kw">in</span> itertools.permutations(<span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(nodes))):</span>
<span id="cb51-1171"><a href="#cb51-1171" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> (<span class="dv">0</span>,) <span class="op">+</span> permutation[:<span class="op">-</span><span class="dv">1</span>], permutation</span>
<span id="cb51-1172"><a href="#cb51-1172" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (total <span class="op">:=</span> <span class="bu">sum</span>(distances[indices])) <span class="op">&lt;</span> minval:</span>
<span id="cb51-1173"><a href="#cb51-1173" aria-hidden="true" tabindex="-1"></a>        minval <span class="op">=</span> total</span>
<span id="cb51-1174"><a href="#cb51-1174" aria-hidden="true" tabindex="-1"></a><span class="bu">int</span>(minval)</span>
<span id="cb51-1175"><a href="#cb51-1175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-1176"><a href="#cb51-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1177"><a href="#cb51-1177" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb51-1178"><a href="#cb51-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1181"><a href="#cb51-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-1182"><a href="#cb51-1182" aria-hidden="true" tabindex="-1"></a>minval <span class="op">=</span> np.inf</span>
<span id="cb51-1183"><a href="#cb51-1183" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> permutation <span class="kw">in</span> itertools.permutations(<span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(nodes))):</span>
<span id="cb51-1184"><a href="#cb51-1184" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> (<span class="dv">0</span>,) <span class="op">+</span> permutation, permutation <span class="op">+</span> (<span class="dv">0</span>,)</span>
<span id="cb51-1185"><a href="#cb51-1185" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (total <span class="op">:=</span> <span class="bu">sum</span>(distances[indices])) <span class="op">&lt;</span> minval:</span>
<span id="cb51-1186"><a href="#cb51-1186" aria-hidden="true" tabindex="-1"></a>        minval <span class="op">=</span> total</span>
<span id="cb51-1187"><a href="#cb51-1187" aria-hidden="true" tabindex="-1"></a><span class="bu">int</span>(minval)</span>
<span id="cb51-1188"><a href="#cb51-1188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-1189"><a href="#cb51-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1190"><a href="#cb51-1190" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 25: Clock Signal](https://adventofcode.com/2016/day/25)</span></span>
<span id="cb51-1191"><a href="#cb51-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1192"><a href="#cb51-1192" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb51-1193"><a href="#cb51-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1194"><a href="#cb51-1194" aria-hidden="true" tabindex="-1"></a>This is an interesting problem, because it requires more thinking and less coding. Blindly running the code provided in my input leads to infinite loops, and the question is then how to analyse these. In particular, we're asked for an input that matches an infinite sequence of alternating ones and zeros, and we don't really have any way of knowing that a sequence that looks promising doesn't start to diverge after 100, 1000 or even 1,000,000 terms. Instead, I decided to analyse the provided code and understand what it was doing. After a bit of conversion, I found it to be equivalent to the following snippet:</span>
<span id="cb51-1195"><a href="#cb51-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1196"><a href="#cb51-1196" aria-hidden="true" tabindex="-1"></a><span class="in">``` python</span></span>
<span id="cb51-1197"><a href="#cb51-1197" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clock(start):</span>
<span id="cb51-1198"><a href="#cb51-1198" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb51-1199"><a href="#cb51-1199" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb51-1200"><a href="#cb51-1200" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> a <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb51-1201"><a href="#cb51-1201" aria-hidden="true" tabindex="-1"></a>            a <span class="op">=</span> start <span class="op">+</span> <span class="dv">2550</span></span>
<span id="cb51-1202"><a href="#cb51-1202" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> a <span class="op">%</span> <span class="dv">2</span></span>
<span id="cb51-1203"><a href="#cb51-1203" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb51-1204"><a href="#cb51-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-1205"><a href="#cb51-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1206"><a href="#cb51-1206" aria-hidden="true" tabindex="-1"></a>But that's just the binary representation of (start + 2550) reversed and repeated endlessly. So we're looking for the smallest number $n$ such that n + 2550 has a binary representation of the form $101010\ldots$</span>
<span id="cb51-1207"><a href="#cb51-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1210"><a href="#cb51-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb51-1211"><a href="#cb51-1211" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb51-1212"><a href="#cb51-1212" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> x <span class="op">&lt;</span> <span class="dv">2550</span>:</span>
<span id="cb51-1213"><a href="#cb51-1213" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb51-1214"><a href="#cb51-1214" aria-hidden="true" tabindex="-1"></a>x <span class="op">-</span> <span class="dv">2550</span></span>
<span id="cb51-1215"><a href="#cb51-1215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../index.html">Front page</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://github.com/cutonbuminband/AOC">Github</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>