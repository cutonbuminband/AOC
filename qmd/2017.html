<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>AOC - 2017 Solutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../qmd/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/2017.html">2017 Solutions</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">AOC</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2022.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2022 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2021.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2021 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2020.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2020 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2019.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2019 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2018.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2018 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2017.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2017 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2016.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2016 Solutions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/2015.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2015 Solutions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#imports" id="toc-imports" class="nav-link active" data-scroll-target="#imports">Imports</a></li>
  <li><a href="#day-1-inverse-captcha" id="toc-day-1-inverse-captcha" class="nav-link" data-scroll-target="#day-1-inverse-captcha">Day 1: Inverse Captcha</a>
  <ul class="collapse">
  <li><a href="#part-1" id="toc-part-1" class="nav-link" data-scroll-target="#part-1">Part 1</a></li>
  <li><a href="#part-2" id="toc-part-2" class="nav-link" data-scroll-target="#part-2">Part 2</a></li>
  </ul></li>
  <li><a href="#day-2-corruption-checksum" id="toc-day-2-corruption-checksum" class="nav-link" data-scroll-target="#day-2-corruption-checksum">Day 2: Corruption Checksum</a>
  <ul class="collapse">
  <li><a href="#part-1-1" id="toc-part-1-1" class="nav-link" data-scroll-target="#part-1-1">Part 1</a></li>
  <li><a href="#part-2-1" id="toc-part-2-1" class="nav-link" data-scroll-target="#part-2-1">Part 2</a></li>
  </ul></li>
  <li><a href="#day-3-spiral-memory" id="toc-day-3-spiral-memory" class="nav-link" data-scroll-target="#day-3-spiral-memory">Day 3: Spiral Memory</a>
  <ul class="collapse">
  <li><a href="#part-1-2" id="toc-part-1-2" class="nav-link" data-scroll-target="#part-1-2">Part 1</a></li>
  <li><a href="#part-2-2" id="toc-part-2-2" class="nav-link" data-scroll-target="#part-2-2">Part 2</a></li>
  </ul></li>
  <li><a href="#day-4-high-entropy-passphrases" id="toc-day-4-high-entropy-passphrases" class="nav-link" data-scroll-target="#day-4-high-entropy-passphrases">Day 4: High-Entropy Passphrases</a>
  <ul class="collapse">
  <li><a href="#part-1-3" id="toc-part-1-3" class="nav-link" data-scroll-target="#part-1-3">Part 1</a></li>
  <li><a href="#part-2-3" id="toc-part-2-3" class="nav-link" data-scroll-target="#part-2-3">Part 2</a></li>
  </ul></li>
  <li><a href="#day-5-a-maze-of-twisty-trampolines-all-alike" id="toc-day-5-a-maze-of-twisty-trampolines-all-alike" class="nav-link" data-scroll-target="#day-5-a-maze-of-twisty-trampolines-all-alike">Day 5: A Maze of Twisty Trampolines, All Alike</a>
  <ul class="collapse">
  <li><a href="#part-1-4" id="toc-part-1-4" class="nav-link" data-scroll-target="#part-1-4">Part 1</a></li>
  <li><a href="#part-2-4" id="toc-part-2-4" class="nav-link" data-scroll-target="#part-2-4">Part 2</a></li>
  </ul></li>
  <li><a href="#day-6-memory-reallocation" id="toc-day-6-memory-reallocation" class="nav-link" data-scroll-target="#day-6-memory-reallocation">Day 6: Memory Reallocation</a>
  <ul class="collapse">
  <li><a href="#part-1-5" id="toc-part-1-5" class="nav-link" data-scroll-target="#part-1-5">Part 1</a></li>
  <li><a href="#part-2-5" id="toc-part-2-5" class="nav-link" data-scroll-target="#part-2-5">Part 2</a></li>
  </ul></li>
  <li><a href="#day-7-recursive-circus" id="toc-day-7-recursive-circus" class="nav-link" data-scroll-target="#day-7-recursive-circus">Day 7: Recursive Circus</a>
  <ul class="collapse">
  <li><a href="#part-1-6" id="toc-part-1-6" class="nav-link" data-scroll-target="#part-1-6">Part 1</a></li>
  <li><a href="#part-2-6" id="toc-part-2-6" class="nav-link" data-scroll-target="#part-2-6">Part 2</a></li>
  </ul></li>
  <li><a href="#day-8-i-heard-you-like-registers" id="toc-day-8-i-heard-you-like-registers" class="nav-link" data-scroll-target="#day-8-i-heard-you-like-registers">Day 8: I Heard You Like Registers</a>
  <ul class="collapse">
  <li><a href="#part-1-7" id="toc-part-1-7" class="nav-link" data-scroll-target="#part-1-7">Part 1</a></li>
  <li><a href="#part-2-7" id="toc-part-2-7" class="nav-link" data-scroll-target="#part-2-7">Part 2</a></li>
  </ul></li>
  <li><a href="#day-9-stream-processing" id="toc-day-9-stream-processing" class="nav-link" data-scroll-target="#day-9-stream-processing">Day 9: Stream Processing</a>
  <ul class="collapse">
  <li><a href="#part-1-8" id="toc-part-1-8" class="nav-link" data-scroll-target="#part-1-8">Part 1</a></li>
  <li><a href="#part-2-8" id="toc-part-2-8" class="nav-link" data-scroll-target="#part-2-8">Part 2</a></li>
  </ul></li>
  <li><a href="#day-10-knot-hash" id="toc-day-10-knot-hash" class="nav-link" data-scroll-target="#day-10-knot-hash">Day 10: Knot Hash</a>
  <ul class="collapse">
  <li><a href="#part-1-9" id="toc-part-1-9" class="nav-link" data-scroll-target="#part-1-9">Part 1</a></li>
  <li><a href="#part-2-9" id="toc-part-2-9" class="nav-link" data-scroll-target="#part-2-9">Part 2</a></li>
  </ul></li>
  <li><a href="#day-11-hex-ed" id="toc-day-11-hex-ed" class="nav-link" data-scroll-target="#day-11-hex-ed">Day 11: Hex Ed</a>
  <ul class="collapse">
  <li><a href="#part-1-10" id="toc-part-1-10" class="nav-link" data-scroll-target="#part-1-10">Part 1</a></li>
  <li><a href="#part-2-10" id="toc-part-2-10" class="nav-link" data-scroll-target="#part-2-10">Part 2</a></li>
  </ul></li>
  <li><a href="#day-12-digital-plumber" id="toc-day-12-digital-plumber" class="nav-link" data-scroll-target="#day-12-digital-plumber">Day 12: Digital Plumber</a>
  <ul class="collapse">
  <li><a href="#part-1-11" id="toc-part-1-11" class="nav-link" data-scroll-target="#part-1-11">Part 1</a></li>
  <li><a href="#part-2-11" id="toc-part-2-11" class="nav-link" data-scroll-target="#part-2-11">Part 2</a></li>
  </ul></li>
  <li><a href="#day-13-packet-scanners" id="toc-day-13-packet-scanners" class="nav-link" data-scroll-target="#day-13-packet-scanners">Day 13: Packet Scanners</a>
  <ul class="collapse">
  <li><a href="#part-1-12" id="toc-part-1-12" class="nav-link" data-scroll-target="#part-1-12">Part 1</a></li>
  <li><a href="#part-2-12" id="toc-part-2-12" class="nav-link" data-scroll-target="#part-2-12">Part 2</a></li>
  </ul></li>
  <li><a href="#day-14-disk-defragmentation" id="toc-day-14-disk-defragmentation" class="nav-link" data-scroll-target="#day-14-disk-defragmentation">Day 14: Disk Defragmentation</a>
  <ul class="collapse">
  <li><a href="#part-1-13" id="toc-part-1-13" class="nav-link" data-scroll-target="#part-1-13">Part 1</a></li>
  <li><a href="#part-2-13" id="toc-part-2-13" class="nav-link" data-scroll-target="#part-2-13">Part 2</a></li>
  </ul></li>
  <li><a href="#day-15-dueling-generators" id="toc-day-15-dueling-generators" class="nav-link" data-scroll-target="#day-15-dueling-generators">Day 15: Dueling Generators</a>
  <ul class="collapse">
  <li><a href="#part-1-14" id="toc-part-1-14" class="nav-link" data-scroll-target="#part-1-14">Part 1</a></li>
  <li><a href="#part-2-14" id="toc-part-2-14" class="nav-link" data-scroll-target="#part-2-14">Part 2</a></li>
  </ul></li>
  <li><a href="#day-16-permutation-promenade" id="toc-day-16-permutation-promenade" class="nav-link" data-scroll-target="#day-16-permutation-promenade">Day 16: Permutation Promenade</a>
  <ul class="collapse">
  <li><a href="#part-1-15" id="toc-part-1-15" class="nav-link" data-scroll-target="#part-1-15">Part 1</a></li>
  <li><a href="#part-2-15" id="toc-part-2-15" class="nav-link" data-scroll-target="#part-2-15">Part 2</a></li>
  </ul></li>
  <li><a href="#day-17-spinlock" id="toc-day-17-spinlock" class="nav-link" data-scroll-target="#day-17-spinlock">Day 17: Spinlock</a>
  <ul class="collapse">
  <li><a href="#part-1-16" id="toc-part-1-16" class="nav-link" data-scroll-target="#part-1-16">Part 1</a></li>
  <li><a href="#part-2-16" id="toc-part-2-16" class="nav-link" data-scroll-target="#part-2-16">Part 2</a></li>
  </ul></li>
  <li><a href="#day-18-duet" id="toc-day-18-duet" class="nav-link" data-scroll-target="#day-18-duet">Day 18: Duet</a>
  <ul class="collapse">
  <li><a href="#part-1-17" id="toc-part-1-17" class="nav-link" data-scroll-target="#part-1-17">Part 1</a></li>
  <li><a href="#part-2-17" id="toc-part-2-17" class="nav-link" data-scroll-target="#part-2-17">Part 2</a></li>
  </ul></li>
  <li><a href="#day-19-a-series-of-tubes" id="toc-day-19-a-series-of-tubes" class="nav-link" data-scroll-target="#day-19-a-series-of-tubes">Day 19: A Series of Tubes</a>
  <ul class="collapse">
  <li><a href="#part-1-18" id="toc-part-1-18" class="nav-link" data-scroll-target="#part-1-18">Part 1</a></li>
  <li><a href="#part-2-18" id="toc-part-2-18" class="nav-link" data-scroll-target="#part-2-18">Part 2</a></li>
  </ul></li>
  <li><a href="#day-20-particle-swarm" id="toc-day-20-particle-swarm" class="nav-link" data-scroll-target="#day-20-particle-swarm">Day 20: Particle Swarm</a>
  <ul class="collapse">
  <li><a href="#part-1-19" id="toc-part-1-19" class="nav-link" data-scroll-target="#part-1-19">Part 1</a></li>
  <li><a href="#part-2-19" id="toc-part-2-19" class="nav-link" data-scroll-target="#part-2-19">Part 2</a></li>
  </ul></li>
  <li><a href="#day-21-fractal-art" id="toc-day-21-fractal-art" class="nav-link" data-scroll-target="#day-21-fractal-art">Day 21: Fractal Art</a>
  <ul class="collapse">
  <li><a href="#part-1-20" id="toc-part-1-20" class="nav-link" data-scroll-target="#part-1-20">Part 1</a></li>
  <li><a href="#part-2-20" id="toc-part-2-20" class="nav-link" data-scroll-target="#part-2-20">Part 2</a></li>
  </ul></li>
  <li><a href="#day-22-sporifica-virus" id="toc-day-22-sporifica-virus" class="nav-link" data-scroll-target="#day-22-sporifica-virus">Day 22: Sporifica Virus</a>
  <ul class="collapse">
  <li><a href="#part-1-21" id="toc-part-1-21" class="nav-link" data-scroll-target="#part-1-21">Part 1</a></li>
  <li><a href="#part-2-21" id="toc-part-2-21" class="nav-link" data-scroll-target="#part-2-21">Part 2</a></li>
  </ul></li>
  <li><a href="#day-23-coprocessor-conflagration" id="toc-day-23-coprocessor-conflagration" class="nav-link" data-scroll-target="#day-23-coprocessor-conflagration">Day 23: Coprocessor Conflagration</a>
  <ul class="collapse">
  <li><a href="#part-1-22" id="toc-part-1-22" class="nav-link" data-scroll-target="#part-1-22">Part 1</a></li>
  <li><a href="#part-2-22" id="toc-part-2-22" class="nav-link" data-scroll-target="#part-2-22">Part 2</a></li>
  </ul></li>
  <li><a href="#day-24-electromagnetic-moat" id="toc-day-24-electromagnetic-moat" class="nav-link" data-scroll-target="#day-24-electromagnetic-moat">Day 24: Electromagnetic Moat</a>
  <ul class="collapse">
  <li><a href="#part-1-23" id="toc-part-1-23" class="nav-link" data-scroll-target="#part-1-23">Part 1</a></li>
  <li><a href="#part-2-23" id="toc-part-2-23" class="nav-link" data-scroll-target="#part-2-23">Part 2</a></li>
  </ul></li>
  <li><a href="#day-25-the-halting-problem" id="toc-day-25-the-halting-problem" class="nav-link" data-scroll-target="#day-25-the-halting-problem">Day 25: The Halting Problem</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">2017 Solutions</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="imports" class="level1">
<h1>Imports</h1>
<div class="cell" data-execution_count="1">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> collections</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> functools</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> more_itertools</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>sys.path.insert(<span class="dv">1</span>, os.path.join(sys.path[<span class="dv">0</span>], <span class="st">".."</span>))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> utils</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>load <span class="op">=</span> utils.year_load(<span class="dv">2017</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="day-1-inverse-captcha" class="level1">
<h1><a href="https://adventofcode.com/2017/day/1">Day 1: Inverse Captcha</a></h1>
<section id="part-1" class="level2">
<h2 class="anchored" data-anchor-id="part-1">Part 1</h2>
<div class="cell" data-execution_count="2">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">1</span>)[<span class="dv">0</span>]], dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data[np.where(data <span class="op">==</span> np.roll(data, <span class="dv">1</span>))].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2" class="level2">
<h2 class="anchored" data-anchor-id="part-2">Part 2</h2>
<div class="cell" data-execution_count="3">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data[np.where(data <span class="op">==</span> np.roll(data, <span class="bu">len</span>(data) <span class="op">//</span> <span class="dv">2</span>))].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-2-corruption-checksum" class="level1">
<h1><a href="https://adventofcode.com/2017/day/2">Day 2: Corruption Checksum</a></h1>
<section id="part-1-1" class="level2">
<h2 class="anchored" data-anchor-id="part-1-1">Part 1</h2>
<div class="cell" data-execution_count="4">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="bu">sorted</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(x), x.split())) <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">2</span>)]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(a[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> a[<span class="dv">0</span>] <span class="cf">for</span> a <span class="kw">in</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-1" class="level2">
<h2 class="anchored" data-anchor-id="part-2-1">Part 2</h2>
<div class="cell" data-execution_count="5">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> data:</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, value <span class="kw">in</span> <span class="bu">enumerate</span>(line):</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(idx <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(line)):</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> line[j] <span class="op">//</span> value <span class="cf">if</span> line[j] <span class="op">%</span> value <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-3-spiral-memory" class="level1">
<h1><a href="https://adventofcode.com/2017/day/3">Day 3: Spiral Memory</a></h1>
<section id="part-1-2" class="level2">
<h2 class="anchored" data-anchor-id="part-1-2">Part 1</h2>
<div class="cell" data-execution_count="6">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>puzzle_input <span class="op">=</span> <span class="dv">368078</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>completed_squares <span class="op">=</span> (<span class="bu">int</span>(np.sqrt(puzzle_input) <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> <span class="dv">2</span> <span class="op">*</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>remainder <span class="op">=</span> (puzzle_input <span class="op">-</span> completed_squares<span class="op">**</span><span class="dv">2</span>) <span class="op">%</span> (completed_squares <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>(completed_squares <span class="op">//</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="bu">abs</span>((completed_squares <span class="op">//</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> remainder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-2" class="level2">
<h2 class="anchored" data-anchor-id="part-2-2">Part 2</h2>
<div class="cell" data-execution_count="7">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>coord, current_side, side_length, remainder <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>spiral <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>spiral[coord] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> remainder <span class="op">==</span> side_length:</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_side <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            coord <span class="op">=</span> coord <span class="op">+</span> direction <span class="op">-</span> <span class="ot">1j</span> <span class="op">*</span> direction</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            side_length <span class="op">+=</span> <span class="dv">2</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        direction <span class="op">=</span> <span class="ot">1j</span> <span class="op">*</span> direction</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        coord <span class="op">=</span> coord <span class="op">+</span> direction</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        current_side <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        remainder <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        coord <span class="op">=</span> coord <span class="op">+</span> direction</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        remainder <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product([<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="ot">1j</span>, <span class="dv">0</span>, <span class="ot">1j</span>]):</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> x <span class="kw">and</span> <span class="kw">not</span> y:</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> coord <span class="op">+</span> x <span class="op">+</span> y</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        tmp <span class="op">+=</span> spiral[target]</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tmp <span class="op">&gt;</span> puzzle_input:</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    spiral[coord] <span class="op">=</span> tmp</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-4-high-entropy-passphrases" class="level1">
<h1><a href="https://adventofcode.com/2017/day/4">Day 4: High-Entropy Passphrases</a></h1>
<section id="part-1-3" class="level2">
<h2 class="anchored" data-anchor-id="part-1-3">Part 1</h2>
<div class="cell" data-execution_count="8">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lines <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">4</span>)]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">len</span>(l) <span class="op">==</span> <span class="bu">len</span>(<span class="bu">set</span>(l)) <span class="cf">for</span> l <span class="kw">in</span> lines)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-3" class="level2">
<h2 class="anchored" data-anchor-id="part-2-3">Part 2</h2>
<div class="cell" data-execution_count="9">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">len</span>(l) <span class="op">==</span> <span class="bu">len</span>(<span class="bu">set</span>([<span class="st">""</span>.join(<span class="bu">sorted</span>(w)) <span class="cf">for</span> w <span class="kw">in</span> l])) <span class="cf">for</span> l <span class="kw">in</span> lines)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-5-a-maze-of-twisty-trampolines-all-alike" class="level1">
<h1><a href="https://adventofcode.com/2017/day/5">Day 5: A Maze of Twisty Trampolines, All Alike</a></h1>
<section id="part-1-4" class="level2">
<h2 class="anchored" data-anchor-id="part-1-4">Part 1</h2>
<div class="cell" data-execution_count="10">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> load(<span class="dv">5</span>, <span class="st">"np"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ip, count <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> ip <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(instructions):</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    instructions[ip] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">+=</span> instructions[ip] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-4" class="level2">
<h2 class="anchored" data-anchor-id="part-2-4">Part 2</h2>
<div class="cell" data-execution_count="11">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> load(<span class="dv">5</span>, <span class="st">"np"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ip, count <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> ip <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(instructions):</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    instruction <span class="op">=</span> instructions[ip]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    instructions[ip] <span class="op">+=</span> <span class="dv">1</span> <span class="cf">if</span> instruction <span class="op">&lt;</span> <span class="dv">3</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">+=</span> instruction</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-6-memory-reallocation" class="level1">
<h1><a href="https://adventofcode.com/2017/day/6">Day 6: Memory Reallocation</a></h1>
<section id="part-1-5" class="level2">
<h2 class="anchored" data-anchor-id="part-1-5">Part 1</h2>
<div class="cell" data-execution_count="12">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">4</span>, <span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">11</span>])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>seen <span class="op">=</span> {}</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> step(data):</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    idx, maxval <span class="op">=</span> data.argmax(), data.<span class="bu">max</span>()</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    data[idx] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> np.ones(<span class="bu">len</span>(data), dtype<span class="op">=</span><span class="bu">int</span>) <span class="op">*</span> (maxval <span class="op">//</span> l)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    delta[: maxval <span class="op">%</span> l] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    data <span class="op">+=</span> np.roll(delta, idx <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">tuple</span>(data) <span class="kw">not</span> <span class="kw">in</span> seen:</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    seen[<span class="bu">tuple</span>(data)] <span class="op">=</span> i</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> step(data)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I was getting the wrong answer for this for the longest time until I realised I’d left off a “0” at the start of my input when I copied it over.</p>
</section>
<section id="part-2-5" class="level2">
<h2 class="anchored" data-anchor-id="part-2-5">Part 2</h2>
<p>This was made trivial by tracking when a given configuration was seen.</p>
<div class="cell" data-execution_count="13">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>i <span class="op">-</span> seen[(<span class="bu">tuple</span>(data))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-7-recursive-circus" class="level1">
<h1><a href="https://adventofcode.com/2017/day/7">Day 7: Recursive Circus</a></h1>
<section id="part-1-6" class="level2">
<h2 class="anchored" data-anchor-id="part-1-6">Part 1</h2>
<div class="cell" data-execution_count="14">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> {}</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">7</span>):</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> line.split(<span class="st">" "</span>)[<span class="dv">0</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    children <span class="op">=</span> line.split(<span class="st">" -&gt; "</span>)[<span class="dv">1</span>].split(<span class="st">", "</span>) <span class="cf">if</span> <span class="st">" -&gt; "</span> <span class="kw">in</span> line <span class="cf">else</span> []</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    weight <span class="op">=</span> <span class="bu">int</span>(re.findall(<span class="st">"\d+"</span>, line)[<span class="dv">0</span>])</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    tree[name] <span class="op">=</span> {<span class="st">"weight"</span>: weight, <span class="st">"children"</span>: children}</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>parents <span class="op">=</span> {}</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node <span class="kw">in</span> tree:</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> tree[node][<span class="st">"children"</span>]:</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        parents[child] <span class="op">=</span> node</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>node <span class="op">=</span> (<span class="bu">set</span>(tree.keys()) <span class="op">-</span> <span class="bu">set</span>(parents.keys())).pop()</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>node</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-6" class="level2">
<h2 class="anchored" data-anchor-id="part-2-6">Part 2</h2>
<div class="cell" data-execution_count="15">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> weight(node):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree[node][<span class="st">"weight"</span>] <span class="op">+</span> <span class="bu">sum</span>(<span class="bu">map</span>(weight, tree[node][<span class="st">"children"</span>]))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_balanced(node):</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">not</span> tree[node][<span class="st">"children"</span>] <span class="kw">or</span> <span class="bu">len</span>(<span class="bu">set</span>(<span class="bu">map</span>(weight, tree[node][<span class="st">"children"</span>]))) <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="kw">not</span> is_balanced(node):</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> [weight(x) <span class="cf">for</span> x <span class="kw">in</span> tree[node][<span class="st">"children"</span>]]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    counts <span class="op">=</span> collections.Counter(weights)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    wrong_weight <span class="op">=</span> <span class="bu">min</span>(counts, key<span class="op">=</span>counts.get)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> tree[node][<span class="st">"children"</span>][weights.index(wrong_weight)]</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="bu">max</span>(counts, key<span class="op">=</span>counts.get) <span class="op">-</span> wrong_weight</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>tree[node][<span class="st">"weight"</span>] <span class="op">+</span> delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-8-i-heard-you-like-registers" class="level1">
<h1><a href="https://adventofcode.com/2017/day/8">Day 8: I Heard You Like Registers</a></h1>
<section id="part-1-7" class="level2">
<h2 class="anchored" data-anchor-id="part-1-7">Part 1</h2>
<div class="cell" data-execution_count="16">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> operator <span class="im">as</span> op</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">8</span>)]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>ops <span class="op">=</span> {<span class="st">"&lt;"</span>: op.lt, <span class="st">"&lt;="</span>: op.le, <span class="st">"=="</span>: op.eq, <span class="st">"&gt;="</span>: op.ge, <span class="st">"&gt;"</span>: op.gt, <span class="st">"!="</span>: op.ne}</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>signs <span class="op">=</span> {<span class="st">"dec"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"inc"</span>: <span class="dv">1</span>}</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> target, sign, inc_amount, _, comparator, comparison, cmp_value <span class="kw">in</span> instructions:</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ops[comparison](registers[comparator], <span class="bu">int</span>(cmp_value)):</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        registers[target] <span class="op">+=</span> signs[sign] <span class="op">*</span> <span class="bu">int</span>(inc_amount)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="bu">max</span>(registers.values())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-7" class="level2">
<h2 class="anchored" data-anchor-id="part-2-7">Part 2</h2>
<div class="cell" data-execution_count="17">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>maxval <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> target, sign, inc_amount, _, comparator, comparison, cmp_value <span class="kw">in</span> instructions:</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ops[comparison](registers[comparator], <span class="bu">int</span>(cmp_value)):</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        registers[target] <span class="op">+=</span> signs[sign] <span class="op">*</span> <span class="bu">int</span>(inc_amount)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    current_max <span class="op">=</span> <span class="bu">max</span>(registers.values())</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_max <span class="op">&gt;</span> maxval:</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        maxval <span class="op">=</span> current_max</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>maxval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-9-stream-processing" class="level1">
<h1><a href="https://adventofcode.com/2017/day/9">Day 9: Stream Processing</a></h1>
<section id="part-1-8" class="level2">
<h2 class="anchored" data-anchor-id="part-1-8">Part 1</h2>
<div class="cell" data-execution_count="18">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> canonical_form(sequence):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    replacements <span class="op">=</span> {<span class="st">"{"</span>: <span class="st">"["</span>, <span class="st">","</span>: <span class="st">","</span>, <span class="st">"}"</span>: <span class="st">"]"</span>}</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    mode <span class="op">=</span> <span class="st">"group"</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    skip <span class="op">=</span> <span class="va">False</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="st">""</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char <span class="kw">in</span> sequence:</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> skip:</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>            skip <span class="op">=</span> <span class="va">False</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> char <span class="op">==</span> <span class="st">"!"</span>:</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>            skip <span class="op">=</span> <span class="va">True</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">"group"</span> <span class="kw">and</span> char <span class="op">==</span> <span class="st">"&lt;"</span>:</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>            mode <span class="op">=</span> <span class="st">"garbage"</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">"garbage"</span> <span class="kw">and</span> char <span class="op">==</span> <span class="st">"&gt;"</span>:</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>            mode <span class="op">=</span> <span class="st">"group"</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">"garbage"</span>:</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>            count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">"group"</span>:</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">==</span> <span class="st">"}"</span>:</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                result <span class="op">+=</span> replacements[char]</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">==</span> <span class="st">"{"</span>:</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>                result <span class="op">+=</span> replacements[char]</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result, count</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">9</span>)[<span class="dv">0</span>]</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>data, count <span class="op">=</span> canonical_form(data)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>total, counter <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> char <span class="kw">in</span> data:</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> char <span class="op">==</span> <span class="st">"["</span>:</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>        counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> counter</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>        counter <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-8" class="level2">
<h2 class="anchored" data-anchor-id="part-2-8">Part 2</h2>
<div class="cell" data-execution_count="19">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-10-knot-hash" class="level1">
<h1><a href="https://adventofcode.com/2017/day/10">Day 10: Knot Hash</a></h1>
<section id="part-1-9" class="level2">
<h2 class="anchored" data-anchor-id="part-1-9">Part 1</h2>
<div class="cell" data-execution_count="20">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="st">"165,1,255,31,87,52,24,113,0,91,148,254,158,2,73,153"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>lengths <span class="op">=</span> [<span class="bu">int</span>(length) <span class="cf">for</span> length <span class="kw">in</span> data.split(<span class="st">","</span>)]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knot_hash1(lengths):</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    knots <span class="op">=</span> collections.deque(<span class="bu">range</span>(<span class="dv">256</span>))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, length <span class="kw">in</span> <span class="bu">enumerate</span>(lengths):</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        new <span class="op">=</span> collections.deque([knots.popleft() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(length)])</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>        new.reverse()</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        knots <span class="op">=</span> knots <span class="op">+</span> new</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        knots.rotate(<span class="op">-</span>idx)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> length <span class="op">+</span> idx</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    knots.rotate(total)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> knots</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>knots <span class="op">=</span> knot_hash1(lengths)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>knots.popleft() <span class="op">*</span> knots.popleft()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-9" class="level2">
<h2 class="anchored" data-anchor-id="part-2-9">Part 2</h2>
<div class="cell" data-execution_count="21">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knot_hash64(s):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    numbers <span class="op">=</span> [<span class="bu">ord</span>(x) <span class="cf">for</span> x <span class="kw">in</span> s] <span class="op">+</span> [<span class="dv">17</span>, <span class="dv">31</span>, <span class="dv">73</span>, <span class="dv">47</span>, <span class="dv">23</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    lengths <span class="op">=</span> itertools.chain.from_iterable(itertools.repeat(numbers, <span class="dv">64</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    knots <span class="op">=</span> <span class="bu">list</span>(knot_hash1(lengths))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    digits <span class="op">=</span> [</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        functools.<span class="bu">reduce</span>(<span class="kw">lambda</span> x, y: x <span class="op">^</span> y, knots[<span class="dv">16</span> <span class="op">*</span> i : <span class="dv">16</span> <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>)])</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">16</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join([<span class="st">"</span><span class="sc">{:0&gt;2x}</span><span class="st">"</span>.<span class="bu">format</span>(x) <span class="cf">for</span> x <span class="kw">in</span> digits])</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>knot_hash64(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-11-hex-ed" class="level1">
<h1><a href="https://adventofcode.com/2017/day/11">Day 11: Hex Ed</a></h1>
<section id="part-1-10" class="level2">
<h2 class="anchored" data-anchor-id="part-1-10">Part 1</h2>
<p>To describe the hexgrid we’ll use two basis vectors: x1, directed southeast, and x2, directed due north. All the other directions can be found as linear combinations of these, and the final position in this basis is just the sum of all the moves. Now, any move of the form (k, 1), with k in [-1, 0, 1] only takes one step, so the number of steps needed to reach the final position is just the value of whichever of the two basis vectors we have more of</p>
<div class="cell" data-execution_count="22">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="bu">open</span>(load(<span class="dv">11</span>)[<span class="dv">0</span>].split(<span class="st">","</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>coordinates <span class="op">=</span> {<span class="st">"se"</span>: np.array((<span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"s"</span>: np.array((<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>)),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"sw"</span>: np.array((<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>)),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"nw"</span>: np.array((<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"n"</span>: np.array((<span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"ne"</span>: np.array((<span class="dv">1</span>, <span class="dv">1</span>))}</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>moves <span class="op">=</span> np.array([coordinates[x] <span class="cf">for</span> x <span class="kw">in</span> data])</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="bu">max</span>(<span class="bu">abs</span>(moves.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-10" class="level2">
<h2 class="anchored" data-anchor-id="part-2-10">Part 2</h2>
<p>For part 2, instead of finding just the sum of the moves, we look at the running total, and ask what the greatest value of any of the coefficients is at any point in the path.</p>
<div class="cell" data-execution_count="23">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">abs</span>(moves.cumsum(axis<span class="op">=</span><span class="dv">0</span>)).<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-12-digital-plumber" class="level1">
<h1><a href="https://adventofcode.com/2017/day/12">Day 12: Digital Plumber</a></h1>
<section id="part-1-11" class="level2">
<h2 class="anchored" data-anchor-id="part-1-11">Part 1</h2>
<div class="cell" data-execution_count="24">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>regex <span class="op">=</span> <span class="st">"(-?\d+)"</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">12</span>, <span class="st">"int"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> {line[<span class="dv">0</span>]: line[<span class="dv">1</span>:] <span class="cf">for</span> line <span class="kw">in</span> data}</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>neighbors <span class="op">=</span> <span class="kw">lambda</span> state: graph[state]</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(utils.bfs(<span class="dv">0</span>, <span class="va">None</span>, neighbors, return_visited<span class="op">=</span><span class="va">True</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-11" class="level2">
<h2 class="anchored" data-anchor-id="part-2-11">Part 2</h2>
<div class="cell" data-execution_count="25">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> graph:</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> <span class="bu">list</span>(graph.keys())[<span class="dv">0</span>]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> utils.bfs(seed, <span class="va">None</span>, neighbors, return_visited<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key <span class="kw">in</span> visited:</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[key]</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-13-packet-scanners" class="level1">
<h1><a href="https://adventofcode.com/2017/day/13">Day 13: Packet Scanners</a></h1>
<section id="part-1-12" class="level2">
<h2 class="anchored" data-anchor-id="part-1-12">Part 1</h2>
<p>The only slightly tricky thing here is that we have to convert a depth to a cycle length. In each cycle, a scanner of depth d moves down (d - 1) steps, and then back up (d - 1) steps, so the cycle length is 2 * d - 2.</p>
<div class="cell" data-execution_count="26">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">13</span>, <span class="st">"int"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="dv">0</span> <span class="cf">if</span> (x[<span class="dv">0</span>] <span class="op">%</span> (x[<span class="dv">1</span>] <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span>)) <span class="cf">else</span> x[<span class="dv">0</span>] <span class="op">*</span> x[<span class="dv">1</span>], data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-12" class="level2">
<h2 class="anchored" data-anchor-id="part-2-12">Part 2</h2>
<p>So, this is another application of the chinese remainder theorem, after a bit of massaging. We have multiple scanners with the same depth at different positions; each such scanner invalidates a congruence class of the integers mod cycle length.</p>
<p>In my input, the depths were almost coprime in the sense that there was one of the scanner depths that divided all the others, and apart from that, the depths were either coprime, or divided one another exactly.</p>
<p>The depths that divide one another exactly can be handled by unfolding the restriction of the smaller number to its higher multiples, and then removing the smaller number from consideration. After that, we can find what numbers would be valid for each depth.</p>
<p>For most of these, there was only one such modulus. Taking all the ones for which that’s the case we can use the chinese remainder theorem to solve that system of congruences, and then manually move to higher congruences to satisfy the remaining scanners.</p>
<div class="cell" data-execution_count="27">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> crt</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>scanners <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> position, depth <span class="kw">in</span> data:</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    scanners[<span class="dv">2</span> <span class="op">*</span> depth <span class="op">-</span> <span class="dv">2</span>].append((<span class="op">-</span>position) <span class="op">%</span> (<span class="dv">2</span> <span class="op">*</span> depth <span class="op">-</span> <span class="dv">2</span>))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    scanners[<span class="dv">2</span> <span class="op">*</span> depth <span class="op">-</span> <span class="dv">2</span>].sort()</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>seen <span class="op">=</span> []</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s1, s2 <span class="kw">in</span> itertools.combinations(scanners.keys(), <span class="dv">2</span>):</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    s2, s1 <span class="op">=</span> <span class="bu">sorted</span>([s1, s2])</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s1 <span class="op">%</span> s2) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        seen.append(s2)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        offsets <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, s1, s2))</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        new_restrictions <span class="op">=</span> <span class="bu">list</span>(</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">map</span>(<span class="bu">sum</span>, <span class="bu">list</span>(itertools.product(offsets, scanners[s2])))</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        restrictions <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(new_restrictions <span class="op">+</span> scanners[s1]))</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        scanners[s1] <span class="op">=</span> restrictions</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> <span class="bu">set</span>(seen):</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> scanners[key]</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>valid <span class="op">=</span> {}</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> scanner <span class="kw">in</span> scanners:</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    valid[scanner] <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(<span class="bu">range</span>(scanner)) <span class="op">-</span> <span class="bu">set</span>(scanners[scanner]))</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> math.gcd(</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>(</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">list</span>(valid.keys())</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> [element <span class="cf">for</span> numbers <span class="kw">in</span> valid.values() <span class="cf">for</span> element <span class="kw">in</span> numbers]</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>congruences <span class="op">=</span> []</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>remainder <span class="op">=</span> {}</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> modulus <span class="kw">in</span> valid:</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(valid[modulus]) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>        congruences.append((<span class="bu">int</span>(modulus <span class="op">/</span> g), <span class="bu">int</span>(valid[modulus][<span class="dv">0</span>] <span class="op">/</span> g)))</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>        remainder[<span class="bu">int</span>(modulus <span class="op">/</span> g)] <span class="op">=</span> [<span class="bu">int</span>(x <span class="op">/</span> g) <span class="cf">for</span> x <span class="kw">in</span> valid[modulus]]</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.product([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> congruences])</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> crt(congruences) <span class="op">-</span> N</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    x <span class="op">+=</span> N</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> v <span class="kw">in</span> remainder:</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (x <span class="op">%</span> v) <span class="kw">not</span> <span class="kw">in</span> remainder[v]:</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>g <span class="op">*</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-14-disk-defragmentation" class="level1">
<h1><a href="https://adventofcode.com/2017/day/14">Day 14: Disk Defragmentation</a></h1>
<section id="part-1-13" class="level2">
<h2 class="anchored" data-anchor-id="part-1-13">Part 1</h2>
<div class="cell" data-execution_count="28">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>prefix <span class="op">=</span> load(<span class="dv">14</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">"-"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>hashes <span class="op">=</span> [knot_hash64(prefix <span class="op">+</span> <span class="bu">str</span>(i)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">128</span>)]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>bitstrings <span class="op">=</span> [<span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(h, <span class="dv">16</span>)<span class="sc">:0128b}</span><span class="ss">"</span> <span class="cf">for</span> h <span class="kw">in</span> hashes]</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(x.count(<span class="st">"1"</span>) <span class="cf">for</span> x <span class="kw">in</span> bitstrings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-13" class="level2">
<h2 class="anchored" data-anchor-id="part-2-13">Part 2</h2>
<div class="cell" data-execution_count="29">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>field <span class="op">=</span> np.array([[<span class="bu">ord</span>(x) <span class="op">-</span> <span class="bu">ord</span>(<span class="st">"0"</span>) <span class="cf">for</span> x <span class="kw">in</span> b] <span class="cf">for</span> b <span class="kw">in</span> bitstrings])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, j <span class="kw">in</span> itertools.product(<span class="bu">range</span>(<span class="dv">128</span>), <span class="bu">range</span>(<span class="dv">128</span>)):</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> [(i, j <span class="op">+</span> <span class="dv">1</span>), (i <span class="op">+</span> <span class="dv">1</span>, j)]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> [(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> neighbors <span class="cf">if</span> (x <span class="op">&lt;</span> <span class="dv">128</span> <span class="kw">and</span> y <span class="op">&lt;</span> <span class="dv">128</span>)]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> field[i, j]:</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> field[neighbor]:</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>            graph[(i, j)].append(neighbor)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>            graph[neighbor].append((i, j))</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> field.<span class="bu">sum</span>() <span class="op">-</span> <span class="bu">len</span>(graph)  <span class="co"># singletons</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>neighbors <span class="op">=</span> <span class="kw">lambda</span> x: graph[x]</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> graph:</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> <span class="bu">list</span>(graph.keys())[<span class="dv">0</span>]</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> utils.bfs(seed, <span class="va">None</span>, neighbors, return_visited<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> visited:</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[node]</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-15-dueling-generators" class="level1">
<h1><a href="https://adventofcode.com/2017/day/15">Day 15: Dueling Generators</a></h1>
<section id="part-1-14" class="level2">
<h2 class="anchored" data-anchor-id="part-1-14">Part 1</h2>
<div class="cell" data-execution_count="30">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="dv">16807</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="dv">48271</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">116</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">299</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">40_000_000</span>):</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> (a <span class="op">*</span> A) <span class="op">%</span> <span class="dv">2147483647</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> (b <span class="op">*</span> B) <span class="op">%</span> <span class="dv">2147483647</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    total <span class="op">+=</span> (a <span class="op">%</span> <span class="dv">2</span><span class="op">**</span><span class="dv">16</span>) <span class="op">==</span> (b <span class="op">%</span> <span class="dv">2</span><span class="op">**</span><span class="dv">16</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-14" class="level2">
<h2 class="anchored" data-anchor-id="part-2-14">Part 2</h2>
<div class="cell" data-execution_count="31">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">116</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">299</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gen_a(start):</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> start</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> (current <span class="op">*</span> A) <span class="op">%</span> <span class="dv">2147483647</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> current</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gen_b(start):</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> start</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> (current <span class="op">*</span> B) <span class="op">%</span> <span class="dv">2147483647</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current <span class="op">%</span> <span class="dv">8</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> current</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> gen_a(a)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> gen_b(b)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5_000_000</span>):</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    total <span class="op">+=</span> (<span class="bu">next</span>(a) <span class="op">%</span> <span class="dv">2</span><span class="op">**</span><span class="dv">16</span>) <span class="op">==</span> (<span class="bu">next</span>(b) <span class="op">%</span> <span class="dv">2</span><span class="op">**</span><span class="dv">16</span>)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-16-permutation-promenade" class="level1">
<h1><a href="https://adventofcode.com/2017/day/16">Day 16: Permutation Promenade</a></h1>
<section id="part-1-15" class="level2">
<h2 class="anchored" data-anchor-id="part-1-15">Part 1</h2>
<div class="cell" data-execution_count="32">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>moves <span class="op">=</span> load(<span class="dv">16</span>)[<span class="dv">0</span>].split(<span class="st">","</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>permutations <span class="op">=</span> <span class="bu">list</span>(<span class="st">"abcdefghijklmnop"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dance(permutations, n):</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    seen <span class="op">=</span> []</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> <span class="st">""</span>.join(permutations)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> s <span class="kw">in</span> seen:</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> seen[n <span class="op">%</span> i]</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        seen.append(s)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> move <span class="kw">in</span> moves:</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> move[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"s"</span>:</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>                i <span class="op">=</span> <span class="bu">int</span>(move[<span class="dv">1</span>:])</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>                permutations <span class="op">=</span> permutations[<span class="op">-</span>i:] <span class="op">+</span> permutations[:<span class="op">-</span>i]</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> move[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"x"</span>:</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                    a, b <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, move[<span class="dv">1</span>:].split(<span class="st">"/"</span>))</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>                    permutations[a], permutations[b] <span class="op">=</span> permutations[b], permutations[a]</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> move[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"p"</span>:</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>                    a, b <span class="op">=</span> move[<span class="dv">1</span>:].split(<span class="st">"/"</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>                    A <span class="op">=</span> permutations.index(a)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>                    B <span class="op">=</span> permutations.index(b)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>                    permutations[A], permutations[B] <span class="op">=</span> permutations[B], permutations[A]</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> permutations</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co">""</span>.join(dance(permutations[:], <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-15" class="level2">
<h2 class="anchored" data-anchor-id="part-2-15">Part 2</h2>
<p>For part 2, it would take too long to go through all the one billion cycles. But what if the dances hit a cycle at some point? That would make things a lot easier!</p>
<div class="cell" data-execution_count="33">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>dance(permutations[:], <span class="dv">1_000_000_000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-17-spinlock" class="level1">
<h1><a href="https://adventofcode.com/2017/day/17">Day 17: Spinlock</a></h1>
<section id="part-1-16" class="level2">
<h2 class="anchored" data-anchor-id="part-1-16">Part 1</h2>
<div class="cell" data-execution_count="34">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>steps <span class="op">=</span> <span class="dv">386</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> collections.deque([<span class="dv">0</span>])</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">2018</span>):</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    q.rotate(<span class="op">-</span>steps <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    q.appendleft(i)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>q[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-16" class="level2">
<h2 class="anchored" data-anchor-id="part-2-16">Part 2</h2>
<p>50 million is at a level where the previous approach is becoming ineffective. The code below takes ~40 seconds to run. It could probably be improved, but that would take longer than 40 seconds.</p>
<div class="cell" data-execution_count="35">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> collections.deque([<span class="dv">0</span>])</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">50_000_000</span>):</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    q.rotate(<span class="op">-</span>steps <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    q.appendleft(i)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>q[q.index(<span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-18-duet" class="level1">
<h1><a href="https://adventofcode.com/2017/day/18">Day 18: Duet</a></h1>
<section id="part-1-17" class="level2">
<h2 class="anchored" data-anchor-id="part-1-17">Part 1</h2>
<div class="cell" data-execution_count="36">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>program <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">18</span>)]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>binops <span class="op">=</span> {</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"set"</span>: <span class="kw">lambda</span> x, y: y,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"add"</span>: <span class="kw">lambda</span> x, y: x <span class="op">+</span> y,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mul"</span>: <span class="kw">lambda</span> x, y: x <span class="op">*</span> y,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mod"</span>: <span class="kw">lambda</span> x, y: x <span class="op">%</span> y,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>memory <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="dv">0</span> <span class="op">&lt;=</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(program):</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    instruction <span class="op">=</span> program[ip]</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    instruction, register, argument <span class="op">=</span> instruction[<span class="dv">0</span>], instruction[<span class="dv">1</span>], instruction[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        argument <span class="op">=</span> <span class="bu">int</span>(argument)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>        argument <span class="op">=</span> registers[argument]</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> instruction <span class="kw">in</span> binops:</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>        op <span class="op">=</span> binops[instruction]</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>        registers[register] <span class="op">=</span> op(registers[register], argument)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"jgz"</span>:</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> registers[register] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>            ip <span class="op">+=</span> argument <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"rcv"</span>:</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> registers[register] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(memory)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"snd"</span>:</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>        memory <span class="op">=</span> argument</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">+=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-17" class="level2">
<h2 class="anchored" data-anchor-id="part-2-17">Part 2</h2>
<p>There’s a bunch of state to keep track of - let’s make a class to hold it.</p>
<div class="cell" data-execution_count="37">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Program:</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, program, program_id, inputs):</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.program <span class="op">=</span> program.copy()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ram <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ram[<span class="st">"p"</span>] <span class="op">=</span> program_id</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.state <span class="op">=</span> <span class="dv">1</span>  <span class="co"># ready</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.inputs <span class="op">=</span> inputs</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__next__</span>(<span class="va">self</span>):</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="dv">0</span> <span class="op">&lt;=</span> <span class="va">self</span>.ip <span class="op">&lt;</span> <span class="bu">len</span>(<span class="va">self</span>.program):</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>            instruction <span class="op">=</span> <span class="va">self</span>.program[<span class="va">self</span>.ip]</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>            instruction, register, argument <span class="op">=</span> (</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>                instruction[<span class="dv">0</span>],</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>                instruction[<span class="dv">1</span>],</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>                instruction[<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>                argument <span class="op">=</span> <span class="bu">int</span>(argument)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>                argument <span class="op">=</span> <span class="va">self</span>.ram[argument]</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> instruction <span class="kw">in</span> binops:</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>                op <span class="op">=</span> binops[instruction]</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.ram[register] <span class="op">=</span> op(<span class="va">self</span>.ram[register], argument)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"jgz"</span>:</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>                    comparison <span class="op">=</span> <span class="bu">int</span>(register)</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>                    comparison <span class="op">=</span> <span class="va">self</span>.ram[register]</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> comparison <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.ip <span class="op">+=</span> argument <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"rcv"</span>:</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.inputs:</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.state <span class="op">=</span> <span class="dv">0</span>  <span class="co"># Waiting</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>                x <span class="op">=</span> <span class="va">self</span>.inputs.pop(<span class="dv">0</span>)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.ram[register] <span class="op">=</span> x</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"snd"</span>:</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> argument</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.state <span class="op">=</span> <span class="dv">2</span>  <span class="co"># terminated</span></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>With that out of the way we can implement the collaboration as follows: run program 0 until it’s asking for a non-existent value (or finishes), then do the same for program 1. Keep going until both programs are waiting for the other or p1 has finished.</p>
<div class="cell" data-execution_count="38">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>bus_one <span class="op">=</span> []</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>bus_two <span class="op">=</span> []</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>p0 <span class="op">=</span> Program(program, <span class="dv">0</span>, bus_two)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> Program(program, <span class="dv">1</span>, bus_one)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> p0.state <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> p1.state <span class="op">!=</span> <span class="dv">2</span>:</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> p0.state <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> <span class="bu">next</span>(p0)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>            bus_one.append(n)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bus_one <span class="kw">and</span> p1.state <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        p1.state <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> p1.state <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> <span class="bu">next</span>(p1)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>            bus_two.append(n)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bus_two <span class="kw">and</span> p0.state <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        p0.state <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>p1.count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-19-a-series-of-tubes" class="level1">
<h1><a href="https://adventofcode.com/2017/day/19">Day 19: A Series of Tubes</a></h1>
<section id="part-1-18" class="level2">
<h2 class="anchored" data-anchor-id="part-1-18">Part 1</h2>
<p>The hardest part for this was determining a sensible stopping condition – that is one that could tell the difference between wires randomly crossing, and actually being finished. Direct inspection of the input showed where there was a dead end, so that’s just hard-coded into the below:</p>
<div class="cell" data-execution_count="39">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">19</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> <span class="bu">len</span>(data[<span class="dv">0</span>]), <span class="bu">len</span>(data)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> <span class="ot">1j</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>deltas <span class="op">=</span> [(<span class="ot">1j</span>, <span class="st">"|"</span>), (<span class="op">-</span><span class="ot">1j</span>, <span class="st">"|"</span>), (<span class="dv">1</span>, <span class="st">"-"</span>), (<span class="op">-</span><span class="dv">1</span>, <span class="st">"-"</span>)]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> data[<span class="dv">0</span>].index(<span class="st">"|"</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>result, character <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> character <span class="op">!=</span> <span class="st">"L"</span>:</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    position <span class="op">=</span> position <span class="op">+</span> direction</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    character <span class="op">=</span> data[<span class="bu">int</span>(position.imag)][<span class="bu">int</span>(position.real)]</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> character <span class="op">==</span> <span class="st">"+"</span>:</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> delta, char <span class="kw">in</span> deltas:</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> delta <span class="op">==</span> <span class="op">-</span>direction:</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>            lookahead <span class="op">=</span> position <span class="op">+</span> delta</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>                next_char <span class="op">=</span> data[<span class="bu">int</span>(lookahead.imag)][<span class="bu">int</span>(lookahead.real)]</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">IndexError</span>:</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> next_char <span class="op">==</span> char:</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>                direction <span class="op">=</span> delta</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> character <span class="kw">in</span> string.ascii_letters:</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> character</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-18" class="level2">
<h2 class="anchored" data-anchor-id="part-2-18">Part 2</h2>
<p>I don’t know if this was intentional, but with the solution to part 1 above, counting the number of steps is trivial. Just add a loop variable to keep track of how many times we move</p>
<div class="cell" data-execution_count="40">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-20-particle-swarm" class="level1">
<h1><a href="https://adventofcode.com/2017/day/20">Day 20: Particle Swarm</a></h1>
<section id="part-1-19" class="level2">
<h2 class="anchored" data-anchor-id="part-1-19">Part 1</h2>
<p>It’s always nice to be able to come up with a one-liner to solve these.</p>
<div class="cell" data-execution_count="41">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array(load(<span class="dv">20</span>, <span class="st">"int"</span>), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="bu">abs</span>(data[:, <span class="op">-</span><span class="dv">3</span>:]).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).argmin()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-19" class="level2">
<h2 class="anchored" data-anchor-id="part-2-19">Part 2</h2>
<p>For part two we could do some clever work to figure out a stopping condition based on pairs of particles being reachable in each of three dimensions, with reachable defined by being potentially able to catch up. Or we can just pick an arbitrary upper bound and hope it’s good enough.</p>
<div class="cell" data-execution_count="42">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>s, v, dv <span class="op">=</span> data[:, :<span class="dv">3</span>], data[:, <span class="dv">3</span>:<span class="dv">6</span>], data[:, <span class="op">-</span><span class="dv">3</span>:]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    v <span class="op">+=</span> dv</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    s <span class="op">+=</span> v</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    values, index, count <span class="op">=</span> np.unique(s, return_counts<span class="op">=</span><span class="va">True</span>, return_index<span class="op">=</span><span class="va">True</span>, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> index[np.where(count <span class="op">==</span> <span class="dv">1</span>)]</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    s, v, dv <span class="op">=</span> s[indices], v[indices], dv[indices]</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-21-fractal-art" class="level1">
<h1><a href="https://adventofcode.com/2017/day/21">Day 21: Fractal Art</a></h1>
<section id="part-1-20" class="level2">
<h2 class="anchored" data-anchor-id="part-1-20">Part 1</h2>
<p>This feels like the triumph of brute force over elegance. The process involves exponential growth, where the array triples in size every three iterations, so brute forcing seems like an unlikely choice, but the numbers are small enough that it just about works.</p>
<div class="cell" data-execution_count="43">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>translation <span class="op">=</span> <span class="bu">str</span>.maketrans(<span class="st">".#/"</span>, <span class="st">"01</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [x.translate(translation).split(<span class="st">" =&gt; "</span>) <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">21</span>)]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hashed(array):</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(array.ravel())</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>replacements <span class="op">=</span> {}</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> data:</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    src, dest <span class="op">=</span> <span class="bu">map</span>(</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> array: np.array(</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>            [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line] <span class="cf">for</span> line <span class="kw">in</span> array.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)], dtype<span class="op">=</span><span class="bu">bool</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>        row,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    flipped <span class="op">=</span> src[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>        replacements[hashed(flipped)] <span class="op">=</span> dest</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>        replacements[hashed(src)] <span class="op">=</span> dest</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>        src, flipped <span class="op">=</span> np.rot90(src), np.rot90(flipped)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.reshape([<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="st">".#...####"</span>.translate(translation)], (<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solve(array, n):</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> array.shape[<span class="dv">0</span>]</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>        step <span class="op">=</span> <span class="dv">2</span> <span class="cf">if</span> s <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">3</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>        new_step <span class="op">=</span> <span class="dv">3</span> <span class="cf">if</span> step <span class="op">==</span> <span class="dv">2</span> <span class="cf">else</span> <span class="dv">4</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>        new_size <span class="op">=</span> (s <span class="op">//</span> step) <span class="op">*</span> new_step</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>        new_array <span class="op">=</span> np.zeros((new_size, new_size), dtype<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, s, step):</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, s, step):</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>                square <span class="op">=</span> array[i : i <span class="op">+</span> step, j : j <span class="op">+</span> step]</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>                new_square <span class="op">=</span> replacements[hashed(square)]</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>                new_array[</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>                    (i <span class="op">//</span> step) <span class="op">*</span> new_step : (i <span class="op">//</span> step) <span class="op">*</span> new_step <span class="op">+</span> new_step,</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>                    (j <span class="op">//</span> step) <span class="op">*</span> new_step : (j <span class="op">//</span> step) <span class="op">*</span> new_step <span class="op">+</span> new_step,</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>                ] <span class="op">=</span> new_square</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>        array <span class="op">=</span> new_array</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span> <span class="op">*</span> array).<span class="bu">sum</span>()</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>solve(array, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-20" class="level2">
<h2 class="anchored" data-anchor-id="part-2-20">Part 2</h2>
<div class="cell" data-execution_count="44">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>solve(array, <span class="dv">18</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-22-sporifica-virus" class="level1">
<h1><a href="https://adventofcode.com/2017/day/22">Day 22: Sporifica Virus</a></h1>
<section id="part-1-21" class="level2">
<h2 class="anchored" data-anchor-id="part-1-21">Part 1</h2>
<div class="cell" data-execution_count="45">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> <span class="ot">1j</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">if</span> char <span class="op">==</span> <span class="st">"."</span> <span class="cf">else</span> <span class="dv">1</span> <span class="cf">for</span> char <span class="kw">in</span> line] <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">22</span>)]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> size <span class="op">//</span> <span class="dv">2</span> <span class="op">+</span> (size <span class="op">//</span> <span class="dv">2</span>) <span class="op">*</span> <span class="ot">1j</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>board <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> y, line <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x, val <span class="kw">in</span> <span class="bu">enumerate</span>(line):</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        board[x <span class="op">+</span> (size <span class="op">-</span> y <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="ot">1j</span>] <span class="op">=</span> val</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>):</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> board[position]</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    total <span class="op">+=</span> state <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">*=</span> (<span class="dv">1</span> <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> state) <span class="op">*</span> <span class="ot">1j</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    board[position] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> state</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    position <span class="op">+=</span> direction</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-21" class="level2">
<h2 class="anchored" data-anchor-id="part-2-21">Part 2</h2>
<p>The large number of iterations for part 2 seems to indicate that I should do something more clever here. But the following runs in about 20s on my machine, so nevermind.</p>
<div class="cell" data-execution_count="46">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> <span class="ot">1j</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [[<span class="ot">1j</span> <span class="cf">if</span> char <span class="op">==</span> <span class="st">"."</span> <span class="cf">else</span> <span class="op">-</span><span class="ot">1j</span> <span class="cf">for</span> char <span class="kw">in</span> line] <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">22</span>)]</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> size <span class="op">//</span> <span class="dv">2</span> <span class="op">+</span> (size <span class="op">//</span> <span class="dv">2</span>) <span class="op">*</span> <span class="ot">1j</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>board <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="ot">1j</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> y, line <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x, val <span class="kw">in</span> <span class="bu">enumerate</span>(line):</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>        board[x <span class="op">+</span> (size <span class="op">-</span> y <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="ot">1j</span>] <span class="op">=</span> val</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000000</span>):</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> board[position]</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    total <span class="op">+=</span> state <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">*=</span> state</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    board[position] <span class="op">=</span> <span class="op">-</span>state <span class="op">*</span> <span class="ot">1j</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    position <span class="op">+=</span> direction</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-23-coprocessor-conflagration" class="level1">
<h1><a href="https://adventofcode.com/2017/day/23">Day 23: Coprocessor Conflagration</a></h1>
<section id="part-1-22" class="level2">
<h2 class="anchored" data-anchor-id="part-1-22">Part 1</h2>
<div class="cell" data-execution_count="47">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>program <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">23</span>)]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> {x: <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="st">"abcdefgh"</span>}</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>binops <span class="op">=</span> {<span class="st">"set"</span>: <span class="kw">lambda</span> x, y: y, <span class="st">"mul"</span>: <span class="kw">lambda</span> x, y: x <span class="op">*</span> y, <span class="st">"sub"</span>: <span class="kw">lambda</span> x, y: x <span class="op">-</span> y}</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="dv">0</span> <span class="op">&lt;=</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(program):</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    instruction <span class="op">=</span> program[ip]</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    instruction, register, argument <span class="op">=</span> instruction[<span class="dv">0</span>], instruction[<span class="dv">1</span>], instruction[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    argument <span class="op">=</span> registers[argument] <span class="cf">if</span> argument <span class="kw">in</span> registers <span class="cf">else</span> <span class="bu">int</span>(argument)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> instruction <span class="kw">in</span> binops:</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> instruction <span class="op">==</span> <span class="st">"mul"</span>:</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>            count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>        op <span class="op">=</span> binops[instruction]</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        registers[register] <span class="op">=</span> op(registers[register], argument)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"jnz"</span>:</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>        operand <span class="op">=</span> registers[register] <span class="cf">if</span> register <span class="kw">in</span> registers <span class="cf">else</span> <span class="bu">int</span>(register)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> operand <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>            ip <span class="op">+=</span> argument <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-22" class="level2">
<h2 class="anchored" data-anchor-id="part-2-22">Part 2</h2>
<p>The instructions warn you that trying to run part 2 as-is is a futile endeavour. And indeed, that is the case. Looking at the script there’s a very clear setup section to start with, where variables are set to values; these lines can never be reached again. After that there’s a huge loop which covers the rest of the program, and which basically says</p>
<div class="cell" data-execution_count="48">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> b <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    b <span class="op">+=</span> <span class="dv">17</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Inside this huge loop, we find a section at the start with two nested loops, followed by a tiny bit of cleanup. The two nested loops only involve the d and e variables, and they have the effect of setting f to zero if ever d * e = b, and doing basically nothing else. In the cleanup after the loop, 1 is added to h if f is zero. So that means that whenever b is composite, h increases by 1. So the script is equivalent to:</p>
<div class="cell" data-execution_count="49">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_composite(n):</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="bu">int</span>(n<span class="op">**</span><span class="fl">0.5</span>) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="op">%</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>b0 <span class="op">=</span> <span class="dv">5700</span> <span class="op">+</span> <span class="dv">100_000</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(<span class="bu">list</span>(<span class="bu">filter</span>(is_composite, <span class="bu">range</span>(b0, b0 <span class="op">+</span> <span class="dv">17000</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">17</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-24-electromagnetic-moat" class="level1">
<h1><a href="https://adventofcode.com/2017/day/24">Day 24: Electromagnetic Moat</a></h1>
<section id="part-1-23" class="level2">
<h2 class="anchored" data-anchor-id="part-1-23">Part 1</h2>
<div class="cell" data-execution_count="50">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ports <span class="op">=</span> load(<span class="dv">24</span>, <span class="st">"int"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>ports <span class="op">=</span> <span class="bu">set</span>(<span class="bu">map</span>(<span class="bu">tuple</span>, ports))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> strongest_bridge(current, components, part<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    strength <span class="op">=</span> current <span class="cf">if</span> part <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> current[<span class="dv">1</span>]</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    bridges <span class="op">=</span> []</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> candidate <span class="kw">in</span> [x <span class="cf">for</span> x <span class="kw">in</span> components <span class="cf">if</span> strength <span class="kw">in</span> x]:</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> candidate[<span class="dv">0</span>] <span class="cf">if</span> candidate[<span class="dv">1</span>] <span class="op">==</span> strength <span class="cf">else</span> candidate[<span class="dv">1</span>]</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>        new_components <span class="op">=</span> components <span class="op">-</span> <span class="bu">set</span>([candidate])</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>        new_state <span class="op">=</span> value <span class="cf">if</span> part <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> (current[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, value)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>        bridges.append(strongest_bridge(new_state, new_components, part<span class="op">=</span>part))</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bridges:</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>        best_bridge <span class="op">=</span> <span class="bu">max</span>(bridges)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span> <span class="op">*</span> current <span class="op">+</span> best_bridge</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> part <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> (best_bridge[<span class="dv">0</span>], <span class="dv">2</span> <span class="op">*</span> strength <span class="op">+</span> best_bridge[<span class="dv">1</span>])</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> current</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>strongest_bridge(<span class="dv">0</span>, ports)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="part-2-23" class="level2">
<h2 class="anchored" data-anchor-id="part-2-23">Part 2</h2>
<p>Enumerating all the bridges for part 2 is basically the same as in part 1, so I’ve incuded the code there with a flag. The only difference is how the bridges are scored - here length takes priority. We can still use the <code>max</code> function because tuples sort lexicographically. The solution then becomes</p>
<div class="cell" data-execution_count="51">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>strongest_bridge((<span class="dv">0</span>, <span class="dv">0</span>), ports, part<span class="op">=</span><span class="dv">2</span>)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="day-25-the-halting-problem" class="level1">
<h1><a href="https://adventofcode.com/2017/day/25">Day 25: The Halting Problem</a></h1>
<p>A pretty mindless translation of the requirements into code. Parsing the data was almost the fiddliest part</p>
<div class="cell" data-execution_count="52">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">25</span>, <span class="st">"raw"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>header, <span class="op">*</span>rows <span class="op">=</span> data.split(<span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>row <span class="op">=</span> rows[<span class="dv">0</span>]</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>rules <span class="op">=</span> {}</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>directions <span class="op">=</span> {<span class="st">"right"</span>: <span class="dv">1</span>, <span class="st">"left"</span>: <span class="op">-</span><span class="dv">1</span>}</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> rows:</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    state, <span class="op">*</span>parameters <span class="op">=</span> [x[:<span class="op">-</span><span class="dv">1</span>].split()[<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> x <span class="kw">in</span> row.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>) <span class="cf">if</span> x]</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    rules[state] <span class="op">=</span> (</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>        (<span class="bu">int</span>(parameters[<span class="dv">1</span>]), directions[parameters[<span class="dv">2</span>]], parameters[<span class="dv">3</span>]),</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>        (<span class="bu">int</span>(parameters[<span class="dv">5</span>]), directions[parameters[<span class="dv">6</span>]], parameters[<span class="dv">7</span>]),</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>tape <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>current_state, n_steps <span class="op">=</span> header.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>current_state <span class="op">=</span> current_state[<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>n_steps <span class="op">=</span> <span class="bu">int</span>(n_steps.split()[<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps):</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    value, direction, current_state <span class="op">=</span> rules[current_state][tape[ip]]</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    tape[ip] <span class="op">=</span> value</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">+=</span> direction</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(tape.values())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb53" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> 2017 Solutions</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Imports</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> collections</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> functools</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> more_itertools</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>sys.path.insert(<span class="dv">1</span>, os.path.join(sys.path[<span class="dv">0</span>], <span class="st">".."</span>))</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> utils</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>load <span class="op">=</span> utils.year_load(<span class="dv">2017</span>)</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 1: Inverse Captcha](https://adventofcode.com/2017/day/1)</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">1</span>)[<span class="dv">0</span>]], dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>data[np.where(data <span class="op">==</span> np.roll(data, <span class="dv">1</span>))].<span class="bu">sum</span>()</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>data[np.where(data <span class="op">==</span> np.roll(data, <span class="bu">len</span>(data) <span class="op">//</span> <span class="dv">2</span>))].<span class="bu">sum</span>()</span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 2: Corruption Checksum](https://adventofcode.com/2017/day/2)</span></span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="bu">sorted</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(x), x.split())) <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">2</span>)]</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(a[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> a[<span class="dv">0</span>] <span class="cf">for</span> a <span class="kw">in</span> data)</span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> data:</span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, value <span class="kw">in</span> <span class="bu">enumerate</span>(line):</span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(idx <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(line)):</span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> line[j] <span class="op">//</span> value <span class="cf">if</span> line[j] <span class="op">%</span> value <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a>total</span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 3: Spiral Memory](https://adventofcode.com/2017/day/3)</span></span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a>puzzle_input <span class="op">=</span> <span class="dv">368078</span></span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a>completed_squares <span class="op">=</span> (<span class="bu">int</span>(np.sqrt(puzzle_input) <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> <span class="dv">2</span> <span class="op">*</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a>remainder <span class="op">=</span> (puzzle_input <span class="op">-</span> completed_squares<span class="op">**</span><span class="dv">2</span>) <span class="op">%</span> (completed_squares <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>(completed_squares <span class="op">//</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="bu">abs</span>((completed_squares <span class="op">//</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> remainder)</span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a>coord, current_side, side_length, remainder <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a>spiral <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a>spiral[coord] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb53-93"><a href="#cb53-93" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> remainder <span class="op">==</span> side_length:</span>
<span id="cb53-96"><a href="#cb53-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_side <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb53-97"><a href="#cb53-97" aria-hidden="true" tabindex="-1"></a>            coord <span class="op">=</span> coord <span class="op">+</span> direction <span class="op">-</span> <span class="ot">1j</span> <span class="op">*</span> direction</span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a>            side_length <span class="op">+=</span> <span class="dv">2</span></span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a>        direction <span class="op">=</span> <span class="ot">1j</span> <span class="op">*</span> direction</span>
<span id="cb53-100"><a href="#cb53-100" aria-hidden="true" tabindex="-1"></a>        coord <span class="op">=</span> coord <span class="op">+</span> direction</span>
<span id="cb53-101"><a href="#cb53-101" aria-hidden="true" tabindex="-1"></a>        current_side <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a>        remainder <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a>        coord <span class="op">=</span> coord <span class="op">+</span> direction</span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a>        remainder <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x, y <span class="kw">in</span> itertools.product([<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="ot">1j</span>, <span class="dv">0</span>, <span class="ot">1j</span>]):</span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> x <span class="kw">and</span> <span class="kw">not</span> y:</span>
<span id="cb53-109"><a href="#cb53-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb53-110"><a href="#cb53-110" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> coord <span class="op">+</span> x <span class="op">+</span> y</span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a>        tmp <span class="op">+=</span> spiral[target]</span>
<span id="cb53-112"><a href="#cb53-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tmp <span class="op">&gt;</span> puzzle_input:</span>
<span id="cb53-113"><a href="#cb53-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb53-114"><a href="#cb53-114" aria-hidden="true" tabindex="-1"></a>    spiral[coord] <span class="op">=</span> tmp</span>
<span id="cb53-115"><a href="#cb53-115" aria-hidden="true" tabindex="-1"></a>tmp</span>
<span id="cb53-116"><a href="#cb53-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-117"><a href="#cb53-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-118"><a href="#cb53-118" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 4: High-Entropy Passphrases](https://adventofcode.com/2017/day/4)</span></span>
<span id="cb53-119"><a href="#cb53-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-120"><a href="#cb53-120" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-121"><a href="#cb53-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-124"><a href="#cb53-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-125"><a href="#cb53-125" aria-hidden="true" tabindex="-1"></a>lines <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">4</span>)]</span>
<span id="cb53-126"><a href="#cb53-126" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">len</span>(l) <span class="op">==</span> <span class="bu">len</span>(<span class="bu">set</span>(l)) <span class="cf">for</span> l <span class="kw">in</span> lines)</span>
<span id="cb53-127"><a href="#cb53-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-128"><a href="#cb53-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-129"><a href="#cb53-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb53-130"><a href="#cb53-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-133"><a href="#cb53-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-134"><a href="#cb53-134" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">len</span>(l) <span class="op">==</span> <span class="bu">len</span>(<span class="bu">set</span>([<span class="st">""</span>.join(<span class="bu">sorted</span>(w)) <span class="cf">for</span> w <span class="kw">in</span> l])) <span class="cf">for</span> l <span class="kw">in</span> lines)</span>
<span id="cb53-135"><a href="#cb53-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-136"><a href="#cb53-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-137"><a href="#cb53-137" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 5: A Maze of Twisty Trampolines, All Alike](https://adventofcode.com/2017/day/5)</span></span>
<span id="cb53-138"><a href="#cb53-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-139"><a href="#cb53-139" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-140"><a href="#cb53-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-143"><a href="#cb53-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-144"><a href="#cb53-144" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> load(<span class="dv">5</span>, <span class="st">"np"</span>)</span>
<span id="cb53-145"><a href="#cb53-145" aria-hidden="true" tabindex="-1"></a>ip, count <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb53-146"><a href="#cb53-146" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> ip <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(instructions):</span>
<span id="cb53-147"><a href="#cb53-147" aria-hidden="true" tabindex="-1"></a>    instructions[ip] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-148"><a href="#cb53-148" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">+=</span> instructions[ip] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb53-149"><a href="#cb53-149" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-150"><a href="#cb53-150" aria-hidden="true" tabindex="-1"></a>count</span>
<span id="cb53-151"><a href="#cb53-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-152"><a href="#cb53-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-153"><a href="#cb53-153" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb53-154"><a href="#cb53-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-157"><a href="#cb53-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-158"><a href="#cb53-158" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> load(<span class="dv">5</span>, <span class="st">"np"</span>)</span>
<span id="cb53-159"><a href="#cb53-159" aria-hidden="true" tabindex="-1"></a>ip, count <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb53-160"><a href="#cb53-160" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> ip <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(instructions):</span>
<span id="cb53-161"><a href="#cb53-161" aria-hidden="true" tabindex="-1"></a>    instruction <span class="op">=</span> instructions[ip]</span>
<span id="cb53-162"><a href="#cb53-162" aria-hidden="true" tabindex="-1"></a>    instructions[ip] <span class="op">+=</span> <span class="dv">1</span> <span class="cf">if</span> instruction <span class="op">&lt;</span> <span class="dv">3</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb53-163"><a href="#cb53-163" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">+=</span> instruction</span>
<span id="cb53-164"><a href="#cb53-164" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-165"><a href="#cb53-165" aria-hidden="true" tabindex="-1"></a>count</span>
<span id="cb53-166"><a href="#cb53-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-167"><a href="#cb53-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-168"><a href="#cb53-168" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 6: Memory Reallocation](https://adventofcode.com/2017/day/6)</span></span>
<span id="cb53-169"><a href="#cb53-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-170"><a href="#cb53-170" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-171"><a href="#cb53-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-174"><a href="#cb53-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-175"><a href="#cb53-175" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">4</span>, <span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">11</span>])</span>
<span id="cb53-176"><a href="#cb53-176" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb53-177"><a href="#cb53-177" aria-hidden="true" tabindex="-1"></a>seen <span class="op">=</span> {}</span>
<span id="cb53-178"><a href="#cb53-178" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-179"><a href="#cb53-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-180"><a href="#cb53-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-181"><a href="#cb53-181" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> step(data):</span>
<span id="cb53-182"><a href="#cb53-182" aria-hidden="true" tabindex="-1"></a>    idx, maxval <span class="op">=</span> data.argmax(), data.<span class="bu">max</span>()</span>
<span id="cb53-183"><a href="#cb53-183" aria-hidden="true" tabindex="-1"></a>    data[idx] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-184"><a href="#cb53-184" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> np.ones(<span class="bu">len</span>(data), dtype<span class="op">=</span><span class="bu">int</span>) <span class="op">*</span> (maxval <span class="op">//</span> l)</span>
<span id="cb53-185"><a href="#cb53-185" aria-hidden="true" tabindex="-1"></a>    delta[: maxval <span class="op">%</span> l] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-186"><a href="#cb53-186" aria-hidden="true" tabindex="-1"></a>    data <span class="op">+=</span> np.roll(delta, idx <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb53-187"><a href="#cb53-187" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb53-188"><a href="#cb53-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-189"><a href="#cb53-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-190"><a href="#cb53-190" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">tuple</span>(data) <span class="kw">not</span> <span class="kw">in</span> seen:</span>
<span id="cb53-191"><a href="#cb53-191" aria-hidden="true" tabindex="-1"></a>    seen[<span class="bu">tuple</span>(data)] <span class="op">=</span> i</span>
<span id="cb53-192"><a href="#cb53-192" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> step(data)</span>
<span id="cb53-193"><a href="#cb53-193" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-194"><a href="#cb53-194" aria-hidden="true" tabindex="-1"></a>i</span>
<span id="cb53-195"><a href="#cb53-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-196"><a href="#cb53-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-197"><a href="#cb53-197" aria-hidden="true" tabindex="-1"></a>I was getting the wrong answer for this for the longest time until I realised I'd left off a "0" at the start of my input when I copied it over.</span>
<span id="cb53-198"><a href="#cb53-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-199"><a href="#cb53-199" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb53-200"><a href="#cb53-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-201"><a href="#cb53-201" aria-hidden="true" tabindex="-1"></a>This was made trivial by tracking when a given configuration was seen.</span>
<span id="cb53-202"><a href="#cb53-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-205"><a href="#cb53-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-206"><a href="#cb53-206" aria-hidden="true" tabindex="-1"></a>i <span class="op">-</span> seen[(<span class="bu">tuple</span>(data))]</span>
<span id="cb53-207"><a href="#cb53-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-208"><a href="#cb53-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-209"><a href="#cb53-209" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 7: Recursive Circus](https://adventofcode.com/2017/day/7)</span></span>
<span id="cb53-210"><a href="#cb53-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-211"><a href="#cb53-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-212"><a href="#cb53-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-215"><a href="#cb53-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-216"><a href="#cb53-216" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> {}</span>
<span id="cb53-217"><a href="#cb53-217" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">7</span>):</span>
<span id="cb53-218"><a href="#cb53-218" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> line.split(<span class="st">" "</span>)[<span class="dv">0</span>]</span>
<span id="cb53-219"><a href="#cb53-219" aria-hidden="true" tabindex="-1"></a>    children <span class="op">=</span> line.split(<span class="st">" -&gt; "</span>)[<span class="dv">1</span>].split(<span class="st">", "</span>) <span class="cf">if</span> <span class="st">" -&gt; "</span> <span class="kw">in</span> line <span class="cf">else</span> []</span>
<span id="cb53-220"><a href="#cb53-220" aria-hidden="true" tabindex="-1"></a>    weight <span class="op">=</span> <span class="bu">int</span>(re.findall(<span class="st">"\d+"</span>, line)[<span class="dv">0</span>])</span>
<span id="cb53-221"><a href="#cb53-221" aria-hidden="true" tabindex="-1"></a>    tree[name] <span class="op">=</span> {<span class="st">"weight"</span>: weight, <span class="st">"children"</span>: children}</span>
<span id="cb53-222"><a href="#cb53-222" aria-hidden="true" tabindex="-1"></a>parents <span class="op">=</span> {}</span>
<span id="cb53-223"><a href="#cb53-223" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node <span class="kw">in</span> tree:</span>
<span id="cb53-224"><a href="#cb53-224" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> tree[node][<span class="st">"children"</span>]:</span>
<span id="cb53-225"><a href="#cb53-225" aria-hidden="true" tabindex="-1"></a>        parents[child] <span class="op">=</span> node</span>
<span id="cb53-226"><a href="#cb53-226" aria-hidden="true" tabindex="-1"></a>node <span class="op">=</span> (<span class="bu">set</span>(tree.keys()) <span class="op">-</span> <span class="bu">set</span>(parents.keys())).pop()</span>
<span id="cb53-227"><a href="#cb53-227" aria-hidden="true" tabindex="-1"></a>node</span>
<span id="cb53-228"><a href="#cb53-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-229"><a href="#cb53-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-230"><a href="#cb53-230" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb53-231"><a href="#cb53-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-234"><a href="#cb53-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-235"><a href="#cb53-235" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> weight(node):</span>
<span id="cb53-236"><a href="#cb53-236" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree[node][<span class="st">"weight"</span>] <span class="op">+</span> <span class="bu">sum</span>(<span class="bu">map</span>(weight, tree[node][<span class="st">"children"</span>]))</span>
<span id="cb53-237"><a href="#cb53-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-238"><a href="#cb53-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-239"><a href="#cb53-239" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_balanced(node):</span>
<span id="cb53-240"><a href="#cb53-240" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb53-241"><a href="#cb53-241" aria-hidden="true" tabindex="-1"></a>        <span class="kw">not</span> tree[node][<span class="st">"children"</span>] <span class="kw">or</span> <span class="bu">len</span>(<span class="bu">set</span>(<span class="bu">map</span>(weight, tree[node][<span class="st">"children"</span>]))) <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb53-242"><a href="#cb53-242" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-243"><a href="#cb53-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-244"><a href="#cb53-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-245"><a href="#cb53-245" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="kw">not</span> is_balanced(node):</span>
<span id="cb53-246"><a href="#cb53-246" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> [weight(x) <span class="cf">for</span> x <span class="kw">in</span> tree[node][<span class="st">"children"</span>]]</span>
<span id="cb53-247"><a href="#cb53-247" aria-hidden="true" tabindex="-1"></a>    counts <span class="op">=</span> collections.Counter(weights)</span>
<span id="cb53-248"><a href="#cb53-248" aria-hidden="true" tabindex="-1"></a>    wrong_weight <span class="op">=</span> <span class="bu">min</span>(counts, key<span class="op">=</span>counts.get)</span>
<span id="cb53-249"><a href="#cb53-249" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> tree[node][<span class="st">"children"</span>][weights.index(wrong_weight)]</span>
<span id="cb53-250"><a href="#cb53-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-251"><a href="#cb53-251" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="bu">max</span>(counts, key<span class="op">=</span>counts.get) <span class="op">-</span> wrong_weight</span>
<span id="cb53-252"><a href="#cb53-252" aria-hidden="true" tabindex="-1"></a>tree[node][<span class="st">"weight"</span>] <span class="op">+</span> delta</span>
<span id="cb53-253"><a href="#cb53-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-254"><a href="#cb53-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-255"><a href="#cb53-255" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 8: I Heard You Like Registers](https://adventofcode.com/2017/day/8)</span></span>
<span id="cb53-256"><a href="#cb53-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-257"><a href="#cb53-257" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-258"><a href="#cb53-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-261"><a href="#cb53-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-262"><a href="#cb53-262" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> operator <span class="im">as</span> op</span>
<span id="cb53-263"><a href="#cb53-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-264"><a href="#cb53-264" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb53-265"><a href="#cb53-265" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">8</span>)]</span>
<span id="cb53-266"><a href="#cb53-266" aria-hidden="true" tabindex="-1"></a>ops <span class="op">=</span> {<span class="st">"&lt;"</span>: op.lt, <span class="st">"&lt;="</span>: op.le, <span class="st">"=="</span>: op.eq, <span class="st">"&gt;="</span>: op.ge, <span class="st">"&gt;"</span>: op.gt, <span class="st">"!="</span>: op.ne}</span>
<span id="cb53-267"><a href="#cb53-267" aria-hidden="true" tabindex="-1"></a>signs <span class="op">=</span> {<span class="st">"dec"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"inc"</span>: <span class="dv">1</span>}</span>
<span id="cb53-268"><a href="#cb53-268" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> target, sign, inc_amount, _, comparator, comparison, cmp_value <span class="kw">in</span> instructions:</span>
<span id="cb53-269"><a href="#cb53-269" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ops[comparison](registers[comparator], <span class="bu">int</span>(cmp_value)):</span>
<span id="cb53-270"><a href="#cb53-270" aria-hidden="true" tabindex="-1"></a>        registers[target] <span class="op">+=</span> signs[sign] <span class="op">*</span> <span class="bu">int</span>(inc_amount)</span>
<span id="cb53-271"><a href="#cb53-271" aria-hidden="true" tabindex="-1"></a><span class="bu">max</span>(registers.values())</span>
<span id="cb53-272"><a href="#cb53-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-273"><a href="#cb53-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-274"><a href="#cb53-274" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb53-275"><a href="#cb53-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-278"><a href="#cb53-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-279"><a href="#cb53-279" aria-hidden="true" tabindex="-1"></a>maxval <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-280"><a href="#cb53-280" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb53-281"><a href="#cb53-281" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> target, sign, inc_amount, _, comparator, comparison, cmp_value <span class="kw">in</span> instructions:</span>
<span id="cb53-282"><a href="#cb53-282" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ops[comparison](registers[comparator], <span class="bu">int</span>(cmp_value)):</span>
<span id="cb53-283"><a href="#cb53-283" aria-hidden="true" tabindex="-1"></a>        registers[target] <span class="op">+=</span> signs[sign] <span class="op">*</span> <span class="bu">int</span>(inc_amount)</span>
<span id="cb53-284"><a href="#cb53-284" aria-hidden="true" tabindex="-1"></a>    current_max <span class="op">=</span> <span class="bu">max</span>(registers.values())</span>
<span id="cb53-285"><a href="#cb53-285" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_max <span class="op">&gt;</span> maxval:</span>
<span id="cb53-286"><a href="#cb53-286" aria-hidden="true" tabindex="-1"></a>        maxval <span class="op">=</span> current_max</span>
<span id="cb53-287"><a href="#cb53-287" aria-hidden="true" tabindex="-1"></a>maxval</span>
<span id="cb53-288"><a href="#cb53-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-289"><a href="#cb53-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-290"><a href="#cb53-290" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 9: Stream Processing](https://adventofcode.com/2017/day/9)</span></span>
<span id="cb53-291"><a href="#cb53-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-292"><a href="#cb53-292" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-293"><a href="#cb53-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-296"><a href="#cb53-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-297"><a href="#cb53-297" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> canonical_form(sequence):</span>
<span id="cb53-298"><a href="#cb53-298" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-299"><a href="#cb53-299" aria-hidden="true" tabindex="-1"></a>    replacements <span class="op">=</span> {<span class="st">"{"</span>: <span class="st">"["</span>, <span class="st">","</span>: <span class="st">","</span>, <span class="st">"}"</span>: <span class="st">"]"</span>}</span>
<span id="cb53-300"><a href="#cb53-300" aria-hidden="true" tabindex="-1"></a>    mode <span class="op">=</span> <span class="st">"group"</span></span>
<span id="cb53-301"><a href="#cb53-301" aria-hidden="true" tabindex="-1"></a>    skip <span class="op">=</span> <span class="va">False</span></span>
<span id="cb53-302"><a href="#cb53-302" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="st">""</span></span>
<span id="cb53-303"><a href="#cb53-303" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char <span class="kw">in</span> sequence:</span>
<span id="cb53-304"><a href="#cb53-304" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> skip:</span>
<span id="cb53-305"><a href="#cb53-305" aria-hidden="true" tabindex="-1"></a>            skip <span class="op">=</span> <span class="va">False</span></span>
<span id="cb53-306"><a href="#cb53-306" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> char <span class="op">==</span> <span class="st">"!"</span>:</span>
<span id="cb53-307"><a href="#cb53-307" aria-hidden="true" tabindex="-1"></a>            skip <span class="op">=</span> <span class="va">True</span></span>
<span id="cb53-308"><a href="#cb53-308" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">"group"</span> <span class="kw">and</span> char <span class="op">==</span> <span class="st">"&lt;"</span>:</span>
<span id="cb53-309"><a href="#cb53-309" aria-hidden="true" tabindex="-1"></a>            mode <span class="op">=</span> <span class="st">"garbage"</span></span>
<span id="cb53-310"><a href="#cb53-310" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">"garbage"</span> <span class="kw">and</span> char <span class="op">==</span> <span class="st">"&gt;"</span>:</span>
<span id="cb53-311"><a href="#cb53-311" aria-hidden="true" tabindex="-1"></a>            mode <span class="op">=</span> <span class="st">"group"</span></span>
<span id="cb53-312"><a href="#cb53-312" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">"garbage"</span>:</span>
<span id="cb53-313"><a href="#cb53-313" aria-hidden="true" tabindex="-1"></a>            count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-314"><a href="#cb53-314" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">"group"</span>:</span>
<span id="cb53-315"><a href="#cb53-315" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">==</span> <span class="st">"}"</span>:</span>
<span id="cb53-316"><a href="#cb53-316" aria-hidden="true" tabindex="-1"></a>                result <span class="op">+=</span> replacements[char]</span>
<span id="cb53-317"><a href="#cb53-317" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">==</span> <span class="st">"{"</span>:</span>
<span id="cb53-318"><a href="#cb53-318" aria-hidden="true" tabindex="-1"></a>                result <span class="op">+=</span> replacements[char]</span>
<span id="cb53-319"><a href="#cb53-319" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result, count</span>
<span id="cb53-320"><a href="#cb53-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-321"><a href="#cb53-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-322"><a href="#cb53-322" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">9</span>)[<span class="dv">0</span>]</span>
<span id="cb53-323"><a href="#cb53-323" aria-hidden="true" tabindex="-1"></a>data, count <span class="op">=</span> canonical_form(data)</span>
<span id="cb53-324"><a href="#cb53-324" aria-hidden="true" tabindex="-1"></a>total, counter <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb53-325"><a href="#cb53-325" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> char <span class="kw">in</span> data:</span>
<span id="cb53-326"><a href="#cb53-326" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> char <span class="op">==</span> <span class="st">"["</span>:</span>
<span id="cb53-327"><a href="#cb53-327" aria-hidden="true" tabindex="-1"></a>        counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-328"><a href="#cb53-328" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-329"><a href="#cb53-329" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> counter</span>
<span id="cb53-330"><a href="#cb53-330" aria-hidden="true" tabindex="-1"></a>        counter <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb53-331"><a href="#cb53-331" aria-hidden="true" tabindex="-1"></a>total</span>
<span id="cb53-332"><a href="#cb53-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-333"><a href="#cb53-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-334"><a href="#cb53-334" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb53-335"><a href="#cb53-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-338"><a href="#cb53-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-339"><a href="#cb53-339" aria-hidden="true" tabindex="-1"></a>count</span>
<span id="cb53-340"><a href="#cb53-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-341"><a href="#cb53-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-342"><a href="#cb53-342" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 10: Knot Hash](https://adventofcode.com/2017/day/10)</span></span>
<span id="cb53-343"><a href="#cb53-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-344"><a href="#cb53-344" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-345"><a href="#cb53-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-348"><a href="#cb53-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-349"><a href="#cb53-349" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="st">"165,1,255,31,87,52,24,113,0,91,148,254,158,2,73,153"</span></span>
<span id="cb53-350"><a href="#cb53-350" aria-hidden="true" tabindex="-1"></a>lengths <span class="op">=</span> [<span class="bu">int</span>(length) <span class="cf">for</span> length <span class="kw">in</span> data.split(<span class="st">","</span>)]</span>
<span id="cb53-351"><a href="#cb53-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-352"><a href="#cb53-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-353"><a href="#cb53-353" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knot_hash1(lengths):</span>
<span id="cb53-354"><a href="#cb53-354" aria-hidden="true" tabindex="-1"></a>    knots <span class="op">=</span> collections.deque(<span class="bu">range</span>(<span class="dv">256</span>))</span>
<span id="cb53-355"><a href="#cb53-355" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-356"><a href="#cb53-356" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, length <span class="kw">in</span> <span class="bu">enumerate</span>(lengths):</span>
<span id="cb53-357"><a href="#cb53-357" aria-hidden="true" tabindex="-1"></a>        new <span class="op">=</span> collections.deque([knots.popleft() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(length)])</span>
<span id="cb53-358"><a href="#cb53-358" aria-hidden="true" tabindex="-1"></a>        new.reverse()</span>
<span id="cb53-359"><a href="#cb53-359" aria-hidden="true" tabindex="-1"></a>        knots <span class="op">=</span> knots <span class="op">+</span> new</span>
<span id="cb53-360"><a href="#cb53-360" aria-hidden="true" tabindex="-1"></a>        knots.rotate(<span class="op">-</span>idx)</span>
<span id="cb53-361"><a href="#cb53-361" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> length <span class="op">+</span> idx</span>
<span id="cb53-362"><a href="#cb53-362" aria-hidden="true" tabindex="-1"></a>    knots.rotate(total)</span>
<span id="cb53-363"><a href="#cb53-363" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> knots</span>
<span id="cb53-364"><a href="#cb53-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-365"><a href="#cb53-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-366"><a href="#cb53-366" aria-hidden="true" tabindex="-1"></a>knots <span class="op">=</span> knot_hash1(lengths)</span>
<span id="cb53-367"><a href="#cb53-367" aria-hidden="true" tabindex="-1"></a>knots.popleft() <span class="op">*</span> knots.popleft()</span>
<span id="cb53-368"><a href="#cb53-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-369"><a href="#cb53-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-370"><a href="#cb53-370" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb53-371"><a href="#cb53-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-374"><a href="#cb53-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-375"><a href="#cb53-375" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knot_hash64(s):</span>
<span id="cb53-376"><a href="#cb53-376" aria-hidden="true" tabindex="-1"></a>    numbers <span class="op">=</span> [<span class="bu">ord</span>(x) <span class="cf">for</span> x <span class="kw">in</span> s] <span class="op">+</span> [<span class="dv">17</span>, <span class="dv">31</span>, <span class="dv">73</span>, <span class="dv">47</span>, <span class="dv">23</span>]</span>
<span id="cb53-377"><a href="#cb53-377" aria-hidden="true" tabindex="-1"></a>    lengths <span class="op">=</span> itertools.chain.from_iterable(itertools.repeat(numbers, <span class="dv">64</span>))</span>
<span id="cb53-378"><a href="#cb53-378" aria-hidden="true" tabindex="-1"></a>    knots <span class="op">=</span> <span class="bu">list</span>(knot_hash1(lengths))</span>
<span id="cb53-379"><a href="#cb53-379" aria-hidden="true" tabindex="-1"></a>    digits <span class="op">=</span> [</span>
<span id="cb53-380"><a href="#cb53-380" aria-hidden="true" tabindex="-1"></a>        functools.<span class="bu">reduce</span>(<span class="kw">lambda</span> x, y: x <span class="op">^</span> y, knots[<span class="dv">16</span> <span class="op">*</span> i : <span class="dv">16</span> <span class="op">*</span> (i <span class="op">+</span> <span class="dv">1</span>)])</span>
<span id="cb53-381"><a href="#cb53-381" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">16</span>)</span>
<span id="cb53-382"><a href="#cb53-382" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb53-383"><a href="#cb53-383" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join([<span class="st">"</span><span class="sc">{:0&gt;2x}</span><span class="st">"</span>.<span class="bu">format</span>(x) <span class="cf">for</span> x <span class="kw">in</span> digits])</span>
<span id="cb53-384"><a href="#cb53-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-385"><a href="#cb53-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-386"><a href="#cb53-386" aria-hidden="true" tabindex="-1"></a>knot_hash64(data)</span>
<span id="cb53-387"><a href="#cb53-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-388"><a href="#cb53-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-389"><a href="#cb53-389" aria-hidden="true" tabindex="-1"></a><span class="fu"># [Day 11: Hex Ed](https://adventofcode.com/2017/day/11)</span></span>
<span id="cb53-390"><a href="#cb53-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-391"><a href="#cb53-391" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb53-392"><a href="#cb53-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-393"><a href="#cb53-393" aria-hidden="true" tabindex="-1"></a>To describe the hexgrid we'll use two basis vectors: x1, directed southeast, and x2, directed due north. All the other directions can be found as linear combinations of these, and the final position in this basis is just the sum of all the moves. Now, any move of the form (k, 1), with k in <span class="sc">\[</span>-1, 0, 1<span class="sc">\]</span> only takes one step, so the number of steps needed to reach the final position is just the value of whichever of the two basis vectors we have more of</span>
<span id="cb53-394"><a href="#cb53-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-397"><a href="#cb53-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-398"><a href="#cb53-398" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="bu">open</span>(load(<span class="dv">11</span>)[<span class="dv">0</span>].split(<span class="st">","</span>)</span>
<span id="cb53-399"><a href="#cb53-399" aria-hidden="true" tabindex="-1"></a>coordinates <span class="op">=</span> {<span class="st">"se"</span>: np.array((<span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb53-400"><a href="#cb53-400" aria-hidden="true" tabindex="-1"></a>               <span class="st">"s"</span>: np.array((<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>)),</span>
<span id="cb53-401"><a href="#cb53-401" aria-hidden="true" tabindex="-1"></a>               <span class="st">"sw"</span>: np.array((<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>)),</span>
<span id="cb53-402"><a href="#cb53-402" aria-hidden="true" tabindex="-1"></a>               <span class="st">"nw"</span>: np.array((<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb53-403"><a href="#cb53-403" aria-hidden="true" tabindex="-1"></a>               <span class="st">"n"</span>: np.array((<span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb53-404"><a href="#cb53-404" aria-hidden="true" tabindex="-1"></a>               <span class="st">"ne"</span>: np.array((<span class="dv">1</span>, <span class="dv">1</span>))}</span>
<span id="cb53-405"><a href="#cb53-405" aria-hidden="true" tabindex="-1"></a>moves <span class="op">=</span> np.array([coordinates[x] <span class="cf">for</span> x <span class="kw">in</span> data])</span>
<span id="cb53-406"><a href="#cb53-406" aria-hidden="true" tabindex="-1"></a><span class="bu">max</span>(<span class="bu">abs</span>(moves.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)))</span>
<span id="cb53-407"><a href="#cb53-407" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-408"><a href="#cb53-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-409"><a href="#cb53-409" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-410"><a href="#cb53-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-411"><a href="#cb53-411" aria-hidden="true" tabindex="-1"></a>For part <span class="dv">2</span>, instead of finding just the <span class="bu">sum</span> of the moves, we look at the running total, <span class="kw">and</span> ask what the greatest value of <span class="bu">any</span> of the coefficients <span class="kw">is</span> at <span class="bu">any</span> point <span class="kw">in</span> the path.</span>
<span id="cb53-412"><a href="#cb53-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-415"><a href="#cb53-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-416"><a href="#cb53-416" aria-hidden="true" tabindex="-1"></a><span class="bu">abs</span>(moves.cumsum(axis<span class="op">=</span><span class="dv">0</span>)).<span class="bu">max</span>()</span>
<span id="cb53-417"><a href="#cb53-417" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-418"><a href="#cb53-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-419"><a href="#cb53-419" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 12: Digital Plumber](https://adventofcode.com/2017/day/12)</span></span>
<span id="cb53-420"><a href="#cb53-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-421"><a href="#cb53-421" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-422"><a href="#cb53-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-425"><a href="#cb53-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-426"><a href="#cb53-426" aria-hidden="true" tabindex="-1"></a>regex <span class="op">=</span> <span class="st">"(-?\d+)"</span></span>
<span id="cb53-427"><a href="#cb53-427" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">12</span>, <span class="st">"int"</span>)</span>
<span id="cb53-428"><a href="#cb53-428" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> {line[<span class="dv">0</span>]: line[<span class="dv">1</span>:] <span class="cf">for</span> line <span class="kw">in</span> data}</span>
<span id="cb53-429"><a href="#cb53-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-430"><a href="#cb53-430" aria-hidden="true" tabindex="-1"></a>neighbors <span class="op">=</span> <span class="kw">lambda</span> state: graph[state]</span>
<span id="cb53-431"><a href="#cb53-431" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(utils.bfs(<span class="dv">0</span>, <span class="va">None</span>, neighbors, return_visited<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb53-432"><a href="#cb53-432" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-433"><a href="#cb53-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-434"><a href="#cb53-434" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-435"><a href="#cb53-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-438"><a href="#cb53-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-439"><a href="#cb53-439" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-440"><a href="#cb53-440" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> graph:</span>
<span id="cb53-441"><a href="#cb53-441" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> <span class="bu">list</span>(graph.keys())[<span class="dv">0</span>]</span>
<span id="cb53-442"><a href="#cb53-442" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> utils.bfs(seed, <span class="va">None</span>, neighbors, return_visited<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-443"><a href="#cb53-443" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key <span class="kw">in</span> visited:</span>
<span id="cb53-444"><a href="#cb53-444" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[key]</span>
<span id="cb53-445"><a href="#cb53-445" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-446"><a href="#cb53-446" aria-hidden="true" tabindex="-1"></a>i</span>
<span id="cb53-447"><a href="#cb53-447" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-448"><a href="#cb53-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-449"><a href="#cb53-449" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 13: Packet Scanners](https://adventofcode.com/2017/day/13)</span></span>
<span id="cb53-450"><a href="#cb53-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-451"><a href="#cb53-451" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-452"><a href="#cb53-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-453"><a href="#cb53-453" aria-hidden="true" tabindex="-1"></a>The only slightly tricky thing here <span class="kw">is</span> that we have to convert a depth to a cycle length. In each cycle, a scanner of depth d moves down (d <span class="op">-</span> <span class="dv">1</span>) steps, <span class="kw">and</span> then back up (d <span class="op">-</span> <span class="dv">1</span>) steps, so the cycle length <span class="kw">is</span> <span class="dv">2</span> \<span class="op">*</span> d <span class="op">-</span> <span class="fl">2.</span></span>
<span id="cb53-454"><a href="#cb53-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-457"><a href="#cb53-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-458"><a href="#cb53-458" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">13</span>, <span class="st">"int"</span>)</span>
<span id="cb53-459"><a href="#cb53-459" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="dv">0</span> <span class="cf">if</span> (x[<span class="dv">0</span>] <span class="op">%</span> (x[<span class="dv">1</span>] <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span>)) <span class="cf">else</span> x[<span class="dv">0</span>] <span class="op">*</span> x[<span class="dv">1</span>], data))</span>
<span id="cb53-460"><a href="#cb53-460" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-461"><a href="#cb53-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-462"><a href="#cb53-462" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-463"><a href="#cb53-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-464"><a href="#cb53-464" aria-hidden="true" tabindex="-1"></a>So, this <span class="kw">is</span> another application of the chinese remainder theorem, after a bit of massaging. We have multiple scanners <span class="cf">with</span> the same depth at different positions<span class="op">;</span> each such scanner invalidates a congruence <span class="kw">class</span> of the integers mod cycle length.</span>
<span id="cb53-465"><a href="#cb53-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-466"><a href="#cb53-466" aria-hidden="true" tabindex="-1"></a>In my <span class="bu">input</span>, the depths were almost coprime <span class="kw">in</span> the sense that there was one of the scanner depths that divided <span class="bu">all</span> the others, <span class="kw">and</span> apart <span class="im">from</span> that, the depths were either coprime, <span class="kw">or</span> divided one another exactly.</span>
<span id="cb53-467"><a href="#cb53-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-468"><a href="#cb53-468" aria-hidden="true" tabindex="-1"></a>The depths that divide one another exactly can be handled by unfolding the restriction of the smaller number to its higher multiples, <span class="kw">and</span> then removing the smaller number <span class="im">from</span> consideration. After that, we can find what numbers would be valid <span class="cf">for</span> each depth.</span>
<span id="cb53-469"><a href="#cb53-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-470"><a href="#cb53-470" aria-hidden="true" tabindex="-1"></a>For most of these, there was only one such modulus. Taking <span class="bu">all</span> the ones <span class="cf">for</span> which that<span class="st">'s the case we can use the chinese remainder theorem to solve that system of congruences, and then manually move to higher congruences to satisfy the remaining scanners.</span></span>
<span id="cb53-471"><a href="#cb53-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-474"><a href="#cb53-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-475"><a href="#cb53-475" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb53-476"><a href="#cb53-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-477"><a href="#cb53-477" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> crt</span>
<span id="cb53-478"><a href="#cb53-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-479"><a href="#cb53-479" aria-hidden="true" tabindex="-1"></a>scanners <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb53-480"><a href="#cb53-480" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> position, depth <span class="kw">in</span> data:</span>
<span id="cb53-481"><a href="#cb53-481" aria-hidden="true" tabindex="-1"></a>    scanners[<span class="dv">2</span> <span class="op">*</span> depth <span class="op">-</span> <span class="dv">2</span>].append((<span class="op">-</span>position) <span class="op">%</span> (<span class="dv">2</span> <span class="op">*</span> depth <span class="op">-</span> <span class="dv">2</span>))</span>
<span id="cb53-482"><a href="#cb53-482" aria-hidden="true" tabindex="-1"></a>    scanners[<span class="dv">2</span> <span class="op">*</span> depth <span class="op">-</span> <span class="dv">2</span>].sort()</span>
<span id="cb53-483"><a href="#cb53-483" aria-hidden="true" tabindex="-1"></a>seen <span class="op">=</span> []</span>
<span id="cb53-484"><a href="#cb53-484" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s1, s2 <span class="kw">in</span> itertools.combinations(scanners.keys(), <span class="dv">2</span>):</span>
<span id="cb53-485"><a href="#cb53-485" aria-hidden="true" tabindex="-1"></a>    s2, s1 <span class="op">=</span> <span class="bu">sorted</span>([s1, s2])</span>
<span id="cb53-486"><a href="#cb53-486" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s1 <span class="op">%</span> s2) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb53-487"><a href="#cb53-487" aria-hidden="true" tabindex="-1"></a>        seen.append(s2)</span>
<span id="cb53-488"><a href="#cb53-488" aria-hidden="true" tabindex="-1"></a>        offsets <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, s1, s2))</span>
<span id="cb53-489"><a href="#cb53-489" aria-hidden="true" tabindex="-1"></a>        new_restrictions <span class="op">=</span> <span class="bu">list</span>(</span>
<span id="cb53-490"><a href="#cb53-490" aria-hidden="true" tabindex="-1"></a>            <span class="bu">map</span>(<span class="bu">sum</span>, <span class="bu">list</span>(itertools.product(offsets, scanners[s2])))</span>
<span id="cb53-491"><a href="#cb53-491" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb53-492"><a href="#cb53-492" aria-hidden="true" tabindex="-1"></a>        restrictions <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(new_restrictions <span class="op">+</span> scanners[s1]))</span>
<span id="cb53-493"><a href="#cb53-493" aria-hidden="true" tabindex="-1"></a>        scanners[s1] <span class="op">=</span> restrictions</span>
<span id="cb53-494"><a href="#cb53-494" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> <span class="bu">set</span>(seen):</span>
<span id="cb53-495"><a href="#cb53-495" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> scanners[key]</span>
<span id="cb53-496"><a href="#cb53-496" aria-hidden="true" tabindex="-1"></a>valid <span class="op">=</span> {}</span>
<span id="cb53-497"><a href="#cb53-497" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> scanner <span class="kw">in</span> scanners:</span>
<span id="cb53-498"><a href="#cb53-498" aria-hidden="true" tabindex="-1"></a>    valid[scanner] <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(<span class="bu">range</span>(scanner)) <span class="op">-</span> <span class="bu">set</span>(scanners[scanner]))</span>
<span id="cb53-499"><a href="#cb53-499" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> math.gcd(</span>
<span id="cb53-500"><a href="#cb53-500" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>(</span>
<span id="cb53-501"><a href="#cb53-501" aria-hidden="true" tabindex="-1"></a>        <span class="bu">list</span>(valid.keys())</span>
<span id="cb53-502"><a href="#cb53-502" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> [element <span class="cf">for</span> numbers <span class="kw">in</span> valid.values() <span class="cf">for</span> element <span class="kw">in</span> numbers]</span>
<span id="cb53-503"><a href="#cb53-503" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-504"><a href="#cb53-504" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-505"><a href="#cb53-505" aria-hidden="true" tabindex="-1"></a>congruences <span class="op">=</span> []</span>
<span id="cb53-506"><a href="#cb53-506" aria-hidden="true" tabindex="-1"></a>remainder <span class="op">=</span> {}</span>
<span id="cb53-507"><a href="#cb53-507" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> modulus <span class="kw">in</span> valid:</span>
<span id="cb53-508"><a href="#cb53-508" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(valid[modulus]) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb53-509"><a href="#cb53-509" aria-hidden="true" tabindex="-1"></a>        congruences.append((<span class="bu">int</span>(modulus <span class="op">/</span> g), <span class="bu">int</span>(valid[modulus][<span class="dv">0</span>] <span class="op">/</span> g)))</span>
<span id="cb53-510"><a href="#cb53-510" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-511"><a href="#cb53-511" aria-hidden="true" tabindex="-1"></a>        remainder[<span class="bu">int</span>(modulus <span class="op">/</span> g)] <span class="op">=</span> [<span class="bu">int</span>(x <span class="op">/</span> g) <span class="cf">for</span> x <span class="kw">in</span> valid[modulus]]</span>
<span id="cb53-512"><a href="#cb53-512" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.product([x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> congruences])</span>
<span id="cb53-513"><a href="#cb53-513" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> crt(congruences) <span class="op">-</span> N</span>
<span id="cb53-514"><a href="#cb53-514" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb53-515"><a href="#cb53-515" aria-hidden="true" tabindex="-1"></a>    x <span class="op">+=</span> N</span>
<span id="cb53-516"><a href="#cb53-516" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> v <span class="kw">in</span> remainder:</span>
<span id="cb53-517"><a href="#cb53-517" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (x <span class="op">%</span> v) <span class="kw">not</span> <span class="kw">in</span> remainder[v]:</span>
<span id="cb53-518"><a href="#cb53-518" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb53-519"><a href="#cb53-519" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-520"><a href="#cb53-520" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb53-521"><a href="#cb53-521" aria-hidden="true" tabindex="-1"></a>g <span class="op">*</span> x</span>
<span id="cb53-522"><a href="#cb53-522" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-523"><a href="#cb53-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-524"><a href="#cb53-524" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 14: Disk Defragmentation](https://adventofcode.com/2017/day/14)</span></span>
<span id="cb53-525"><a href="#cb53-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-526"><a href="#cb53-526" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-527"><a href="#cb53-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-530"><a href="#cb53-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-531"><a href="#cb53-531" aria-hidden="true" tabindex="-1"></a>prefix <span class="op">=</span> load(<span class="dv">14</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">"-"</span></span>
<span id="cb53-532"><a href="#cb53-532" aria-hidden="true" tabindex="-1"></a>hashes <span class="op">=</span> [knot_hash64(prefix <span class="op">+</span> <span class="bu">str</span>(i)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">128</span>)]</span>
<span id="cb53-533"><a href="#cb53-533" aria-hidden="true" tabindex="-1"></a>bitstrings <span class="op">=</span> [<span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(h, <span class="dv">16</span>)<span class="sc">:0128b}</span><span class="ss">"</span> <span class="cf">for</span> h <span class="kw">in</span> hashes]</span>
<span id="cb53-534"><a href="#cb53-534" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(x.count(<span class="st">"1"</span>) <span class="cf">for</span> x <span class="kw">in</span> bitstrings)</span>
<span id="cb53-535"><a href="#cb53-535" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-536"><a href="#cb53-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-537"><a href="#cb53-537" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-538"><a href="#cb53-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-541"><a href="#cb53-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-542"><a href="#cb53-542" aria-hidden="true" tabindex="-1"></a>field <span class="op">=</span> np.array([[<span class="bu">ord</span>(x) <span class="op">-</span> <span class="bu">ord</span>(<span class="st">"0"</span>) <span class="cf">for</span> x <span class="kw">in</span> b] <span class="cf">for</span> b <span class="kw">in</span> bitstrings])</span>
<span id="cb53-543"><a href="#cb53-543" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb53-544"><a href="#cb53-544" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, j <span class="kw">in</span> itertools.product(<span class="bu">range</span>(<span class="dv">128</span>), <span class="bu">range</span>(<span class="dv">128</span>)):</span>
<span id="cb53-545"><a href="#cb53-545" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> [(i, j <span class="op">+</span> <span class="dv">1</span>), (i <span class="op">+</span> <span class="dv">1</span>, j)]</span>
<span id="cb53-546"><a href="#cb53-546" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> [(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> neighbors <span class="cf">if</span> (x <span class="op">&lt;</span> <span class="dv">128</span> <span class="kw">and</span> y <span class="op">&lt;</span> <span class="dv">128</span>)]</span>
<span id="cb53-547"><a href="#cb53-547" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> field[i, j]:</span>
<span id="cb53-548"><a href="#cb53-548" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb53-549"><a href="#cb53-549" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb53-550"><a href="#cb53-550" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> field[neighbor]:</span>
<span id="cb53-551"><a href="#cb53-551" aria-hidden="true" tabindex="-1"></a>            graph[(i, j)].append(neighbor)</span>
<span id="cb53-552"><a href="#cb53-552" aria-hidden="true" tabindex="-1"></a>            graph[neighbor].append((i, j))</span>
<span id="cb53-553"><a href="#cb53-553" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> field.<span class="bu">sum</span>() <span class="op">-</span> <span class="bu">len</span>(graph)  <span class="co"># singletons</span></span>
<span id="cb53-554"><a href="#cb53-554" aria-hidden="true" tabindex="-1"></a>neighbors <span class="op">=</span> <span class="kw">lambda</span> x: graph[x]</span>
<span id="cb53-555"><a href="#cb53-555" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> graph:</span>
<span id="cb53-556"><a href="#cb53-556" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> <span class="bu">list</span>(graph.keys())[<span class="dv">0</span>]</span>
<span id="cb53-557"><a href="#cb53-557" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> utils.bfs(seed, <span class="va">None</span>, neighbors, return_visited<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-558"><a href="#cb53-558" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> visited:</span>
<span id="cb53-559"><a href="#cb53-559" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[node]</span>
<span id="cb53-560"><a href="#cb53-560" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-561"><a href="#cb53-561" aria-hidden="true" tabindex="-1"></a>count</span>
<span id="cb53-562"><a href="#cb53-562" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-563"><a href="#cb53-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-564"><a href="#cb53-564" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 15: Dueling Generators](https://adventofcode.com/2017/day/15)</span></span>
<span id="cb53-565"><a href="#cb53-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-566"><a href="#cb53-566" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-567"><a href="#cb53-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-570"><a href="#cb53-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-571"><a href="#cb53-571" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="dv">16807</span></span>
<span id="cb53-572"><a href="#cb53-572" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="dv">48271</span></span>
<span id="cb53-573"><a href="#cb53-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-574"><a href="#cb53-574" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">116</span></span>
<span id="cb53-575"><a href="#cb53-575" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">299</span></span>
<span id="cb53-576"><a href="#cb53-576" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-577"><a href="#cb53-577" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">40_000_000</span>):</span>
<span id="cb53-578"><a href="#cb53-578" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> (a <span class="op">*</span> A) <span class="op">%</span> <span class="dv">2147483647</span></span>
<span id="cb53-579"><a href="#cb53-579" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> (b <span class="op">*</span> B) <span class="op">%</span> <span class="dv">2147483647</span></span>
<span id="cb53-580"><a href="#cb53-580" aria-hidden="true" tabindex="-1"></a>    total <span class="op">+=</span> (a <span class="op">%</span> <span class="dv">2</span><span class="op">**</span><span class="dv">16</span>) <span class="op">==</span> (b <span class="op">%</span> <span class="dv">2</span><span class="op">**</span><span class="dv">16</span>)</span>
<span id="cb53-581"><a href="#cb53-581" aria-hidden="true" tabindex="-1"></a>total</span>
<span id="cb53-582"><a href="#cb53-582" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-583"><a href="#cb53-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-584"><a href="#cb53-584" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-585"><a href="#cb53-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-588"><a href="#cb53-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-589"><a href="#cb53-589" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">116</span></span>
<span id="cb53-590"><a href="#cb53-590" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">299</span></span>
<span id="cb53-591"><a href="#cb53-591" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-592"><a href="#cb53-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-593"><a href="#cb53-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-594"><a href="#cb53-594" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gen_a(start):</span>
<span id="cb53-595"><a href="#cb53-595" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> start</span>
<span id="cb53-596"><a href="#cb53-596" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb53-597"><a href="#cb53-597" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> (current <span class="op">*</span> A) <span class="op">%</span> <span class="dv">2147483647</span></span>
<span id="cb53-598"><a href="#cb53-598" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb53-599"><a href="#cb53-599" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> current</span>
<span id="cb53-600"><a href="#cb53-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-601"><a href="#cb53-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-602"><a href="#cb53-602" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gen_b(start):</span>
<span id="cb53-603"><a href="#cb53-603" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> start</span>
<span id="cb53-604"><a href="#cb53-604" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb53-605"><a href="#cb53-605" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> (current <span class="op">*</span> B) <span class="op">%</span> <span class="dv">2147483647</span></span>
<span id="cb53-606"><a href="#cb53-606" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current <span class="op">%</span> <span class="dv">8</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb53-607"><a href="#cb53-607" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> current</span>
<span id="cb53-608"><a href="#cb53-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-609"><a href="#cb53-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-610"><a href="#cb53-610" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> gen_a(a)</span>
<span id="cb53-611"><a href="#cb53-611" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> gen_b(b)</span>
<span id="cb53-612"><a href="#cb53-612" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5_000_000</span>):</span>
<span id="cb53-613"><a href="#cb53-613" aria-hidden="true" tabindex="-1"></a>    total <span class="op">+=</span> (<span class="bu">next</span>(a) <span class="op">%</span> <span class="dv">2</span><span class="op">**</span><span class="dv">16</span>) <span class="op">==</span> (<span class="bu">next</span>(b) <span class="op">%</span> <span class="dv">2</span><span class="op">**</span><span class="dv">16</span>)</span>
<span id="cb53-614"><a href="#cb53-614" aria-hidden="true" tabindex="-1"></a>total</span>
<span id="cb53-615"><a href="#cb53-615" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-616"><a href="#cb53-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-617"><a href="#cb53-617" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 16: Permutation Promenade](https://adventofcode.com/2017/day/16)</span></span>
<span id="cb53-618"><a href="#cb53-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-619"><a href="#cb53-619" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-620"><a href="#cb53-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-623"><a href="#cb53-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-624"><a href="#cb53-624" aria-hidden="true" tabindex="-1"></a>moves <span class="op">=</span> load(<span class="dv">16</span>)[<span class="dv">0</span>].split(<span class="st">","</span>)</span>
<span id="cb53-625"><a href="#cb53-625" aria-hidden="true" tabindex="-1"></a>permutations <span class="op">=</span> <span class="bu">list</span>(<span class="st">"abcdefghijklmnop"</span>)</span>
<span id="cb53-626"><a href="#cb53-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-627"><a href="#cb53-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-628"><a href="#cb53-628" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dance(permutations, n):</span>
<span id="cb53-629"><a href="#cb53-629" aria-hidden="true" tabindex="-1"></a>    seen <span class="op">=</span> []</span>
<span id="cb53-630"><a href="#cb53-630" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb53-631"><a href="#cb53-631" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> <span class="st">""</span>.join(permutations)</span>
<span id="cb53-632"><a href="#cb53-632" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> s <span class="kw">in</span> seen:</span>
<span id="cb53-633"><a href="#cb53-633" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> seen[n <span class="op">%</span> i]</span>
<span id="cb53-634"><a href="#cb53-634" aria-hidden="true" tabindex="-1"></a>        seen.append(s)</span>
<span id="cb53-635"><a href="#cb53-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-636"><a href="#cb53-636" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> move <span class="kw">in</span> moves:</span>
<span id="cb53-637"><a href="#cb53-637" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> move[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"s"</span>:</span>
<span id="cb53-638"><a href="#cb53-638" aria-hidden="true" tabindex="-1"></a>                i <span class="op">=</span> <span class="bu">int</span>(move[<span class="dv">1</span>:])</span>
<span id="cb53-639"><a href="#cb53-639" aria-hidden="true" tabindex="-1"></a>                permutations <span class="op">=</span> permutations[<span class="op">-</span>i:] <span class="op">+</span> permutations[:<span class="op">-</span>i]</span>
<span id="cb53-640"><a href="#cb53-640" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb53-641"><a href="#cb53-641" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> move[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"x"</span>:</span>
<span id="cb53-642"><a href="#cb53-642" aria-hidden="true" tabindex="-1"></a>                    a, b <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, move[<span class="dv">1</span>:].split(<span class="st">"/"</span>))</span>
<span id="cb53-643"><a href="#cb53-643" aria-hidden="true" tabindex="-1"></a>                    permutations[a], permutations[b] <span class="op">=</span> permutations[b], permutations[a]</span>
<span id="cb53-644"><a href="#cb53-644" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> move[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"p"</span>:</span>
<span id="cb53-645"><a href="#cb53-645" aria-hidden="true" tabindex="-1"></a>                    a, b <span class="op">=</span> move[<span class="dv">1</span>:].split(<span class="st">"/"</span>)</span>
<span id="cb53-646"><a href="#cb53-646" aria-hidden="true" tabindex="-1"></a>                    A <span class="op">=</span> permutations.index(a)</span>
<span id="cb53-647"><a href="#cb53-647" aria-hidden="true" tabindex="-1"></a>                    B <span class="op">=</span> permutations.index(b)</span>
<span id="cb53-648"><a href="#cb53-648" aria-hidden="true" tabindex="-1"></a>                    permutations[A], permutations[B] <span class="op">=</span> permutations[B], permutations[A]</span>
<span id="cb53-649"><a href="#cb53-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-650"><a href="#cb53-650" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> permutations</span>
<span id="cb53-651"><a href="#cb53-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-652"><a href="#cb53-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-653"><a href="#cb53-653" aria-hidden="true" tabindex="-1"></a><span class="st">""</span>.join(dance(permutations[:], <span class="dv">1</span>))</span>
<span id="cb53-654"><a href="#cb53-654" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-655"><a href="#cb53-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-656"><a href="#cb53-656" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-657"><a href="#cb53-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-658"><a href="#cb53-658" aria-hidden="true" tabindex="-1"></a>For part <span class="dv">2</span>, it would take too <span class="bu">long</span> to go through <span class="bu">all</span> the one billion cycles. But what <span class="cf">if</span> the dances hit a cycle at some point? That would make things a lot easier<span class="op">!</span></span>
<span id="cb53-659"><a href="#cb53-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-662"><a href="#cb53-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-663"><a href="#cb53-663" aria-hidden="true" tabindex="-1"></a>dance(permutations[:], <span class="dv">1_000_000_000</span>)</span>
<span id="cb53-664"><a href="#cb53-664" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-665"><a href="#cb53-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-666"><a href="#cb53-666" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 17: Spinlock](https://adventofcode.com/2017/day/17)</span></span>
<span id="cb53-667"><a href="#cb53-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-668"><a href="#cb53-668" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-669"><a href="#cb53-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-672"><a href="#cb53-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-673"><a href="#cb53-673" aria-hidden="true" tabindex="-1"></a>steps <span class="op">=</span> <span class="dv">386</span></span>
<span id="cb53-674"><a href="#cb53-674" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> collections.deque([<span class="dv">0</span>])</span>
<span id="cb53-675"><a href="#cb53-675" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">2018</span>):</span>
<span id="cb53-676"><a href="#cb53-676" aria-hidden="true" tabindex="-1"></a>    q.rotate(<span class="op">-</span>steps <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb53-677"><a href="#cb53-677" aria-hidden="true" tabindex="-1"></a>    q.appendleft(i)</span>
<span id="cb53-678"><a href="#cb53-678" aria-hidden="true" tabindex="-1"></a>q[<span class="dv">1</span>]</span>
<span id="cb53-679"><a href="#cb53-679" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-680"><a href="#cb53-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-681"><a href="#cb53-681" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-682"><a href="#cb53-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-683"><a href="#cb53-683" aria-hidden="true" tabindex="-1"></a><span class="dv">50</span> million <span class="kw">is</span> at a level where the previous approach <span class="kw">is</span> becoming ineffective. The code below takes \<span class="op">~</span><span class="dv">40</span> seconds to run. It could probably be improved, but that would take longer than <span class="dv">40</span> seconds.</span>
<span id="cb53-684"><a href="#cb53-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-687"><a href="#cb53-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-688"><a href="#cb53-688" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> collections.deque([<span class="dv">0</span>])</span>
<span id="cb53-689"><a href="#cb53-689" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">50_000_000</span>):</span>
<span id="cb53-690"><a href="#cb53-690" aria-hidden="true" tabindex="-1"></a>    q.rotate(<span class="op">-</span>steps <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb53-691"><a href="#cb53-691" aria-hidden="true" tabindex="-1"></a>    q.appendleft(i)</span>
<span id="cb53-692"><a href="#cb53-692" aria-hidden="true" tabindex="-1"></a>q[q.index(<span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb53-693"><a href="#cb53-693" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-694"><a href="#cb53-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-695"><a href="#cb53-695" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 18: Duet](https://adventofcode.com/2017/day/18)</span></span>
<span id="cb53-696"><a href="#cb53-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-697"><a href="#cb53-697" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-698"><a href="#cb53-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-701"><a href="#cb53-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-702"><a href="#cb53-702" aria-hidden="true" tabindex="-1"></a>program <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">18</span>)]</span>
<span id="cb53-703"><a href="#cb53-703" aria-hidden="true" tabindex="-1"></a>ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-704"><a href="#cb53-704" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb53-705"><a href="#cb53-705" aria-hidden="true" tabindex="-1"></a>binops <span class="op">=</span> {</span>
<span id="cb53-706"><a href="#cb53-706" aria-hidden="true" tabindex="-1"></a>    <span class="st">"set"</span>: <span class="kw">lambda</span> x, y: y,</span>
<span id="cb53-707"><a href="#cb53-707" aria-hidden="true" tabindex="-1"></a>    <span class="st">"add"</span>: <span class="kw">lambda</span> x, y: x <span class="op">+</span> y,</span>
<span id="cb53-708"><a href="#cb53-708" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mul"</span>: <span class="kw">lambda</span> x, y: x <span class="op">*</span> y,</span>
<span id="cb53-709"><a href="#cb53-709" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mod"</span>: <span class="kw">lambda</span> x, y: x <span class="op">%</span> y,</span>
<span id="cb53-710"><a href="#cb53-710" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-711"><a href="#cb53-711" aria-hidden="true" tabindex="-1"></a>memory <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-712"><a href="#cb53-712" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="dv">0</span> <span class="op">&lt;=</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(program):</span>
<span id="cb53-713"><a href="#cb53-713" aria-hidden="true" tabindex="-1"></a>    instruction <span class="op">=</span> program[ip]</span>
<span id="cb53-714"><a href="#cb53-714" aria-hidden="true" tabindex="-1"></a>    instruction, register, argument <span class="op">=</span> instruction[<span class="dv">0</span>], instruction[<span class="dv">1</span>], instruction[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb53-715"><a href="#cb53-715" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb53-716"><a href="#cb53-716" aria-hidden="true" tabindex="-1"></a>        argument <span class="op">=</span> <span class="bu">int</span>(argument)</span>
<span id="cb53-717"><a href="#cb53-717" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb53-718"><a href="#cb53-718" aria-hidden="true" tabindex="-1"></a>        argument <span class="op">=</span> registers[argument]</span>
<span id="cb53-719"><a href="#cb53-719" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> instruction <span class="kw">in</span> binops:</span>
<span id="cb53-720"><a href="#cb53-720" aria-hidden="true" tabindex="-1"></a>        op <span class="op">=</span> binops[instruction]</span>
<span id="cb53-721"><a href="#cb53-721" aria-hidden="true" tabindex="-1"></a>        registers[register] <span class="op">=</span> op(registers[register], argument)</span>
<span id="cb53-722"><a href="#cb53-722" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"jgz"</span>:</span>
<span id="cb53-723"><a href="#cb53-723" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> registers[register] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb53-724"><a href="#cb53-724" aria-hidden="true" tabindex="-1"></a>            ip <span class="op">+=</span> argument <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb53-725"><a href="#cb53-725" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"rcv"</span>:</span>
<span id="cb53-726"><a href="#cb53-726" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> registers[register] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb53-727"><a href="#cb53-727" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(memory)</span>
<span id="cb53-728"><a href="#cb53-728" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb53-729"><a href="#cb53-729" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"snd"</span>:</span>
<span id="cb53-730"><a href="#cb53-730" aria-hidden="true" tabindex="-1"></a>        memory <span class="op">=</span> argument</span>
<span id="cb53-731"><a href="#cb53-731" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-732"><a href="#cb53-732" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-733"><a href="#cb53-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-734"><a href="#cb53-734" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-735"><a href="#cb53-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-736"><a href="#cb53-736" aria-hidden="true" tabindex="-1"></a>There<span class="st">'s a bunch of state to keep track of - let'</span>s make a <span class="kw">class</span> to hold it.</span>
<span id="cb53-737"><a href="#cb53-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-740"><a href="#cb53-740" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-741"><a href="#cb53-741" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Program:</span>
<span id="cb53-742"><a href="#cb53-742" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, program, program_id, inputs):</span>
<span id="cb53-743"><a href="#cb53-743" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.program <span class="op">=</span> program.copy()</span>
<span id="cb53-744"><a href="#cb53-744" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ram <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb53-745"><a href="#cb53-745" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ram[<span class="st">"p"</span>] <span class="op">=</span> program_id</span>
<span id="cb53-746"><a href="#cb53-746" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.state <span class="op">=</span> <span class="dv">1</span>  <span class="co"># ready</span></span>
<span id="cb53-747"><a href="#cb53-747" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-748"><a href="#cb53-748" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-749"><a href="#cb53-749" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.inputs <span class="op">=</span> inputs</span>
<span id="cb53-750"><a href="#cb53-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-751"><a href="#cb53-751" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__next__</span>(<span class="va">self</span>):</span>
<span id="cb53-752"><a href="#cb53-752" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="dv">0</span> <span class="op">&lt;=</span> <span class="va">self</span>.ip <span class="op">&lt;</span> <span class="bu">len</span>(<span class="va">self</span>.program):</span>
<span id="cb53-753"><a href="#cb53-753" aria-hidden="true" tabindex="-1"></a>            instruction <span class="op">=</span> <span class="va">self</span>.program[<span class="va">self</span>.ip]</span>
<span id="cb53-754"><a href="#cb53-754" aria-hidden="true" tabindex="-1"></a>            instruction, register, argument <span class="op">=</span> (</span>
<span id="cb53-755"><a href="#cb53-755" aria-hidden="true" tabindex="-1"></a>                instruction[<span class="dv">0</span>],</span>
<span id="cb53-756"><a href="#cb53-756" aria-hidden="true" tabindex="-1"></a>                instruction[<span class="dv">1</span>],</span>
<span id="cb53-757"><a href="#cb53-757" aria-hidden="true" tabindex="-1"></a>                instruction[<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb53-758"><a href="#cb53-758" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb53-759"><a href="#cb53-759" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb53-760"><a href="#cb53-760" aria-hidden="true" tabindex="-1"></a>                argument <span class="op">=</span> <span class="bu">int</span>(argument)</span>
<span id="cb53-761"><a href="#cb53-761" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb53-762"><a href="#cb53-762" aria-hidden="true" tabindex="-1"></a>                argument <span class="op">=</span> <span class="va">self</span>.ram[argument]</span>
<span id="cb53-763"><a href="#cb53-763" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> instruction <span class="kw">in</span> binops:</span>
<span id="cb53-764"><a href="#cb53-764" aria-hidden="true" tabindex="-1"></a>                op <span class="op">=</span> binops[instruction]</span>
<span id="cb53-765"><a href="#cb53-765" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.ram[register] <span class="op">=</span> op(<span class="va">self</span>.ram[register], argument)</span>
<span id="cb53-766"><a href="#cb53-766" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"jgz"</span>:</span>
<span id="cb53-767"><a href="#cb53-767" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb53-768"><a href="#cb53-768" aria-hidden="true" tabindex="-1"></a>                    comparison <span class="op">=</span> <span class="bu">int</span>(register)</span>
<span id="cb53-769"><a href="#cb53-769" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb53-770"><a href="#cb53-770" aria-hidden="true" tabindex="-1"></a>                    comparison <span class="op">=</span> <span class="va">self</span>.ram[register]</span>
<span id="cb53-771"><a href="#cb53-771" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> comparison <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb53-772"><a href="#cb53-772" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.ip <span class="op">+=</span> argument <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb53-773"><a href="#cb53-773" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"rcv"</span>:</span>
<span id="cb53-774"><a href="#cb53-774" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.inputs:</span>
<span id="cb53-775"><a href="#cb53-775" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.state <span class="op">=</span> <span class="dv">0</span>  <span class="co"># Waiting</span></span>
<span id="cb53-776"><a href="#cb53-776" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb53-777"><a href="#cb53-777" aria-hidden="true" tabindex="-1"></a>                x <span class="op">=</span> <span class="va">self</span>.inputs.pop(<span class="dv">0</span>)</span>
<span id="cb53-778"><a href="#cb53-778" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.ram[register] <span class="op">=</span> x</span>
<span id="cb53-779"><a href="#cb53-779" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"snd"</span>:</span>
<span id="cb53-780"><a href="#cb53-780" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-781"><a href="#cb53-781" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-782"><a href="#cb53-782" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> argument</span>
<span id="cb53-783"><a href="#cb53-783" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-784"><a href="#cb53-784" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.state <span class="op">=</span> <span class="dv">2</span>  <span class="co"># terminated</span></span>
<span id="cb53-785"><a href="#cb53-785" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb53-786"><a href="#cb53-786" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-787"><a href="#cb53-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-788"><a href="#cb53-788" aria-hidden="true" tabindex="-1"></a>With that out of the way we can implement the collaboration <span class="im">as</span> follows: run program <span class="dv">0</span> until it<span class="st">'s asking for a non-existent value (or finishes), then do the same for program 1. Keep going until both programs are waiting for the other or p1 has finished.</span></span>
<span id="cb53-789"><a href="#cb53-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-792"><a href="#cb53-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-793"><a href="#cb53-793" aria-hidden="true" tabindex="-1"></a>bus_one <span class="op">=</span> []</span>
<span id="cb53-794"><a href="#cb53-794" aria-hidden="true" tabindex="-1"></a>bus_two <span class="op">=</span> []</span>
<span id="cb53-795"><a href="#cb53-795" aria-hidden="true" tabindex="-1"></a>p0 <span class="op">=</span> Program(program, <span class="dv">0</span>, bus_two)</span>
<span id="cb53-796"><a href="#cb53-796" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> Program(program, <span class="dv">1</span>, bus_one)</span>
<span id="cb53-797"><a href="#cb53-797" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> p0.state <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> p1.state <span class="op">!=</span> <span class="dv">2</span>:</span>
<span id="cb53-798"><a href="#cb53-798" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> p0.state <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb53-799"><a href="#cb53-799" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> <span class="bu">next</span>(p0)</span>
<span id="cb53-800"><a href="#cb53-800" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb53-801"><a href="#cb53-801" aria-hidden="true" tabindex="-1"></a>            bus_one.append(n)</span>
<span id="cb53-802"><a href="#cb53-802" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bus_one <span class="kw">and</span> p1.state <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb53-803"><a href="#cb53-803" aria-hidden="true" tabindex="-1"></a>        p1.state <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb53-804"><a href="#cb53-804" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> p1.state <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb53-805"><a href="#cb53-805" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> <span class="bu">next</span>(p1)</span>
<span id="cb53-806"><a href="#cb53-806" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb53-807"><a href="#cb53-807" aria-hidden="true" tabindex="-1"></a>            bus_two.append(n)</span>
<span id="cb53-808"><a href="#cb53-808" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bus_two <span class="kw">and</span> p0.state <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb53-809"><a href="#cb53-809" aria-hidden="true" tabindex="-1"></a>        p0.state <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb53-810"><a href="#cb53-810" aria-hidden="true" tabindex="-1"></a>p1.count</span>
<span id="cb53-811"><a href="#cb53-811" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-812"><a href="#cb53-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-813"><a href="#cb53-813" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 19: A Series of Tubes](https://adventofcode.com/2017/day/19)</span></span>
<span id="cb53-814"><a href="#cb53-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-815"><a href="#cb53-815" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-816"><a href="#cb53-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-817"><a href="#cb53-817" aria-hidden="true" tabindex="-1"></a>The hardest part <span class="cf">for</span> this was determining a sensible stopping condition – that <span class="kw">is</span> one that could tell the difference between wires randomly crossing, <span class="kw">and</span> actually being finished. Direct inspection of the <span class="bu">input</span> showed where there was a dead end, so that<span class="st">'s just hard-coded into the below:</span></span>
<span id="cb53-818"><a href="#cb53-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-821"><a href="#cb53-821" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-822"><a href="#cb53-822" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">19</span>)</span>
<span id="cb53-823"><a href="#cb53-823" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> <span class="bu">len</span>(data[<span class="dv">0</span>]), <span class="bu">len</span>(data)</span>
<span id="cb53-824"><a href="#cb53-824" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> <span class="ot">1j</span></span>
<span id="cb53-825"><a href="#cb53-825" aria-hidden="true" tabindex="-1"></a>deltas <span class="op">=</span> [(<span class="ot">1j</span>, <span class="st">"|"</span>), (<span class="op">-</span><span class="ot">1j</span>, <span class="st">"|"</span>), (<span class="dv">1</span>, <span class="st">"-"</span>), (<span class="op">-</span><span class="dv">1</span>, <span class="st">"-"</span>)]</span>
<span id="cb53-826"><a href="#cb53-826" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> data[<span class="dv">0</span>].index(<span class="st">"|"</span>)</span>
<span id="cb53-827"><a href="#cb53-827" aria-hidden="true" tabindex="-1"></a>result, character <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb53-828"><a href="#cb53-828" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb53-829"><a href="#cb53-829" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> character <span class="op">!=</span> <span class="st">"L"</span>:</span>
<span id="cb53-830"><a href="#cb53-830" aria-hidden="true" tabindex="-1"></a>    position <span class="op">=</span> position <span class="op">+</span> direction</span>
<span id="cb53-831"><a href="#cb53-831" aria-hidden="true" tabindex="-1"></a>    character <span class="op">=</span> data[<span class="bu">int</span>(position.imag)][<span class="bu">int</span>(position.real)]</span>
<span id="cb53-832"><a href="#cb53-832" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> character <span class="op">==</span> <span class="st">"+"</span>:</span>
<span id="cb53-833"><a href="#cb53-833" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> delta, char <span class="kw">in</span> deltas:</span>
<span id="cb53-834"><a href="#cb53-834" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> delta <span class="op">==</span> <span class="op">-</span>direction:</span>
<span id="cb53-835"><a href="#cb53-835" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb53-836"><a href="#cb53-836" aria-hidden="true" tabindex="-1"></a>            lookahead <span class="op">=</span> position <span class="op">+</span> delta</span>
<span id="cb53-837"><a href="#cb53-837" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb53-838"><a href="#cb53-838" aria-hidden="true" tabindex="-1"></a>                next_char <span class="op">=</span> data[<span class="bu">int</span>(lookahead.imag)][<span class="bu">int</span>(lookahead.real)]</span>
<span id="cb53-839"><a href="#cb53-839" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">IndexError</span>:</span>
<span id="cb53-840"><a href="#cb53-840" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb53-841"><a href="#cb53-841" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> next_char <span class="op">==</span> char:</span>
<span id="cb53-842"><a href="#cb53-842" aria-hidden="true" tabindex="-1"></a>                direction <span class="op">=</span> delta</span>
<span id="cb53-843"><a href="#cb53-843" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb53-844"><a href="#cb53-844" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> character <span class="kw">in</span> string.ascii_letters:</span>
<span id="cb53-845"><a href="#cb53-845" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> character</span>
<span id="cb53-846"><a href="#cb53-846" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-847"><a href="#cb53-847" aria-hidden="true" tabindex="-1"></a>result</span>
<span id="cb53-848"><a href="#cb53-848" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-849"><a href="#cb53-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-850"><a href="#cb53-850" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-851"><a href="#cb53-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-852"><a href="#cb53-852" aria-hidden="true" tabindex="-1"></a>I don<span class="st">'t know if this was intentional, but with the solution to part 1 above, counting the number of steps is trivial. Just add a loop variable to keep track of how many times we move</span></span>
<span id="cb53-853"><a href="#cb53-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-856"><a href="#cb53-856" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-857"><a href="#cb53-857" aria-hidden="true" tabindex="-1"></a>i</span>
<span id="cb53-858"><a href="#cb53-858" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-859"><a href="#cb53-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-860"><a href="#cb53-860" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 20: Particle Swarm](https://adventofcode.com/2017/day/20)</span></span>
<span id="cb53-861"><a href="#cb53-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-862"><a href="#cb53-862" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-863"><a href="#cb53-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-864"><a href="#cb53-864" aria-hidden="true" tabindex="-1"></a>It<span class="st">'s always nice to be able to come up with a one-liner to solve these.</span></span>
<span id="cb53-865"><a href="#cb53-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-868"><a href="#cb53-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-869"><a href="#cb53-869" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array(load(<span class="dv">20</span>, <span class="st">"int"</span>), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb53-870"><a href="#cb53-870" aria-hidden="true" tabindex="-1"></a><span class="bu">abs</span>(data[:, <span class="op">-</span><span class="dv">3</span>:]).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).argmin()</span>
<span id="cb53-871"><a href="#cb53-871" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-872"><a href="#cb53-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-873"><a href="#cb53-873" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-874"><a href="#cb53-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-875"><a href="#cb53-875" aria-hidden="true" tabindex="-1"></a>For part two we could do some clever work to figure out a stopping condition based on pairs of particles being reachable <span class="kw">in</span> each of three dimensions, <span class="cf">with</span> reachable defined by being potentially able to catch up. Or we can just pick an arbitrary upper bound <span class="kw">and</span> hope it<span class="st">'s good enough.</span></span>
<span id="cb53-876"><a href="#cb53-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-879"><a href="#cb53-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-880"><a href="#cb53-880" aria-hidden="true" tabindex="-1"></a>s, v, dv <span class="op">=</span> data[:, :<span class="dv">3</span>], data[:, <span class="dv">3</span>:<span class="dv">6</span>], data[:, <span class="op">-</span><span class="dv">3</span>:]</span>
<span id="cb53-881"><a href="#cb53-881" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb53-882"><a href="#cb53-882" aria-hidden="true" tabindex="-1"></a>    v <span class="op">+=</span> dv</span>
<span id="cb53-883"><a href="#cb53-883" aria-hidden="true" tabindex="-1"></a>    s <span class="op">+=</span> v</span>
<span id="cb53-884"><a href="#cb53-884" aria-hidden="true" tabindex="-1"></a>    values, index, count <span class="op">=</span> np.unique(s, return_counts<span class="op">=</span><span class="va">True</span>, return_index<span class="op">=</span><span class="va">True</span>, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb53-885"><a href="#cb53-885" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> index[np.where(count <span class="op">==</span> <span class="dv">1</span>)]</span>
<span id="cb53-886"><a href="#cb53-886" aria-hidden="true" tabindex="-1"></a>    s, v, dv <span class="op">=</span> s[indices], v[indices], dv[indices]</span>
<span id="cb53-887"><a href="#cb53-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-888"><a href="#cb53-888" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(s)</span>
<span id="cb53-889"><a href="#cb53-889" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-890"><a href="#cb53-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-891"><a href="#cb53-891" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 21: Fractal Art](https://adventofcode.com/2017/day/21)</span></span>
<span id="cb53-892"><a href="#cb53-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-893"><a href="#cb53-893" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-894"><a href="#cb53-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-895"><a href="#cb53-895" aria-hidden="true" tabindex="-1"></a>This feels like the triumph of brute force over elegance. The process involves exponential growth, where the array triples <span class="kw">in</span> size every three iterations, so brute forcing seems like an unlikely choice, but the numbers are small enough that it just about works.</span>
<span id="cb53-896"><a href="#cb53-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-899"><a href="#cb53-899" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-900"><a href="#cb53-900" aria-hidden="true" tabindex="-1"></a>translation <span class="op">=</span> <span class="bu">str</span>.maketrans(<span class="st">".#/"</span>, <span class="st">"01</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb53-901"><a href="#cb53-901" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [x.translate(translation).split(<span class="st">" =&gt; "</span>) <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">21</span>)]</span>
<span id="cb53-902"><a href="#cb53-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-903"><a href="#cb53-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-904"><a href="#cb53-904" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hashed(array):</span>
<span id="cb53-905"><a href="#cb53-905" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(array.ravel())</span>
<span id="cb53-906"><a href="#cb53-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-907"><a href="#cb53-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-908"><a href="#cb53-908" aria-hidden="true" tabindex="-1"></a>replacements <span class="op">=</span> {}</span>
<span id="cb53-909"><a href="#cb53-909" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> data:</span>
<span id="cb53-910"><a href="#cb53-910" aria-hidden="true" tabindex="-1"></a>    src, dest <span class="op">=</span> <span class="bu">map</span>(</span>
<span id="cb53-911"><a href="#cb53-911" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> array: np.array(</span>
<span id="cb53-912"><a href="#cb53-912" aria-hidden="true" tabindex="-1"></a>            [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line] <span class="cf">for</span> line <span class="kw">in</span> array.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)], dtype<span class="op">=</span><span class="bu">bool</span></span>
<span id="cb53-913"><a href="#cb53-913" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb53-914"><a href="#cb53-914" aria-hidden="true" tabindex="-1"></a>        row,</span>
<span id="cb53-915"><a href="#cb53-915" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-916"><a href="#cb53-916" aria-hidden="true" tabindex="-1"></a>    flipped <span class="op">=</span> src[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb53-917"><a href="#cb53-917" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb53-918"><a href="#cb53-918" aria-hidden="true" tabindex="-1"></a>        replacements[hashed(flipped)] <span class="op">=</span> dest</span>
<span id="cb53-919"><a href="#cb53-919" aria-hidden="true" tabindex="-1"></a>        replacements[hashed(src)] <span class="op">=</span> dest</span>
<span id="cb53-920"><a href="#cb53-920" aria-hidden="true" tabindex="-1"></a>        src, flipped <span class="op">=</span> np.rot90(src), np.rot90(flipped)</span>
<span id="cb53-921"><a href="#cb53-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-922"><a href="#cb53-922" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.reshape([<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="st">".#...####"</span>.translate(translation)], (<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb53-923"><a href="#cb53-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-924"><a href="#cb53-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-925"><a href="#cb53-925" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solve(array, n):</span>
<span id="cb53-926"><a href="#cb53-926" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb53-927"><a href="#cb53-927" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> array.shape[<span class="dv">0</span>]</span>
<span id="cb53-928"><a href="#cb53-928" aria-hidden="true" tabindex="-1"></a>        step <span class="op">=</span> <span class="dv">2</span> <span class="cf">if</span> s <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">3</span></span>
<span id="cb53-929"><a href="#cb53-929" aria-hidden="true" tabindex="-1"></a>        new_step <span class="op">=</span> <span class="dv">3</span> <span class="cf">if</span> step <span class="op">==</span> <span class="dv">2</span> <span class="cf">else</span> <span class="dv">4</span></span>
<span id="cb53-930"><a href="#cb53-930" aria-hidden="true" tabindex="-1"></a>        new_size <span class="op">=</span> (s <span class="op">//</span> step) <span class="op">*</span> new_step</span>
<span id="cb53-931"><a href="#cb53-931" aria-hidden="true" tabindex="-1"></a>        new_array <span class="op">=</span> np.zeros((new_size, new_size), dtype<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb53-932"><a href="#cb53-932" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, s, step):</span>
<span id="cb53-933"><a href="#cb53-933" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, s, step):</span>
<span id="cb53-934"><a href="#cb53-934" aria-hidden="true" tabindex="-1"></a>                square <span class="op">=</span> array[i : i <span class="op">+</span> step, j : j <span class="op">+</span> step]</span>
<span id="cb53-935"><a href="#cb53-935" aria-hidden="true" tabindex="-1"></a>                new_square <span class="op">=</span> replacements[hashed(square)]</span>
<span id="cb53-936"><a href="#cb53-936" aria-hidden="true" tabindex="-1"></a>                new_array[</span>
<span id="cb53-937"><a href="#cb53-937" aria-hidden="true" tabindex="-1"></a>                    (i <span class="op">//</span> step) <span class="op">*</span> new_step : (i <span class="op">//</span> step) <span class="op">*</span> new_step <span class="op">+</span> new_step,</span>
<span id="cb53-938"><a href="#cb53-938" aria-hidden="true" tabindex="-1"></a>                    (j <span class="op">//</span> step) <span class="op">*</span> new_step : (j <span class="op">//</span> step) <span class="op">*</span> new_step <span class="op">+</span> new_step,</span>
<span id="cb53-939"><a href="#cb53-939" aria-hidden="true" tabindex="-1"></a>                ] <span class="op">=</span> new_square</span>
<span id="cb53-940"><a href="#cb53-940" aria-hidden="true" tabindex="-1"></a>        array <span class="op">=</span> new_array</span>
<span id="cb53-941"><a href="#cb53-941" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span> <span class="op">*</span> array).<span class="bu">sum</span>()</span>
<span id="cb53-942"><a href="#cb53-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-943"><a href="#cb53-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-944"><a href="#cb53-944" aria-hidden="true" tabindex="-1"></a>solve(array, <span class="dv">5</span>)</span>
<span id="cb53-945"><a href="#cb53-945" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-946"><a href="#cb53-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-947"><a href="#cb53-947" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-948"><a href="#cb53-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-951"><a href="#cb53-951" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-952"><a href="#cb53-952" aria-hidden="true" tabindex="-1"></a>solve(array, <span class="dv">18</span>)</span>
<span id="cb53-953"><a href="#cb53-953" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-954"><a href="#cb53-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-955"><a href="#cb53-955" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 22: Sporifica Virus](https://adventofcode.com/2017/day/22)</span></span>
<span id="cb53-956"><a href="#cb53-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-957"><a href="#cb53-957" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-958"><a href="#cb53-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-961"><a href="#cb53-961" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-962"><a href="#cb53-962" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> <span class="ot">1j</span></span>
<span id="cb53-963"><a href="#cb53-963" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">if</span> char <span class="op">==</span> <span class="st">"."</span> <span class="cf">else</span> <span class="dv">1</span> <span class="cf">for</span> char <span class="kw">in</span> line] <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">22</span>)]</span>
<span id="cb53-964"><a href="#cb53-964" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb53-965"><a href="#cb53-965" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> size <span class="op">//</span> <span class="dv">2</span> <span class="op">+</span> (size <span class="op">//</span> <span class="dv">2</span>) <span class="op">*</span> <span class="ot">1j</span></span>
<span id="cb53-966"><a href="#cb53-966" aria-hidden="true" tabindex="-1"></a>board <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb53-967"><a href="#cb53-967" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> y, line <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb53-968"><a href="#cb53-968" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x, val <span class="kw">in</span> <span class="bu">enumerate</span>(line):</span>
<span id="cb53-969"><a href="#cb53-969" aria-hidden="true" tabindex="-1"></a>        board[x <span class="op">+</span> (size <span class="op">-</span> y <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="ot">1j</span>] <span class="op">=</span> val</span>
<span id="cb53-970"><a href="#cb53-970" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-971"><a href="#cb53-971" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>):</span>
<span id="cb53-972"><a href="#cb53-972" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> board[position]</span>
<span id="cb53-973"><a href="#cb53-973" aria-hidden="true" tabindex="-1"></a>    total <span class="op">+=</span> state <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb53-974"><a href="#cb53-974" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">*=</span> (<span class="dv">1</span> <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> state) <span class="op">*</span> <span class="ot">1j</span></span>
<span id="cb53-975"><a href="#cb53-975" aria-hidden="true" tabindex="-1"></a>    board[position] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> state</span>
<span id="cb53-976"><a href="#cb53-976" aria-hidden="true" tabindex="-1"></a>    position <span class="op">+=</span> direction</span>
<span id="cb53-977"><a href="#cb53-977" aria-hidden="true" tabindex="-1"></a>total</span>
<span id="cb53-978"><a href="#cb53-978" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-979"><a href="#cb53-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-980"><a href="#cb53-980" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-981"><a href="#cb53-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-982"><a href="#cb53-982" aria-hidden="true" tabindex="-1"></a>The large number of iterations <span class="cf">for</span> part <span class="dv">2</span> seems to indicate that I should do something more clever here. But the following runs <span class="kw">in</span> about <span class="dv">20</span><span class="er">s</span> on my machine, so nevermind.</span>
<span id="cb53-983"><a href="#cb53-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-986"><a href="#cb53-986" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-987"><a href="#cb53-987" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> <span class="ot">1j</span></span>
<span id="cb53-988"><a href="#cb53-988" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [[<span class="ot">1j</span> <span class="cf">if</span> char <span class="op">==</span> <span class="st">"."</span> <span class="cf">else</span> <span class="op">-</span><span class="ot">1j</span> <span class="cf">for</span> char <span class="kw">in</span> line] <span class="cf">for</span> line <span class="kw">in</span> load(<span class="dv">22</span>)]</span>
<span id="cb53-989"><a href="#cb53-989" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb53-990"><a href="#cb53-990" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> size <span class="op">//</span> <span class="dv">2</span> <span class="op">+</span> (size <span class="op">//</span> <span class="dv">2</span>) <span class="op">*</span> <span class="ot">1j</span></span>
<span id="cb53-991"><a href="#cb53-991" aria-hidden="true" tabindex="-1"></a>board <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="ot">1j</span>)</span>
<span id="cb53-992"><a href="#cb53-992" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> y, line <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb53-993"><a href="#cb53-993" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x, val <span class="kw">in</span> <span class="bu">enumerate</span>(line):</span>
<span id="cb53-994"><a href="#cb53-994" aria-hidden="true" tabindex="-1"></a>        board[x <span class="op">+</span> (size <span class="op">-</span> y <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="ot">1j</span>] <span class="op">=</span> val</span>
<span id="cb53-995"><a href="#cb53-995" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-996"><a href="#cb53-996" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000000</span>):</span>
<span id="cb53-997"><a href="#cb53-997" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> board[position]</span>
<span id="cb53-998"><a href="#cb53-998" aria-hidden="true" tabindex="-1"></a>    total <span class="op">+=</span> state <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb53-999"><a href="#cb53-999" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">*=</span> state</span>
<span id="cb53-1000"><a href="#cb53-1000" aria-hidden="true" tabindex="-1"></a>    board[position] <span class="op">=</span> <span class="op">-</span>state <span class="op">*</span> <span class="ot">1j</span></span>
<span id="cb53-1001"><a href="#cb53-1001" aria-hidden="true" tabindex="-1"></a>    position <span class="op">+=</span> direction</span>
<span id="cb53-1002"><a href="#cb53-1002" aria-hidden="true" tabindex="-1"></a>total</span>
<span id="cb53-1003"><a href="#cb53-1003" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-1004"><a href="#cb53-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1005"><a href="#cb53-1005" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 23: Coprocessor Conflagration](https://adventofcode.com/2017/day/23)</span></span>
<span id="cb53-1006"><a href="#cb53-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1007"><a href="#cb53-1007" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-1008"><a href="#cb53-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1011"><a href="#cb53-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-1012"><a href="#cb53-1012" aria-hidden="true" tabindex="-1"></a>program <span class="op">=</span> [x.split() <span class="cf">for</span> x <span class="kw">in</span> load(<span class="dv">23</span>)]</span>
<span id="cb53-1013"><a href="#cb53-1013" aria-hidden="true" tabindex="-1"></a>ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-1014"><a href="#cb53-1014" aria-hidden="true" tabindex="-1"></a>registers <span class="op">=</span> {x: <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="st">"abcdefgh"</span>}</span>
<span id="cb53-1015"><a href="#cb53-1015" aria-hidden="true" tabindex="-1"></a>binops <span class="op">=</span> {<span class="st">"set"</span>: <span class="kw">lambda</span> x, y: y, <span class="st">"mul"</span>: <span class="kw">lambda</span> x, y: x <span class="op">*</span> y, <span class="st">"sub"</span>: <span class="kw">lambda</span> x, y: x <span class="op">-</span> y}</span>
<span id="cb53-1016"><a href="#cb53-1016" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-1017"><a href="#cb53-1017" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="dv">0</span> <span class="op">&lt;=</span> ip <span class="op">&lt;</span> <span class="bu">len</span>(program):</span>
<span id="cb53-1018"><a href="#cb53-1018" aria-hidden="true" tabindex="-1"></a>    instruction <span class="op">=</span> program[ip]</span>
<span id="cb53-1019"><a href="#cb53-1019" aria-hidden="true" tabindex="-1"></a>    instruction, register, argument <span class="op">=</span> instruction[<span class="dv">0</span>], instruction[<span class="dv">1</span>], instruction[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb53-1020"><a href="#cb53-1020" aria-hidden="true" tabindex="-1"></a>    argument <span class="op">=</span> registers[argument] <span class="cf">if</span> argument <span class="kw">in</span> registers <span class="cf">else</span> <span class="bu">int</span>(argument)</span>
<span id="cb53-1021"><a href="#cb53-1021" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> instruction <span class="kw">in</span> binops:</span>
<span id="cb53-1022"><a href="#cb53-1022" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> instruction <span class="op">==</span> <span class="st">"mul"</span>:</span>
<span id="cb53-1023"><a href="#cb53-1023" aria-hidden="true" tabindex="-1"></a>            count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-1024"><a href="#cb53-1024" aria-hidden="true" tabindex="-1"></a>        op <span class="op">=</span> binops[instruction]</span>
<span id="cb53-1025"><a href="#cb53-1025" aria-hidden="true" tabindex="-1"></a>        registers[register] <span class="op">=</span> op(registers[register], argument)</span>
<span id="cb53-1026"><a href="#cb53-1026" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> instruction <span class="op">==</span> <span class="st">"jnz"</span>:</span>
<span id="cb53-1027"><a href="#cb53-1027" aria-hidden="true" tabindex="-1"></a>        operand <span class="op">=</span> registers[register] <span class="cf">if</span> register <span class="kw">in</span> registers <span class="cf">else</span> <span class="bu">int</span>(register)</span>
<span id="cb53-1028"><a href="#cb53-1028" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> operand <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb53-1029"><a href="#cb53-1029" aria-hidden="true" tabindex="-1"></a>            ip <span class="op">+=</span> argument <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb53-1030"><a href="#cb53-1030" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-1031"><a href="#cb53-1031" aria-hidden="true" tabindex="-1"></a>count</span>
<span id="cb53-1032"><a href="#cb53-1032" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-1033"><a href="#cb53-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1034"><a href="#cb53-1034" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-1035"><a href="#cb53-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1036"><a href="#cb53-1036" aria-hidden="true" tabindex="-1"></a>The instructions warn you that trying to run part <span class="dv">2</span> <span class="im">as</span><span class="op">-</span><span class="kw">is</span> <span class="kw">is</span> a futile endeavour. And indeed, that <span class="kw">is</span> the case. Looking at the script there<span class="st">'s a very clear setup section to start with, where variables are set to values; these lines can never be reached again. After that there'</span>s a huge loop which covers the rest of the program, <span class="kw">and</span> which basically says</span>
<span id="cb53-1037"><a href="#cb53-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1040"><a href="#cb53-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-1041"><a href="#cb53-1041" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> b <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb53-1042"><a href="#cb53-1042" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb53-1043"><a href="#cb53-1043" aria-hidden="true" tabindex="-1"></a>    b <span class="op">+=</span> <span class="dv">17</span></span>
<span id="cb53-1044"><a href="#cb53-1044" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-1045"><a href="#cb53-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1046"><a href="#cb53-1046" aria-hidden="true" tabindex="-1"></a>Inside this huge loop, we find a section at the start <span class="cf">with</span> two nested loops, followed by a tiny bit of cleanup. The two nested loops only involve the d <span class="kw">and</span> e variables, <span class="kw">and</span> they have the effect of setting f to zero <span class="cf">if</span> ever d \<span class="op">*</span> e <span class="op">=</span> b, <span class="kw">and</span> doing basically nothing <span class="cf">else</span>. In the cleanup after the loop, <span class="dv">1</span> <span class="kw">is</span> added to h <span class="cf">if</span> f <span class="kw">is</span> zero. So that means that whenever b <span class="kw">is</span> composite, h increases by <span class="fl">1.</span> So the script <span class="kw">is</span> equivalent to:</span>
<span id="cb53-1047"><a href="#cb53-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1050"><a href="#cb53-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-1051"><a href="#cb53-1051" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_composite(n):</span>
<span id="cb53-1052"><a href="#cb53-1052" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="bu">int</span>(n<span class="op">**</span><span class="fl">0.5</span>) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb53-1053"><a href="#cb53-1053" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="op">%</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb53-1054"><a href="#cb53-1054" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb53-1055"><a href="#cb53-1055" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb53-1056"><a href="#cb53-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1057"><a href="#cb53-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1058"><a href="#cb53-1058" aria-hidden="true" tabindex="-1"></a>b0 <span class="op">=</span> <span class="dv">5700</span> <span class="op">+</span> <span class="dv">100_000</span></span>
<span id="cb53-1059"><a href="#cb53-1059" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(<span class="bu">list</span>(<span class="bu">filter</span>(is_composite, <span class="bu">range</span>(b0, b0 <span class="op">+</span> <span class="dv">17000</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">17</span>))))</span>
<span id="cb53-1060"><a href="#cb53-1060" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-1061"><a href="#cb53-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1062"><a href="#cb53-1062" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 24: Electromagnetic Moat](https://adventofcode.com/2017/day/24)</span></span>
<span id="cb53-1063"><a href="#cb53-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1064"><a href="#cb53-1064" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 1</span></span>
<span id="cb53-1065"><a href="#cb53-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1068"><a href="#cb53-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-1069"><a href="#cb53-1069" aria-hidden="true" tabindex="-1"></a>ports <span class="op">=</span> load(<span class="dv">24</span>, <span class="st">"int"</span>)</span>
<span id="cb53-1070"><a href="#cb53-1070" aria-hidden="true" tabindex="-1"></a>ports <span class="op">=</span> <span class="bu">set</span>(<span class="bu">map</span>(<span class="bu">tuple</span>, ports))</span>
<span id="cb53-1071"><a href="#cb53-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1072"><a href="#cb53-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1073"><a href="#cb53-1073" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> strongest_bridge(current, components, part<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb53-1074"><a href="#cb53-1074" aria-hidden="true" tabindex="-1"></a>    strength <span class="op">=</span> current <span class="cf">if</span> part <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> current[<span class="dv">1</span>]</span>
<span id="cb53-1075"><a href="#cb53-1075" aria-hidden="true" tabindex="-1"></a>    bridges <span class="op">=</span> []</span>
<span id="cb53-1076"><a href="#cb53-1076" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> candidate <span class="kw">in</span> [x <span class="cf">for</span> x <span class="kw">in</span> components <span class="cf">if</span> strength <span class="kw">in</span> x]:</span>
<span id="cb53-1077"><a href="#cb53-1077" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> candidate[<span class="dv">0</span>] <span class="cf">if</span> candidate[<span class="dv">1</span>] <span class="op">==</span> strength <span class="cf">else</span> candidate[<span class="dv">1</span>]</span>
<span id="cb53-1078"><a href="#cb53-1078" aria-hidden="true" tabindex="-1"></a>        new_components <span class="op">=</span> components <span class="op">-</span> <span class="bu">set</span>([candidate])</span>
<span id="cb53-1079"><a href="#cb53-1079" aria-hidden="true" tabindex="-1"></a>        new_state <span class="op">=</span> value <span class="cf">if</span> part <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> (current[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, value)</span>
<span id="cb53-1080"><a href="#cb53-1080" aria-hidden="true" tabindex="-1"></a>        bridges.append(strongest_bridge(new_state, new_components, part<span class="op">=</span>part))</span>
<span id="cb53-1081"><a href="#cb53-1081" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bridges:</span>
<span id="cb53-1082"><a href="#cb53-1082" aria-hidden="true" tabindex="-1"></a>        best_bridge <span class="op">=</span> <span class="bu">max</span>(bridges)</span>
<span id="cb53-1083"><a href="#cb53-1083" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (</span>
<span id="cb53-1084"><a href="#cb53-1084" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span> <span class="op">*</span> current <span class="op">+</span> best_bridge</span>
<span id="cb53-1085"><a href="#cb53-1085" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> part <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb53-1086"><a href="#cb53-1086" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> (best_bridge[<span class="dv">0</span>], <span class="dv">2</span> <span class="op">*</span> strength <span class="op">+</span> best_bridge[<span class="dv">1</span>])</span>
<span id="cb53-1087"><a href="#cb53-1087" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb53-1088"><a href="#cb53-1088" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-1089"><a href="#cb53-1089" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> current</span>
<span id="cb53-1090"><a href="#cb53-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1091"><a href="#cb53-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1092"><a href="#cb53-1092" aria-hidden="true" tabindex="-1"></a>strongest_bridge(<span class="dv">0</span>, ports)</span>
<span id="cb53-1093"><a href="#cb53-1093" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-1094"><a href="#cb53-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1095"><a href="#cb53-1095" aria-hidden="true" tabindex="-1"></a><span class="co">## Part 2</span></span>
<span id="cb53-1096"><a href="#cb53-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1097"><a href="#cb53-1097" aria-hidden="true" tabindex="-1"></a>Enumerating <span class="bu">all</span> the bridges <span class="cf">for</span> part <span class="dv">2</span> <span class="kw">is</span> basically the same <span class="im">as</span> <span class="kw">in</span> part <span class="dv">1</span>, so I<span class="st">'ve incuded the code there with a flag. The only difference is how the bridges are scored - here length takes priority. We can still use the `max` function because tuples sort lexicographically. The solution then becomes</span></span>
<span id="cb53-1098"><a href="#cb53-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1101"><a href="#cb53-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-1102"><a href="#cb53-1102" aria-hidden="true" tabindex="-1"></a>strongest_bridge((<span class="dv">0</span>, <span class="dv">0</span>), ports, part<span class="op">=</span><span class="dv">2</span>)[<span class="dv">1</span>]</span>
<span id="cb53-1103"><a href="#cb53-1103" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb53-1104"><a href="#cb53-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1105"><a href="#cb53-1105" aria-hidden="true" tabindex="-1"></a><span class="co"># [Day 25: The Halting Problem](https://adventofcode.com/2017/day/25)</span></span>
<span id="cb53-1106"><a href="#cb53-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1107"><a href="#cb53-1107" aria-hidden="true" tabindex="-1"></a>A pretty mindless translation of the requirements into code. Parsing the data was almost the fiddliest part</span>
<span id="cb53-1108"><a href="#cb53-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1111"><a href="#cb53-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb53-1112"><a href="#cb53-1112" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> load(<span class="dv">25</span>, <span class="st">"raw"</span>)</span>
<span id="cb53-1113"><a href="#cb53-1113" aria-hidden="true" tabindex="-1"></a>header, <span class="op">*</span>rows <span class="op">=</span> data.split(<span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>)</span>
<span id="cb53-1114"><a href="#cb53-1114" aria-hidden="true" tabindex="-1"></a>row <span class="op">=</span> rows[<span class="dv">0</span>]</span>
<span id="cb53-1115"><a href="#cb53-1115" aria-hidden="true" tabindex="-1"></a>rules <span class="op">=</span> {}</span>
<span id="cb53-1116"><a href="#cb53-1116" aria-hidden="true" tabindex="-1"></a>directions <span class="op">=</span> {<span class="st">"right"</span>: <span class="dv">1</span>, <span class="st">"left"</span>: <span class="op">-</span><span class="dv">1</span>}</span>
<span id="cb53-1117"><a href="#cb53-1117" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> rows:</span>
<span id="cb53-1118"><a href="#cb53-1118" aria-hidden="true" tabindex="-1"></a>    state, <span class="op">*</span>parameters <span class="op">=</span> [x[:<span class="op">-</span><span class="dv">1</span>].split()[<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> x <span class="kw">in</span> row.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>) <span class="cf">if</span> x]</span>
<span id="cb53-1119"><a href="#cb53-1119" aria-hidden="true" tabindex="-1"></a>    rules[state] <span class="op">=</span> (</span>
<span id="cb53-1120"><a href="#cb53-1120" aria-hidden="true" tabindex="-1"></a>        (<span class="bu">int</span>(parameters[<span class="dv">1</span>]), directions[parameters[<span class="dv">2</span>]], parameters[<span class="dv">3</span>]),</span>
<span id="cb53-1121"><a href="#cb53-1121" aria-hidden="true" tabindex="-1"></a>        (<span class="bu">int</span>(parameters[<span class="dv">5</span>]), directions[parameters[<span class="dv">6</span>]], parameters[<span class="dv">7</span>]),</span>
<span id="cb53-1122"><a href="#cb53-1122" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-1123"><a href="#cb53-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1124"><a href="#cb53-1124" aria-hidden="true" tabindex="-1"></a>ip <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb53-1125"><a href="#cb53-1125" aria-hidden="true" tabindex="-1"></a>tape <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb53-1126"><a href="#cb53-1126" aria-hidden="true" tabindex="-1"></a>current_state, n_steps <span class="op">=</span> header.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb53-1127"><a href="#cb53-1127" aria-hidden="true" tabindex="-1"></a>current_state <span class="op">=</span> current_state[<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb53-1128"><a href="#cb53-1128" aria-hidden="true" tabindex="-1"></a>n_steps <span class="op">=</span> <span class="bu">int</span>(n_steps.split()[<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb53-1129"><a href="#cb53-1129" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_steps):</span>
<span id="cb53-1130"><a href="#cb53-1130" aria-hidden="true" tabindex="-1"></a>    value, direction, current_state <span class="op">=</span> rules[current_state][tape[ip]]</span>
<span id="cb53-1131"><a href="#cb53-1131" aria-hidden="true" tabindex="-1"></a>    tape[ip] <span class="op">=</span> value</span>
<span id="cb53-1132"><a href="#cb53-1132" aria-hidden="true" tabindex="-1"></a>    ip <span class="op">+=</span> direction</span>
<span id="cb53-1133"><a href="#cb53-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1134"><a href="#cb53-1134" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(tape.values())</span>
<span id="cb53-1135"><a href="#cb53-1135" aria-hidden="true" tabindex="-1"></a>```</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../about.html">Front page</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://github.com/cutonbuminband/AOC">Github</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>